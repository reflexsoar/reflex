(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ae5c6"],{"0a76":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("CRow",[a("CCol",{attrs:{col:""}},[a("CCard",[a("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),a("CCardBody",[a("CForm",{on:{submit:function(t){return t.preventDefault(),e.createInput(t)}}},[a("h1",[e._v("Create Input")]),a("p",{staticClass:"text-muted"},[e._v("Fill out the form below to create a new input.")]),a("CInput",{attrs:{placeholder:"Input Name",required:"",label:"Input Name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("CRow",[a("CCol",{attrs:{lg:"6",sm:"12"}},[a("CSelect",{attrs:{label:"Plugin",placeholder:"Select an input type",options:["Elasticsearch","Exchange Mailbox","API","Webhook"]},on:{change:function(t){return e.populateConfig(t)}},model:{value:e.plugin,callback:function(t){e.plugin=t},expression:"plugin"}})],1),a("CCol",{attrs:{lg:"6",sm:"12"}},[a("CSelect",{attrs:{label:"Credential",options:e.credential_list,placeholder:"Select a credential if required by the input"},on:{change:function(t){return e.selectCredential(t)}},model:{value:e.credential,callback:function(t){e.credential=t},expression:"credential"}})],1)],1),a("CTextarea",{attrs:{placeholder:"Enter a description for the input.  The more detail the better.",required:"",label:"Description",rows:"5"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),a("CRow",[a("CCol",[a("CTextarea",{attrs:{placeholder:"{}",description:"The configuration tells the reflex agent what sources to poll.",required:"",label:"Configuration",rows:"8"},model:{value:e.config,callback:function(t){e.config=t},expression:"config"}})],1),a("CCol",[a("CTextarea",{attrs:{placeholder:"{}",description:"Field mappings tell the input what source data to extract as observables.",required:"",label:"Field Mapping",rows:"8"},model:{value:e.field_mapping,callback:function(t){e.field_mapping=t},expression:"field_mapping"}})],1)],1),a("div",{staticClass:"form-group",attrs:{role:"group"}},[a("label",{staticClass:"typo__label"},[e._v("Tags")]),a("multiselect",{attrs:{placeholder:"Select tags to apply to this input",taggable:!0,"tag-placeholder":"Add new tag","track-by":"name",label:"name",options:e.tag_list,multiple:!0},on:{tag:e.addTag},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),a("CRow",[a("CCol",{staticClass:"text-right",attrs:{col:"12"}},[a("CButton",{staticClass:"px-4",attrs:{color:"primary",type:"submit"}},[e._v("Create")])],1)],1)],1)],1)],1)],1)],1)},l=[],s=a("2f62"),n=(a("4a7a"),a("14f0"),{name:"CreateInput",created:function(){this.loadTags(),this.$store.dispatch("getCredentialList"),this.$store.commit("add_start")},methods:{createInput:function(){var e=this,t=this.name,a=this.description,i=this.credential,l=btoa(this.config),s=btoa(this.field_mapping),n=this.plugin,o=this.tags;this.credential_list;this.$store.dispatch("createInput",{name:t,description:a,config:l,field_mapping:s,plugin:n,credential:i,tags:o}).then((function(t){e.$router.go(-1)}))},addTag:function(e){var t={name:e,uuid:"",color:"#ffffff"};this.tags.push(e),this.tag_list.push(t),this.selected.push(t)},selectCredential:function(e){this.credential=e.target.value},loadTags:function(){var e=this;this.$store.dispatch("getTags").then((function(t){for(var a in t.data)e.tag_list.push({name:t.data[a].name,uuid:t.data[a].uuid})}))},populateConfig:function(e){var t="",a="",i=e.target.value;this.plugin=e.target.value,"Elasticsearch"==i&&(t='{"hosts":["https://localhost:9200"],"index":".siem-signals-*","cafile":"","scheme":"https","rule_name":"signal.rule.name","auth_method":"http_auth","search_size":200,"search_period":"15m","check_hostname":false,"severity_field":"signal.rule.severity","source_reference":"signal.parent.id","cert_verification":"none","description_field":"signal.rule.description"}',a='[{"field": "host.name", "dataType": "host", "tlp": 3, "tags": ["workstation"]}]'),"Exchange Mailbox"==i&&(t='{"hosts": ["https://ews.mydomain.com"], "mailbox_name": "phishing@reflexsoar.com", "poll_interval": "30m"}',a="{}"),"API"==i&&(t='{"url":"https://myapi.com"}',a="{}"),"Webhook"==i&&(t='{"url":"https://mywebhook.com"}',a="{}"),this.field_mapping=JSON.stringify(JSON.parse(a),null,4),this.config=JSON.stringify(JSON.parse(t),null,4)}},computed:Object(s["b"])(["credential_list"]),data:function(){return{name:"",description:"",config:"",field_mapping:"",credential:"",plugin:"",type:"",success:!1,errorMessage:"",test:0,tags:[],selected:[],tag_list:[]}}}),o=n,r=a("2877"),c=Object(r["a"])(o,i,l,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0ae5c6.a5a27d2f.js.map