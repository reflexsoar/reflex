{"version":3,"sources":["webpack:///./src/views/CreateInput.vue?8def","webpack:///src/views/CreateInput.vue","webpack:///./src/views/CreateInput.vue?674d","webpack:///./src/views/CreateInput.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","$event","preventDefault","createInput","_v","staticClass","model","value","callback","$$v","name","expression","populateConfig","plugin","credential_list","selectCredential","credential","description","config","field_mapping","tag_list","addTag","selected","staticRenderFns","component"],"mappings":"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","file":"js/chunk-2d0ae5c6.a5a27d2f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CRow',[_c('CCol',{attrs:{\"col\":\"\"}},[_c('CCard',[_c('link',{attrs:{\"rel\":\"stylesheet\",\"href\":\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\"}}),_c('CCardBody',[_c('CForm',{on:{\"submit\":function($event){$event.preventDefault();return _vm.createInput($event)}}},[_c('h1',[_vm._v(\"Create Input\")]),_c('p',{staticClass:\"text-muted\"},[_vm._v(\"Fill out the form below to create a new input.\")]),_c('CInput',{attrs:{\"placeholder\":\"Input Name\",\"required\":\"\",\"label\":\"Input Name\"},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_c('CRow',[_c('CCol',{attrs:{\"lg\":\"6\",\"sm\":\"12\"}},[_c('CSelect',{attrs:{\"label\":\"Plugin\",\"placeholder\":\"Select an input type\",\"options\":['Elasticsearch','Exchange Mailbox','API','Webhook']},on:{\"change\":function($event){return _vm.populateConfig($event)}},model:{value:(_vm.plugin),callback:function ($$v) {_vm.plugin=$$v},expression:\"plugin\"}})],1),_c('CCol',{attrs:{\"lg\":\"6\",\"sm\":\"12\"}},[_c('CSelect',{attrs:{\"label\":\"Credential\",\"options\":_vm.credential_list,\"placeholder\":\"Select a credential if required by the input\"},on:{\"change\":function($event){return _vm.selectCredential($event)}},model:{value:(_vm.credential),callback:function ($$v) {_vm.credential=$$v},expression:\"credential\"}})],1)],1),_c('CTextarea',{attrs:{\"placeholder\":\"Enter a description for the input.  The more detail the better.\",\"required\":\"\",\"label\":\"Description\",\"rows\":\"5\"},model:{value:(_vm.description),callback:function ($$v) {_vm.description=$$v},expression:\"description\"}}),_c('CRow',[_c('CCol',[_c('CTextarea',{attrs:{\"placeholder\":\"{}\",\"description\":\"The configuration tells the reflex agent what sources to poll.\",\"required\":\"\",\"label\":\"Configuration\",\"rows\":\"8\"},model:{value:(_vm.config),callback:function ($$v) {_vm.config=$$v},expression:\"config\"}})],1),_c('CCol',[_c('CTextarea',{attrs:{\"placeholder\":\"{}\",\"description\":\"Field mappings tell the input what source data to extract as observables.\",\"required\":\"\",\"label\":\"Field Mapping\",\"rows\":\"8\"},model:{value:(_vm.field_mapping),callback:function ($$v) {_vm.field_mapping=$$v},expression:\"field_mapping\"}})],1)],1),_c('div',{staticClass:\"form-group\",attrs:{\"role\":\"group\"}},[_c('label',{staticClass:\"typo__label\"},[_vm._v(\"Tags\")]),_c('multiselect',{attrs:{\"placeholder\":\"Select tags to apply to this input\",\"taggable\":true,\"tag-placeholder\":\"Add new tag\",\"track-by\":\"name\",\"label\":\"name\",\"options\":_vm.tag_list,\"multiple\":true},on:{\"tag\":_vm.addTag},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}})],1),_c('CRow',[_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"12\"}},[_c('CButton',{staticClass:\"px-4\",attrs:{\"color\":\"primary\",\"type\":\"submit\"}},[_vm._v(\"Create\")])],1)],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<CRow>\r\n  <CCol col>\r\n    <CCard><link rel=\"stylesheet\" href=\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\">\r\n        <CCardBody>\r\n            <CForm @submit.prevent=\"createInput\" >\r\n                <h1>Create Input</h1>\r\n                <p class=\"text-muted\">Fill out the form below to create a new input.</p>\r\n                <CInput\r\n                  placeholder=\"Input Name\"\r\n                  required\r\n                  v-model=\"name\"\r\n                  label=\"Input Name\"\r\n                >\r\n                </CInput>\r\n                <CRow>\r\n                  <CCol lg=\"6\" sm=\"12\">\r\n                  <CSelect \r\n                    label=\"Plugin\"\r\n                    placeholder=\"Select an input type\"\r\n                    :options=\"['Elasticsearch','Exchange Mailbox','API','Webhook']\"\r\n                    v-model=\"plugin\"\r\n                    @change=\"populateConfig($event)\"\r\n                  > \r\n                  </CSelect>\r\n                  </CCol>\r\n                  <CCol lg=\"6\" sm=\"12\">\r\n                  <CSelect \r\n                    label=\"Credential\"\r\n                    :options=\"credential_list\"\r\n                    v-model=\"credential\"\r\n                    @change=\"selectCredential($event)\"\r\n                    placeholder=\"Select a credential if required by the input\"\r\n                  >\r\n                  </CSelect>\r\n                  </CCol>\r\n                </CRow>\r\n                <CTextarea\r\n                  placeholder=\"Enter a description for the input.  The more detail the better.\"\r\n                  required\r\n                  v-model=\"description\"\r\n                  label=\"Description\"\r\n                  rows=5\r\n                >\r\n                </CTextarea>\r\n                <CRow>\r\n                  <CCol>\r\n                  <CTextarea\r\n                    placeholder='{}'\r\n                    description=\"The configuration tells the reflex agent what sources to poll.\"\r\n                    required\r\n                    v-model=\"config\"\r\n                    label=\"Configuration\"\r\n                    rows=8\r\n                  >\r\n                  </CTextarea>\r\n                  </CCol>\r\n                  <CCol>\r\n                  <CTextarea\r\n                    placeholder='{}'\r\n                    description=\"Field mappings tell the input what source data to extract as observables.\"\r\n                    required\r\n                    v-model=\"field_mapping\"\r\n                    label=\"Field Mapping\"\r\n                    rows=8\r\n                  >\r\n                  </CTextarea>\r\n                  </CCol>\r\n                </CRow>\r\n                <div role=\"group\" class=\"form-group\">\r\n                  <label class=\"typo__label\">Tags</label>\r\n                  <multiselect v-model=\"selected\" placeholder=\"Select tags to apply to this input\" :taggable=\"true\" tag-placeholder=\"Add new tag\" track-by=\"name\" label=\"name\" :options=\"tag_list\" :multiple=\"true\" @tag=\"addTag\">\r\n                  </multiselect>\r\n                </div>\r\n                <CRow>\r\n                  <CCol col=\"12\" class=\"text-right\">\r\n                    <CButton color=\"primary\" class=\"px-4\" type=\"submit\">Create</CButton>\r\n                  </CCol>\r\n                </CRow>\r\n              </CForm>\r\n        </CCardBody>\r\n    </CCard>\r\n  </CCol>\r\n</CRow>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\";\r\nimport {vSelect} from \"vue-select\";\r\nimport {required, minLength, between} from 'vuelidate/lib/validators'\r\nimport { parse } from '@babel/core';\r\n\r\nexport default {\r\n    name: 'CreateInput',\r\n    created() {\r\n      this.loadTags()\r\n      this.$store.dispatch('getCredentialList')\r\n      this.$store.commit('add_start') // Stop the success/fail add from showing up when changing from other pages     \r\n    },\r\n    methods: {\r\n      createInput: function () {\r\n        let name = this.name\r\n        let description = this.description\r\n        let credential = this.credential\r\n        let config = btoa(this.config)\r\n        let field_mapping = btoa(this.field_mapping)\r\n        let plugin = this.plugin\r\n        let tags = this.tags\r\n        let credential_list = this.credential_list\r\n        this.$store.dispatch('createInput', { name, description, config, field_mapping, plugin, credential, tags })\r\n        .then(resp => {\r\n          this.$router.go(-1)\r\n        })\r\n      },\r\n      addTag(newTag) {\r\n        const t = {\r\n          name: newTag,\r\n          uuid: '',\r\n          color: '#ffffff'\r\n        }\r\n        this.tags.push(newTag)\r\n        this.tag_list.push(t)\r\n        this.selected.push(t)\r\n      },\r\n      selectCredential(event) {\r\n        this.credential = event.target.value        \r\n      },\r\n      loadTags: function() {\r\n          this.$store.dispatch('getTags').then(resp => {\r\n              for(let i in resp.data) {\r\n                  this.tag_list.push({'name': resp.data[i].name, 'uuid': resp.data[i].uuid})\r\n              }\r\n          })\r\n      },\r\n      populateConfig(event) {\r\n        let conf = \"\"\r\n        let map = \"\"\r\n        let value = event.target.value\r\n        this.plugin = event.target.value\r\n        if (value == \"Elasticsearch\") {\r\n          conf = '{\"hosts\":[\"https://localhost:9200\"],\"index\":\".siem-signals-*\",\"cafile\":\"\",\"scheme\":\"https\",\"rule_name\":\"signal.rule.name\",\"auth_method\":\"http_auth\",\"search_size\":200,\"search_period\":\"15m\",\"check_hostname\":false,\"severity_field\":\"signal.rule.severity\",\"source_reference\":\"signal.parent.id\",\"cert_verification\":\"none\",\"description_field\":\"signal.rule.description\"}'\r\n          map = '[{\"field\": \"host.name\", \"dataType\": \"host\", \"tlp\": 3, \"tags\": [\"workstation\"]}]'\r\n        }\r\n        if (value == \"Exchange Mailbox\") {\r\n          conf = '{\"hosts\": [\"https://ews.mydomain.com\"], \"mailbox_name\": \"phishing@reflexsoar.com\", \"poll_interval\": \"30m\"}'\r\n          map = '{}'\r\n        }\r\n        if (value == \"API\") {\r\n          conf = '{\"url\":\"https://myapi.com\"}'\r\n          map = '{}'\r\n        }\r\n        if (value == \"Webhook\") {\r\n          conf = '{\"url\":\"https://mywebhook.com\"}'\r\n          map = '{}'\r\n        }\r\n\r\n        this.field_mapping = JSON.stringify(JSON.parse(map), null, 4)\r\n        this.config = JSON.stringify(JSON.parse(conf), null, 4)\r\n        return\r\n      }\r\n    },\r\n    computed: mapState(['credential_list']),\r\n    data(){\r\n      return {\r\n        name: \"\",\r\n        description: \"\",\r\n        config: \"\",\r\n        field_mapping: \"\",\r\n        credential: \"\",\r\n        plugin: \"\",\r\n        type: \"\",\r\n        success: false,\r\n        errorMessage: \"\",\r\n        test: 0,\r\n        tags: [],\r\n        selected: [],\r\n        tag_list: []\r\n      }\r\n    }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateInput.vue?vue&type=template&id=a9e5526e&\"\nimport script from \"./CreateInput.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateInput.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}