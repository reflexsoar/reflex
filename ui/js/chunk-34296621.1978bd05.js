(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34296621"],{"0f5e":function(e,t,s){"use strict";var a=s("eff3"),n=s.n(a);n.a},"4ea5":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Create Case",centered:!0,size:"lg",show:e.modalStatus},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.createCase()}}},[e._v("Create")])]},proxy:!0}])},[s("div",[e.events&&e.events.length>1?s("p",[e._v("This case will be associated with "),s("b",[e._v(e._s(e.events.length))]),e._v(" events.")]):e._e(),s("CForm",{on:{submit:function(t){return t.preventDefault(),e.createCase(t)}}},[s("CInput",{attrs:{placeholder:"Case Title",required:"",label:"Case Title"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),s("label",{staticStyle:{"text-align":"center","vertical-align":"middle","padding-bottom":".8em"}},[e._v("Assign Case Template?")]),e._v(" "),s("CSwitch",{attrs:{color:"success","label-on":"Yes","label-off":"No",checked:e.use_case_template,disabled:e.settings.require_case_templates},on:{"update:checked":function(t){e.use_case_template=t}}}),e.use_case_template?s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("multiselect",{attrs:{label:"title",options:e.case_templates,"track-by":"uuid",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1},on:{"search-change":e.caseTemplateFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" "+e._s(t.option.title)),s("br"),s("small",[e._v(e._s(t.option.description)),s("br"),e._v("Contains "+e._s(t.option.task_count)+" tasks.")])]}}],null,!1,965155483),model:{value:e.case_template,callback:function(t){e.case_template=t},expression:"case_template"}})],1):e._e(),e.case_template&&e.case_template.task_count>0?s("span",[s("label",[e._v("Tasks")]),s("br"),s("b",[e._v(e._s(e.case_template.task_count))]),e._v(" tasks will be added automatically to this case."),s("br"),s("br")]):e._e(),s("label",[e._v("Case Owner")]),s("multiselect",{attrs:{label:"username",options:e.users,"track-by":"username",searchable:!0,"internal-search":!1,"options-limit":25,"show-no-results":!1},on:{"search-change":e.usersFind},model:{value:e.owner,callback:function(t){e.owner=t},expression:"owner"}}),s("br"),s("CTextarea",{attrs:{placeholder:"Enter a description for the case.  The more detail the better.",required:"",label:"Description",rows:"5"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),s("CRow",[s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"TLP",options:e.tlps,value:e.tlp,placeholder:"Select a TLP"},on:{"update:value":function(t){e.tlp=t}}})],1),s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"Severity",options:e.severities,value:e.severity,placeholder:"Select a Severity"},on:{"update:value":function(t){e.severity=t}}})],1)],1),s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("label",{staticClass:"typo__label"},[e._v("Tags")]),s("multiselect",{attrs:{placeholder:"Select tags to apply to this input",taggable:!0,"tag-placeholder":"Add new tag","track-by":"name",label:"name",options:e.tag_list,multiple:!0,"close-on-select":!1},on:{tag:e.addTag},model:{value:e.selected_tags,callback:function(t){e.selected_tags=t},expression:"selected_tags"}})],1)],1)],1)])],1)},n=[],i=(s("4a7a"),s("2f62")),r={name:"CreateCaseModal",props:{show:Boolean,events:Array},computed:Object(i["b"])(["settings"]),data:function(){return{title:"",description:"",selected_tags:Array(),use_case_template:!1,case_templates:[],case_template:null,tlp:2,users:[],owner:null,severity:2,modalStatus:this.show,severities:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Critical",value:4}],tlps:[{label:"WHITE",value:1},{label:"GREEN",value:2},{label:"AMBER",value:3},{label:"RED",value:4}],tag_list:[],tags:Array}},watch:{show:function(){this.modalStatus=this.show},settings:function(){this.use_case_template=this.settings.require_case_templates},modalStatus:function(){this.modalStatus&&(this.loadTags(),this.loadData(),this.loadUsers()),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()},case_template:function(){this.applyCaseTemplate()},use_case_template:function(){this.use_case_template||(this.case_template=null),this.applyCaseTemplate()}},created:function(){},methods:{usersFind:function(e){var t=this;this.$store.dispatch("getUsersByName",e).then((function(e){t.users=t.$store.getters.users}))},applyCaseTemplate:function(){var e=this;for(var t in this.case_template&&(this.severity=this.case_template.severity,this.tlp=this.case_template.tlp),this.selected_tags)"from_template"in this.selected_tags[t]&&this.selected_tags.splice(t,1);if(this.case_template){var s=function(t){e.selected_tags.filter((function(s){return s.uuid===e.case_template.tags[t].uuid})).length<1&&(e.case_template.tags[t]["from_template"]=!0,e.selected_tags.push(e.case_template.tags[t]))};for(var a in this.case_template.tags)s(a)}},loadUsers:function(){var e=this;this.$store.dispatch("getUsers").then((function(t){e.users=e.$store.getters.users}))},loadCaseTemplates:function(){},loadData:function(){var e=this;this.$store.dispatch("getCaseTemplateList","").then((function(t){e.case_templates=t.data}))},caseTemplateFind:function(e){var t=this;this.$store.dispatch("getCaseTemplateList",e).then((function(e){t.case_templates=e.data}))},createCase:function(){var e=this,t=this.title,s=this.description,a=[],n=this.severity,i=this.tlp,r=Array();if(this.events)for(var o in this.events)a.push(this.events[o]);for(var l in this.selected_tags)r.push(this.selected_tags[l].name);var c={title:t,description:s,events:a,tlp:i,severity:n,tags:r};if(this.owner&&(c["owner_uuid"]=this.owner.uuid),this.case_template){var u=this.case_template.uuid;c={title:t,description:s,case_template_uuid:u,events:a,tlp:i,severity:n,tags:r}}this.$store.dispatch("createCase",c).then((function(t){if(200==t.status){e.modalStatus=!1;var s=t.data.uuid;e.$router.push({name:"View Case",params:{uuid:s}})}})).catch((function(e){console.log(e)}))},loadTags:function(){var e=this;this.tag_list=Array(),this.$store.dispatch("getTags").then((function(t){for(var s in t.data)e.tag_list.push({name:t.data[s].name,uuid:t.data[s].uuid})}))},reset:function(){this.use_case_template=this.settings.require_case_templates,this.case_template=null,this.severity=2,this.tlp=2,this.selected_tags=Array()},dismiss:function(){this.reset(),this.modalStatus=!1},addTag:function(e){var t={name:e,uuid:""};this.tag_list.push(t),this.selected_tags.push(t)}}},o=r,l=s("2877"),c=Object(l["a"])(o,a,n,!1,null,null,null);t["a"]=c.exports},"6e30":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Merge Event Into Case",centered:!0,size:"lg",show:e.modalStatus},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{disabled:!e.case_data,color:"primary"},on:{click:function(t){return e.mergeEventIntoCase()}}},[e._v("Merge")])]},proxy:!0}])},[s("div",[s("p",[e._v("Merging "),s("b",[e._v(e._s(e.events.length))]),e._v(" event"),e.events.length>1?s("span",[e._v("s")]):e._e(),e._v(".")]),s("multiselect",{attrs:{label:"title",options:e.cases,"track-by":"uuid",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1,"custom-label":e.caseLabel,placeholder:"Select a case"},on:{"search-change":e.caseFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" #"+e._s(t.option.id)+" - "+e._s(t.option.title)),s("br"),s("small",[s("b",[e._v("Severity: ")]),e._v(e._s(e.getSeverity(t.option.severity))+" | "),s("b",[e._v("Owner:")]),e._v(" "+e._s(t.option.owner.username||"Unassigned")+" | Contains "+e._s(t.option.event_count)+" events.")]),s("br"),s("small",[e._v(e._s(e._f("truncate")(t.option.description)))])]}}]),model:{value:e.case_data,callback:function(t){e.case_data=t},expression:"case_data"}})],1)])],1)},n=[],i=(s("4a7a"),s("2f62")),r={name:"MergeEventIntoCaseModal",props:{show:Boolean,events:Array},computed:Object(i["b"])(["settings","cases"]),data:function(){return{case_data:{},modalStatus:!1}},watch:{show:function(){this.modalStatus=this.show},modalStatus:function(){this.modalStatus&&this.loadData(),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()}},methods:{loadData:function(){this.$store.dispatch("getCases","uuid,title,id,event_count,owner,severity")},caseLabel:function(e){var t=e.id,s=e.title;if(t&&s)return"#".concat(t," - ").concat(s)},getSeverity:function(e){switch(e){case 0:return"Low";case 1:return"Medium";case 2:return"High";case 3:return"Critical";default:return"Low"}},caseFind:function(e){var t="uuid,title,id,event_count,owner,severity";this.$store.dispatch("getCasesByTitle",{title:e,fields:t})},mergeEventIntoCase:function(){var e=this,t=this.case_data.uuid,s={events:this.events};this.$store.dispatch("addEventsToCase",{uuid:t,events:s}).then((function(s){e.modalStatus=!1,e.$store.commit("show_alert",{message:"Successfully merged events into Case.",type:"success"}),e.$router.push({path:"/cases/"+t})}))},reset:function(){this.case_data={}},dismiss:function(){this.reset(),this.modalStatus=!1}},filters:{truncate:function(e){var t=100;return e?(e=e.toString(),e.length>t?e.substring(0,t)+"...":e.substring(0,t)):""}}},o=r,l=s("2877"),c=Object(l["a"])(o,a,n,!1,null,null,null);t["a"]=c.exports},"701a":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("CRow",[s("CCol",{attrs:{col:"12"}},[s("h2",[e._v("Events")]),s("CRow",[s("CCol",{attrs:{col:"12"}},[s("CAlert",{attrs:{show:e.alert.show,color:e.alert.type,closeButton:""},on:{"update:show":function(t){return e.$set(e.alert,"show",t)}}},[e._v(" "+e._s(e.alert.message)+" ")])],1)],1),s("CRow",[s("CCol",{attrs:{col:"12"}},[s("CCard",[s("CCardHeader",[s("CRow",[s("CCol",{attrs:{col:"10"}},[e._l(e.observableFilters,(function(t){return s("li",{key:t.value,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",attrs:{color:"secondary",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({dataType:t.dataType.name,value:t.value})}}},[s("b",[e._v(e._s(t.dataType))]),e._v(": "),"severity"==t.filter_type?s("span",[e._v(e._s(e.getSeverityText(t.value).toLowerCase()))]):s("span",[e._v(e._s(t.value))])])],1)})),!e.filteredBySignature()&&e.observableFilters.length>0?s("span",[s("span",{staticClass:"separator"},[e._v("|")]),e._v("Showing "+e._s(e.filtered_events.length)+" grouped events.")]):e._e(),e.filteredBySignature()&&0!=e.observableFilters.length?s("span",[e.filteredBySignature()&&0!=e.observableFilters.length?s("span",{staticClass:"separator"},[e._v("|")]):e._e(),e._v("Showing "+e._s(e.filtered_events.length)+" events.")]):e._e(),0==e.observableFilters.length?s("span",[e._v("Showing "+e._s(e.filtered_events.length)+" grouped events.")]):e._e()],2),s("CCol",{staticClass:"text-right",attrs:{col:"2"}},[s("CButton",{attrs:{color:"info",size:"sm"},on:{click:function(t){e.quick_filters=!e.quick_filters}}},[e._v("Quick Filters")])],1)],1)],1),s("CCollapse",{attrs:{show:e.quick_filters}},[s("CNav",{attrs:{variant:"tabs",justified:!0}},[s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"status",dataType:"status",value:"New"})}}},[s("h1",[e._v(e._s(e.eventCountByStatus("New")))]),e._v(" New ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"status",dataType:"status",value:"Open"})}}},[s("h1",[e._v(e._s(e.eventCountByStatus("Open")))]),e._v(" Open ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"status",dataType:"status",value:"Closed"})}}},[s("h1",[e._v(e._s(e.eventCountByStatus("Closed")))]),e._v(" Closed ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"status",dataType:"status",value:"Dismissed"})}}},[s("h1",[e._v(e._s(e.eventCountByStatus("Dismissed")))]),e._v(" Dismissed ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:3})}}},[s("h1",[e._v(e._s(e.eventCountBySeverity(3)))]),e._v(" Critical ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:2})}}},[s("h1",[e._v(e._s(e.eventCountBySeverity(2)))]),e._v(" High ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:1})}}},[s("h1",[e._v(e._s(e.eventCountBySeverity(1)))]),e._v(" Medium ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:0})}}},[s("h1",[e._v(e._s(e.eventCountBySeverity(0)))]),e._v(" Low ")])])],1)],1)],1)],1)],1),s("CRow",[s("CCol",{attrs:{col:"2"}},[s("div",[e.select_all||0!=e.selected.length&&!e.filteredBySignature()?s("CButton",{staticStyle:{"margin-top":"-5px"},attrs:{size:"sm",color:"secondary"},on:{click:function(t){return e.clearSelected()}}},[s("CIcon",{attrs:{name:"cilXCircle",size:"sm"}})],1):e._e(),!e.select_all&&0==e.selected.length||e.filteredBySignature()?s("CButton",{staticStyle:{"margin-top":"-5px"},attrs:{size:"sm",color:"secondary"},on:{click:function(t){return e.selectAll()}}},[s("CIcon",{attrs:{name:"cilCheck"}})],1):e._e(),e._v(" "),s("CSelect",{staticClass:"d-inline-block",attrs:{options:["Severity","Status","Date Created","Name","TLP","Observable Count"],placeholder:"Sort by"}})],1)]),s("CCol",{attrs:{col:"4"}},[s("center",[s("CPagination",{attrs:{activePage:e.current_page,pages:e.page_data.pages},on:{"update:activePage":function(t){e.current_page=t},"update:active-page":function(t){e.current_page=t}}})],1)],1),s("CCol",{staticClass:"text-right",attrs:{col:"3"}},[s("CInput",{attrs:{placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.toggleObservableFilter({filter_type:"search",dataType:"search",value:e.search_filter})}}},[e._v("Search")])]},proxy:!0}]),model:{value:e.search_filter,callback:function(t){e.search_filter=t},expression:"search_filter"}})],1),s("CCol",{staticClass:"text-right",attrs:{col:"3"}},[s("div",[e.table_view?e._e():s("CButton",{staticClass:"d-inline-block",attrs:{color:"secondary"},on:{click:function(t){return e.setColumns()}}},[s("small",[s("CIcon",{attrs:{name:"cilColumns",size:"sm"}})],1)]),e._v(" "),s("CButton",{staticClass:"d-inline-block",attrs:{color:"secondary"},on:{click:function(t){e.table_view=!e.table_view}}},[e.table_view?s("span",[e._v("Card")]):s("span",[e._v("Table")]),e._v(" View")]),e._v(" "),s("CDropdown",{staticClass:"d-inline-block",attrs:{"toggler-text":e.selected.length+" events",color:"secondary",disabled:0==e.selected.length}},[s("CDropdownItem",{on:{click:function(t){e.dismissEventModal=!e.dismissEventModal}}},[e._v("Dismiss Event")]),s("CDropdownItem",{on:{click:function(t){e.runPlaybookModal=!e.runPlaybookModal}}},[e._v("Run Playbook")]),s("CDropdownItem",{on:{click:function(t){e.createCaseModal=!e.createCaseModal}}},[e._v("Create Case")]),s("CDropdownItem",{on:{click:function(t){e.mergeIntoCaseModal=!e.mergeIntoCaseModal}}},[e._v("Merge into Case")]),s("CDropdownDivider"),s("CDropdownItem",{on:{click:function(t){e.deleteEventModal=!e.deleteEventModal}}},[e._v("Delete")])],1)],1)])],1),"loading"==e.status?s("CRow",{attrs:{col:""}},[s("CCol",{attrs:{col:"12"}},[s("div",{staticStyle:{margin:"auto","text-align":"center","verticle-align":"middle"}},[s("CSpinner",{staticStyle:{width:"6rem",height:"6rem"},attrs:{color:"dark"}})],1)])],1):0==e.filtered_events.length?s("CRow",[s("CCol",{staticClass:"text-center",attrs:{col:"12"}},[s("h1",[e._v("No Events")])])],1):e.table_view?s("CRow",[s("CCol",{attrs:{col:"12"}},[s("CCard",[s("CCardBody",{staticStyle:{"overflow-y":"scroll","max-height":"600px"}},[s("CDataTable",{attrs:{items:e.filtered_events,fields:e.fields,striped:!0,sorter:{resetable:!0},responsive:!1},nativeOn:{mouseenter:function(t){e.pauseRefresh=!0},mouseleave:function(t){e.pauseRefresh=!1}},scopedSlots:e._u([{key:"name",fn:function(t){var a=t.item;return[s("td",[a.case_uuid||a.status.closed?e._e():s("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],attrs:{type:"checkbox"},domProps:{value:a.uuid,checked:Array.isArray(e.selected)?e._i(e.selected,a.uuid)>-1:e.selected},on:{change:function(t){var s=e.selected,n=t.target,i=!!n.checked;if(Array.isArray(s)){var r=a.uuid,o=e._i(s,r);n.checked?o<0&&(e.selected=s.concat([r])):o>-1&&(e.selected=s.slice(0,o).concat(s.slice(o+1)))}else e.selected=i}}}),e._v(" "),s("a",{on:{click:function(t){return e.toggleObservableFilter({filter_type:"title",dataType:"title",value:a.title})}}},[e._v(e._s(a.title))]),s("br"),s("CIcon",{attrs:{name:"cilCenterFocus"}}),e._v(" "),e._l(a.observables.slice(0,2),(function(t){return s("li",{key:t.uuid,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",staticStyle:{"margin-top":"5px","margin-bottom":"5px"},attrs:{color:"secondary",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"observable",dataType:t.dataType.name,value:t.value})}}},[s("b",[e._v(e._s(t.dataType.name))]),e._v(": "+e._s(t.value.toLowerCase()))])],1)})),a.observables.length>2?s("span",{directives:[{name:"c-popover",rawName:"v-c-popover",value:{header:"Additional Observables",content:e.extraObservables(a.observables.slice(2))},expression:"{'header':'Additional Observables', 'content':extraObservables(item.observables.slice(2))}"}],staticStyle:{cursor:"pointer"}},[s("small",[e._v(" +"+e._s(a.observables.length-2))])]):e._e(),s("br"),s("CIcon",{attrs:{name:"cilTags"}}),e._v(" "),e._l(a.tags,(function(t){return s("li",{key:t.name,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",attrs:{color:"dark",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"tag",dataType:"tag",value:t.name})}}},[e._v(e._s(t.name))])],1)}))],2)]}},{key:"reference",fn:function(t){var a=t.item;return[s("td",[s("span",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:""+a.reference,placement:"top"},expression:"{\n      content: `${item.reference}`,\n      placement: 'top'\n    }"}]},[e._v(e._s(e._f("truncate")(a.reference)))])])]}},{key:"created",fn:function(t){var a=t.item;return[s("td",[s("span",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:a.created_at,expression:"item.created_at"}]},[e._v(e._s(e._f("moment")(a.created_at,"from","now")))])])]}},{key:"events",fn:function(t){var a=t.item;return[s("td",[e.filteredBySignature()||a.related_events_count<1?e._e():s("CButton",{staticClass:"tag",attrs:{color:"dark",size:"sm"},on:{click:function(t){return e.toggleObservableFilter({filter_type:"eventsig",dataType:"signature",value:a.signature})}}},[e._v(e._s(a.related_events_count))])],1)]}},{key:"status",fn:function(t){var a=t.item;return[s("td",[e._v(" "+e._s(a.status.name)+" ")])]}},{key:"severity",fn:function(t){var a=t.item;return[s("td",[s("CButton",{staticClass:"tag",attrs:{color:e.getSeverityColor(a.severity),size:"sm"},on:{click:function(t){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:a.severity})}}},[e._v(e._s(e.getSeverityText(a.severity)))])],1)]}},{key:"actions",fn:function(t){var a=t.item;return[s("td",{attrs:{align:"right"}},[s("CButtonGroup",[a.new_related_events&&a.new_related_events.length>0&&!e.filteredBySignature()||e.filteredBySignature()&&"New"==a.status.name?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Create Event Rule",placement:"bottom"},expression:"{'content':'Create Event Rule','placement':'bottom'}"}],attrs:{size:"sm",color:"info"},on:{click:function(t){return e.createEventRule(a.signature)}}},[s("CIcon",{attrs:{name:"cilGraph"}})],1):e._e(),a.case_uuid?e._e():s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Create Case",placement:"bottom"},expression:"{'content':'Create Case','placement':'bottom'}"}],attrs:{size:"sm",color:"secondary"},on:{click:function(t){return e.caseFromCard(a.uuid)}}},[s("CIcon",{attrs:{name:"cilBriefcase"}})],1),s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"View Event",placement:"bottom"},expression:"{'content':'View Event','placement':'bottom'}"}],attrs:{to:"/alerts/"+a.uuid,size:"sm",color:"secondary"}},[s("CIcon",{attrs:{name:"cilMagnifyingGlass"}})],1),a.status.closed?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Reopen Event",placement:"bottom"},expression:"{'content':'Reopen Event','placement':'bottom'}"}],attrs:{size:"sm",color:"success"}},[s("CIcon",{attrs:{name:"cilEnvelopeOpen"}})],1):e._e(),a.case_uuid?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"View Case",placement:"bottom"},expression:"{'content':'View Case','placement':'bottom'}"}],attrs:{size:"sm",color:"secondary",to:"/cases/"+a.case_uuid}},[s("CIcon",{attrs:{name:"cilBriefcase"}})],1):e._e(),a.status.closed?e._e():s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Dismiss Event",placement:"bottom"},expression:"{'content':'Dismiss Event','placement':'bottom'}"}],attrs:{color:"danger",size:"sm"},on:{click:function(t){return e.dismissEventFromCard(a.uuid)}}},[s("CIcon",{attrs:{name:"cilDeaf"}})],1)],1)],1)]}},{key:"observables",fn:function(t){var a=t.item;return[s("td",[e._v(" "+e._s(a.observable_count)+" ")])]}}])})],1)],1)],1)],1):s("CRow",{staticStyle:{"overflow-y":"scroll","max-height":"650px"}},e._l(e.filtered_events,(function(t){return s("CCol",{key:t.uuid,attrs:{col:12/e.columns}},[s("CCard",{attrs:{"accent-color":e.getSeverityColor(t.severity)}},[s("CCardBody",{on:{mouseenter:function(t){e.pauseRefresh=!0},mouseleave:function(t){e.pauseRefresh=!1}}},[s("CRow",[s("CCol",{attrs:{col:"9"}},[s("h4",[t.status.closed||t.case_uuid?e._e():s("input",{attrs:{type:"checkbox"},domProps:{checked:e.selected.includes(t.uuid),value:t.uuid},on:{change:function(t){return e.selectEvents(t)}}}),e._v(" "),s("a",{on:{click:function(s){return e.toggleObservableFilter({filter_type:"title",dataType:"title",value:t.title})}}},[e._v(e._s(t.title))])]),e._v(" "+e._s(e._f("truncate_description")(t.description))),s("br"),s("CIcon",{staticStyle:{"margin-top":"5px"},attrs:{name:"cilCenterFocus"}}),e._v(" "),e._l(t.observables,(function(t){return s("li",{key:t.uuid,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",staticStyle:{"margin-top":"5px","margin-bottom":"0px"},attrs:{color:"secondary",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"observable",dataType:t.dataType.name,value:t.value})}}},[s("b",[e._v(e._s(t.dataType.name))]),e._v(": "+e._s(t.value.toLowerCase()))])],1)}))],2),s("CCol",{staticClass:"text-right",attrs:{col:"3"}},[s("CButtonGroup",[t.new_related_events&&t.new_related_events.length>0&&!e.filteredBySignature()||e.filteredBySignature()&&"New"==t.status.name?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Create Event Rule",placement:"bottom"},expression:"{'content':'Create Event Rule','placement':'bottom'}"}],attrs:{size:"sm",color:"info"},on:{click:function(s){return e.createEventRule(t.signature)}}},[s("CIcon",{attrs:{name:"cilGraph"}})],1):e._e(),t.case_uuid?e._e():s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Create Case",placement:"bottom"},expression:"{'content':'Create Case','placement':'bottom'}"}],attrs:{size:"sm",color:"secondary"},on:{click:function(s){return e.caseFromCard(t.uuid)}}},[s("CIcon",{attrs:{name:"cilBriefcase"}})],1),s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"View Event",placement:"bottom"},expression:"{'content':'View Event','placement':'bottom'}"}],attrs:{to:"/alerts/"+t.uuid,size:"sm",color:"secondary"}},[s("CIcon",{attrs:{name:"cilMagnifyingGlass"}})],1),t.status.closed?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Reopen Event",placement:"bottom"},expression:"{'content':'Reopen Event','placement':'bottom'}"}],attrs:{size:"sm",color:"success"}},[s("CIcon",{attrs:{name:"cilEnvelopeOpen"}})],1):e._e(),t.case_uuid?s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"View Case",placement:"bottom"},expression:"{'content':'View Case','placement':'bottom'}"}],attrs:{size:"sm",color:"secondary",to:"/cases/"+t.case_uuid}},[s("CIcon",{attrs:{name:"cilBriefcase"}})],1):e._e(),t.status.closed?e._e():s("CButton",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Dismiss Event",placement:"bottom"},expression:"{'content':'Dismiss Event','placement':'bottom'}"}],attrs:{color:"danger",size:"sm"},on:{click:function(s){return e.dismissEventFromCard(t.uuid)}}},[s("CIcon",{attrs:{name:"cilDeaf"}})],1)],1)],1)],1)],1),s("CCardFooter",{staticStyle:{"background-color":"#f0f0f0"}},[s("CRow",[s("CCol",{attrs:{col:"9"}},[s("small",[s("CButton",{staticClass:"tag",attrs:{color:e.getSeverityColor(t.severity),size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"severity",dataType:"severity",value:t.severity})}}},[e._v(e._s(e.getSeverityText(t.severity)))]),!e.filteredBySignature()&&t.related_events_count>1?s("span",{staticClass:"separator"},[e._v("|")]):e._e(),!e.filteredBySignature()&&t.related_events_count>1?s("CButton",{staticClass:"tag",attrs:{color:"dark",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"eventsig",dataType:"signature",value:t.signature})}}},[e._v(e._s(t.related_events_count)+" occurences "),t.new_related_events&&t.new_related_events.length>0?s("span",[e._v(" | "+e._s(t.new_related_events.length)+" open")]):e._e()]):e._e(),s("span",{staticClass:"separator"},[e._v("|")]),s("CButton",{staticClass:"tag",attrs:{size:"sm",color:"info"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"status",dataType:"status",value:t.status.name})}}},[e._v(e._s(t.status.name))]),t.status.closed&&t.dismiss_reason?s("span",[s("span",{staticClass:"separator"},[e._v("|")]),s("b",[e._v("Dismiss Reason:")]),e._v(" "+e._s(t.dismiss_reason.title))]):e._e(),s("span",{staticClass:"separator"},[e._v("|")]),e._v("Created "+e._s(e._f("moment")(t.created_at,"LLLL"))),s("span",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:t.reference,expression:"event.reference"}]},[s("span",{staticClass:"separator"},[e._v("|")]),s("b",[e._v("Reference:")]),e._v(" "+e._s(e._f("truncate")(t.reference)))])],1)]),s("CCol",{staticClass:"text-right",attrs:{col:"3"}},[s("CIcon",{attrs:{name:"cilTags"}}),e._v(" "),e._l(t.tags,(function(t){return s("li",{key:t.name,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",attrs:{color:"dark",size:"sm"},on:{click:function(s){return e.toggleObservableFilter({filter_type:"tag",dataType:"tag",value:t.name})}}},[e._v(e._s(t.name))])],1)}))],2)],1)],1)],1)],1)})),1)],1),s("CModal",{attrs:{title:"Dismiss Event",color:"danger",centered:!0,size:"lg",show:e.dismissEventModal},on:{"update:show":function(t){e.dismissEventModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{type:"submit",form:"dismissEventForm",color:"danger"}},[e._v("Dismiss Event")])]},proxy:!0}])},[s("div",[s("p",[e._v("Dismissing an event indicates that no action is required. For transparency purposes, it is best to leave a comment as to why this event is being dismissed. Fill out the comment field below.")]),s("p",[e._v("This comment will apply to "),s("b",[e._v(e._s(e.selected.length))]),e._v(" events.")]),s("CForm",{attrs:{id:"dismissEventForm"},on:{submit:function(t){return t.preventDefault(),e.dismissEvent()}}},[s("CRow",[s("CCol",[s("br"),s("CSelect",{attrs:{"reset-on-options-change":!0,placeholder:"Select a reason for dismissing the event...",options:e.close_reasons,value:e.dismissalReason,label:"Reason"},on:{change:function(t){e.dismissalReason=t.target.value}}}),s("CTextarea",{attrs:{placeholder:"Enter a comment as to why this Event is being dismissed.",required:"",value:e.dismissalComment,label:"Comment",rows:"5"},on:{change:function(t){e.dismissalComment=t}}})],1)],1)],1)],1)]),s("CreateCaseModal",{attrs:{show:e.createCaseModal,events:e.selected},on:{"update:show":function(t){e.createCaseModal=t}}}),s("CreateEventRuleModal",{attrs:{show:e.createEventRuleModal,events:e.selected,event_signature:e.event_signature,rule_observables:e.rule_observables},on:{"update:show":function(t){e.createEventRuleModal=t},"update:event_signature":function(t){e.event_signature=t}}}),s("MergeEventIntoCaseModal",{attrs:{show:e.mergeIntoCaseModal,events:e.selected},on:{"update:show":function(t){e.mergeIntoCaseModal=t}}}),s("CModal",{attrs:{title:"Delete Event",color:"danger",centered:!0,size:"lg",show:e.deleteEventModal},on:{"update:show":function(t){e.deleteEventModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){e.deleteEventModal=!e.deleteEventModal}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"danger"},on:{click:function(t){return e.deleteEvent()}}},[e._v("Delete")])]},proxy:!0}])},[s("div",[s("p",[e._v("Deleting an event is a permanent action, are you sure you want to continue?")]),s("p",[e._v("This action will apply to "),s("b",[e._v(e._s(e.selected.length))]),e._v(" events.")])])])],1)},n=[],i=s("2f62"),r=(s("4a7a"),s("4ea5")),o=s("6e30"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Create Event Rule",centered:!0,size:"lg",show:e.modalStatus,closeOnBackdrop:!1},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),1!=e.step?s("CButton",{attrs:{color:"info"},on:{click:function(t){return e.previousStep()}}},[e._v("Previous")]):e._e(),e.step!=e.final_step?s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v("Next")]):e._e(),e.step==e.final_step?s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.createEventRule()}}},[e._v("Create")]):e._e()]},proxy:!0}])},[s("div",[s("CForm",{attrs:{id:"event_rule_form"},on:{submit:function(t){return t.preventDefault(),e.createEventRule(t)}}},[1==e.step?s("div",{attrs:{name:"create-event-rule-step-1"}},[s("h4",[e._v("Rule Details")]),s("p",[e._v("An Event rule allows you to automatically handle Events over a period of time based on Event criteria.")]),s("p",[e._v("This rule will apply "),s("b",[e._v("immediately")]),e._v(" to "),s("b",[e._v(e._s(e.events.length))]),e._v(" Events and any future events matching the below Rule Signature.")]),s("p",[s("b",[e._v("Event Signature: ")]),e._v(e._s(e.event_signature)+" ")]),s("CInput",{attrs:{label:"Rule Name",required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),s("CTextarea",{attrs:{label:"Rule description",required:"",placeholder:"Give a brief description of what this rule will do and why."},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1):e._e(),2==e.step?s("div",{attrs:{name:"create-case-template-step-2"}},[s("h4",[e._v("Expiration")]),s("p",[e._v("Setting an expiration on the rule is recommended to allow analysts to revisit Events at a future state. There may be use cases for non-expiration rules but we can't think of any...")]),s("label",[e._v("Expire")]),s("CRow",[s("CCol",{attrs:{col:"12"}},[s("CSwitch",{attrs:{color:"success","label-on":"Yes","label-off":"No",label:"Dismiss Event",checked:e.expire},on:{"update:checked":function(t){e.expire=t}}})],1)],1),s("br"),s("CInput",{attrs:{label:"Expiration period (days)",disabled:!e.expire,placeholder:"Enter a period in number of days"},model:{value:e.expire_days,callback:function(t){e.expire_days=t},expression:"expire_days"}})],1):e._e(),3==e.step?s("div",{attrs:{name:"create-case-template-step-3"}},[s("h4",[e._v("Observable Matching")]),s("p",[e._v("The observables selected here must match for the Rule to apply. A signature of the observables is calculated to make sure only specific combinations are acted on.")]),s("multiselect",{staticStyle:{"z-index":"50"},attrs:{options:e.rule_observables,"custom-label":e.observableLabel,multiple:"","track-by":"value",label:"value"},scopedSlots:e._u([{key:"option",fn:function(t){return[s("b",[e._v(e._s(t.option.dataType))]),e._v(": "+e._s(t.option.value)+" ")]}}],null,!1,1579855348),model:{value:e.observables,callback:function(t){e.observables=t},expression:"observables"}})],1):e._e(),4==e.step?s("div",{attrs:{name:"create-case-template-step-4"}},[s("h4",[e._v("Actions")]),s("label",[e._v("Merge into Case")]),s("CRow",[s("CCol",{attrs:{col:"1"}},[s("CSwitch",{staticStyle:{"padding-top":"5px"},attrs:{disabled:e.dismiss_event,label:"Merge into Case",color:"success","label-on":"Yes","label-off":"No",checked:e.merge_into_case},on:{"update:checked":function(t){e.merge_into_case=t}}})],1),s("CCol",{attrs:{col:"11"}},[s("multiselect",{staticStyle:{"z-index":"50"},attrs:{disabled:!e.merge_into_case||e.dismiss_event,options:e.cases,"track-by":"uuid",label:"title",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1,"custom-label":e.caseLabel,placeholder:"Select a case"},on:{"search-change":e.caseFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" #"+e._s(t.option.id)+" - "+e._s(t.option.title)),s("br"),s("small",[e._v(e._s(t.option.event_count)+" events.")])]}}],null,!1,3201994419),model:{value:e.target_case,callback:function(t){e.target_case=t},expression:"target_case"}})],1)],1),s("label",[e._v("Dismiss Event")]),s("CRow",[s("CCol",{attrs:{col:"1"}},[s("CSwitch",{staticStyle:{"padding-top":"5px"},attrs:{disabled:e.merge_into_case,color:"success","label-on":"Yes","label-off":"No",label:"Dismiss Event",checked:e.dismiss_event},on:{"update:checked":function(t){e.dismiss_event=t}}})],1),s("CCol",{attrs:{col:"11"}})],1)],1):e._e(),5==e.step?s("div",{attrs:{name:"create-case-template-step-5"}},[s("h4",[e._v("Review")]),s("b",[e._v("Rule Name: ")]),e._v(" "+e._s(e.name)),s("br"),s("b",[e._v("Description: ")]),s("br"),e._v(e._s(e.description)),s("br"),s("br"),e.expire?s("span",[s("b",[e._v("Expire in: ")]),e._v(" "+e._s(e.expire_days)+" day(s)"),s("br")]):e._e(),s("b",[e._v("Actions: ")]),s("br"),s("br"),s("ul",[e.merge_into_case?s("li",[e._v("Merge in to case "),s("b",[e._v("#"+e._s(e.target_case.id)+" - "+e._s(e.target_case.title))])]):e._e(),e.dismiss_event?s("li",[e._v("Immediately dismiss event")]):e._e()]),s("b",[e._v("Observables: ")]),s("br"),s("br"),s("ul",e._l(e.observables,(function(t){return s("li",{key:t.value},[s("b",[e._v(e._s(t.dataType))]),e._v(": "+e._s(t.value))])})),0)]):e._e()])],1)])],1)},c=[],u={name:"CreateEventRuleModal",props:{show:Boolean,events:Array,event_signature:String,rule_observables:Array},computed:Object(i["b"])(["settings"]),data:function(){return{name:"",cases:[],description:"",modalStatus:this.show,merge_into_case:!1,dismiss_event:!1,expire_days:1,observables:[],expire:!0,step:1,final_step:5,target_case:[]}},watch:{show:function(){this.modalStatus=this.show},modalStatus:function(){this.modalStatus&&(this.loadData(),this.name="Rule for event signature "+this.event_signature,this.observables=this.rule_observables),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()},case_template:function(){this.applyCaseTemplate()},use_case_template:function(){this.use_case_template||(this.case_template=null),this.applyCaseTemplate()}},created:function(){},methods:{createEventRule:function(){var e=this,t={name:this.name,description:this.description,merge_into_case:this.merge_into_case,target_case_uuid:this.target_case.uuid,expire:this.expire,expire_days:this.expire_days,dismiss:this.dismiss_event,event_signature:this.event_signature,observables:this.observables};this.$store.dispatch("createEventRule",t).then((function(t){e.modalStatus=!1}))},nextStep:function(){this.step+=1},previousStep:function(){this.step-=1},loadData:function(){var e=this;this.$store.dispatch("getCases","uuid,title,id,event_count,owner,severity").then((function(t){e.cases=e.$store.getters.cases}))},caseFind:function(e){var t=this,s="uuid,title,id,event_count,owner,severity";this.$store.dispatch("getCasesByTitle",{title:e,fields:s}).then((function(e){t.cases=t.$store.getters.cases}))},toggleMergeToCase:function(){this.merge_into_case=!this.merge_into_case},observableLabel:function(e){var t=e.dataType,s=e.value;return"".concat(t,": ").concat(s)},caseLabel:function(e){var t=e.id,s=e.title;if(t&&s)return"#".concat(t," - ").concat(s)},reset:function(){this.description="",this.expire=!0,this.expire_days=1,this.observables=[],this.merge_into_case=!1,this.dismiss_event=!1,this.target_case=[],this.step=1},dismiss:function(){this.reset(),this.modalStatus=!1},addTag:function(e){var t={name:e,uuid:""};this.tag_list.push(t),this.selected_tags.push(t)}}},d=u,v=s("2877"),p=Object(v["a"])(d,l,c,!1,null,null,null),_=p.exports;function m(e){return b(e)||g(e)||f(e)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){if(e){if("string"===typeof e)return C(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(s):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?C(e,t):void 0}}function g(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function b(e){if(Array.isArray(e))return C(e)}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}var y={name:"Events",components:{CreateCaseModal:r["a"],MergeEventIntoCaseModal:o["a"],CreateEventRuleModal:_},props:{items:Array,caption:{type:String,default:"Table"},hover:Boolean,striped:Boolean,bordered:Boolean,small:Boolean,fixed:Boolean,dark:Boolean,event:!1},computed:Object(i["b"])(["status","alert","settings"]),created:function(){this.loadData(),this.loadCloseReasons(),this.refresh=setInterval(function(){this.pauseRefresh||this.loadData()}.bind(this),1e3*this.settings.events_page_refresh)},data:function(){return{name:"",description:"",severity:0,tlp:0,tag_list:[],selected_tags:[],observable_count:0,tags:[],events:[],pauseRefresh:!1,case_tlp:2,case_severity:1,use_case_template:!1,dismissCountDown:10,selected:Array(),mergeIntoCaseModal:!1,dismissEventModal:!1,deleteEventModal:!1,createCaseModal:!1,createEventRuleModal:!1,dismissalComment:"",dismissalReason:null,close_reasons:[],collapse:{},observableFilters:[{filter_type:"status",dataType:"status",value:"New"}],filtered_events:[],quick_filters:!1,search_filter:"",table_view:!1,select_all:!1,fields:["name","created","events","reference","status","severity","observables","actions"],sort_by:"date",event_signature:"",rule_observables:[],columns:1,card_page_num:1,card_per_page:10,page_data:{},current_page:1}},methods:{dismissEventFromCard:function(e){this.selected=[e],this.dismissEventModal=!0},dismissEvent:function(){var e=this;if(1==this.selected.length){var t={dismiss_reason_uuid:this.dismissalReason,dismiss_comment:this.dismissalComment};this.$store.dispatch("updateEvent",{uuid:this.selected[0],data:t}).then((function(t){e.filtered_events=e.$store.getters.events}))}else if(this.selected.length>1){var s={dismiss_reason_uuid:this.dismissalReason,dismiss_comment:this.dismissalComment,events:this.selected};this.$store.dispatch("dismissEvents",s).then((function(t){e.filtered_events=e.$store.getters.events}))}this.selected=[],this.dismissEventModal=!1,this.dismissalComment=""},loadCloseReasons:function(){var e=this;this.$store.dispatch("getCloseReasons").then((function(t){e.close_reasons=e.$store.getters.close_reasons.map((function(e){return{label:e.title,value:e.uuid}}))}))},addSuccess:function(){return"success"==this.$store.getters.addSuccess},unique_event_sigs:function(){},setColumns:function(){1==this.columns?this.columns=2:this.columns=1},eventCountByStatus:function(e){return this.filtered_events.reduce((function(t,s){if(s)return t+(s.status.name==e)}),0)},eventCountBySeverity:function(e){return this.filtered_events.reduce((function(t,s){if(s)return t+(s.severity==e)}),0)},selectEvents:function(e){var t=this;this.selected.some((function(t){return t===e.target.value}))?this.filteredBySignature()?this.selected=this.selected.filter((function(t){return t!==e.target.value})):this.selected=this.selected.filter((function(s){return!t.selectedRelated(e.target.value).includes(s)})):this.filteredBySignature()?this.selected.push(e.target.value):this.selected=[].concat(m(this.selected),m(this.selectedRelated(e.target.value)))},createEventRule:function(e){var t=this;this.selected=[],this.event_signature=e;var s=this.filtered_events.filter((function(t){return t.signature==e}));this.selected=this.selectedRelated(s[0].uuid),this.rule_observables=this.filtered_events.filter((function(e){return t.selected.includes(e.uuid)})).map((function(e){return e.observables})).flat().map((function(e){return{dataType:e.dataType.name,value:e.value}}));var a=Array.from(new Set(this.rule_observables.map((function(e){return e.value})))).map((function(e){return t.rule_observables.find((function(t){return t.value===e}))}));this.rule_observables=a,this.createEventRuleModal=!0},selectedRelated:function(e){var t=this.filtered_events.filter((function(t){return t.uuid==e}));return t[0].new_related_events},filteredBySignature:function(){return!!this.observableFilters.some((function(e){return"eventsig"==e.filter_type}))},filterEvents:function(){var e=this;this.$store.commit("add_start");var t=[],s=[],a=[],n=[],i="",r=!this.filteredBySignature(),o="";for(var l in this.observableFilters){var c=this.observableFilters[l];"eventsig"==c.filter_type&&(i=c.value),"status"==c.filter_type&&t.push(c.value),"tag"==c.filter_type&&s.push(c.value),"observable"==c.filter_type&&a.push(c.value),"search"==c.filter_type&&(o=c.value),"severity"==c.filter_type&&n.push(c.value)}this.$store.dispatch("getEvents",{signature:i,grouped:r,tags:s,status:t,observables:a,severity:n,search:o,fields:"",page:this.current_page,page_size:this.card_per_page}).then((function(t){e.filtered_events=e.$store.getters.events,e.page_data=t.data.pagination,e.$store.commit("add_success")}))},sanitizeHTML:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},extraObservables:function(e){var t="<ul style='list-style-type: none; padding:0; margin: 0;'>";for(var s in e){var a=e[s];t+="<li><b>".concat(a.dataType.name,"</b>: ").concat(this.sanitizeHTML(a.value),"</li>")}return t+="</ul>",t},transformFilter:function(e){return{field:e["filter_type"],value:e["value"]}},toggleObservableFilter:function(e){var t=this.observableFilters.some((function(t){return t.value===e.value}));"status"==e.filter_type&&(this.observableFilters=this.observableFilters.filter((function(t){return t.filter_type!==e.filter_type}))),t?this.observableFilters=this.observableFilters.filter((function(t){return t.value!==e.value})):this.observableFilters.push(e),this.filterEvents()},relatedEvents:function(e){return this.events.filter((function(t){return t.signature===e})).length},countStatusBySignature:function(e,t){return this.events.filter((function(s){return s.signature===e&&s.status.name==t})).length},loadData:function(){this.filterEvents()},caseFromCard:function(e){this.selected=[e],this.createCaseModal=!0},selectAll:function(){if(!this.select_all){for(var e in this.filtered_events){var t=this.filtered_events[e];!this.filteredBySignature()&&t.related_events_count>1?(t.signature||null==t.signature)&&(this.selected=[].concat(m(this.selected),m(this.selectedRelated(t.uuid)))):t.case_uuid||this.selected.includes(t.uuid)||this.selected.push(t.uuid)}this.filteredBySignature()||(this.select_all=!0)}},clearSelected:function(){this.selected=[],this.select_all=!1},getSeverityColor:function(e){switch(e){case 0:return"dark";case 1:return"info";case 2:return"warning";case 3:return"danger";default:return"dark"}},getSeverityText:function(e){switch(e){case 0:return"Low";case 1:return"Medium";case 2:return"High";case 3:return"Critical";default:return"Low"}}},beforeDestroy:function(){clearInterval(this.refresh)},watch:{current_page:function(){this.filterEvents()}},filters:{truncate_description:function(e){var t=150;return e?(e=e.toString(),e.length>t?e.substring(0,t)+"...":e.substring(0,t)):""},truncate:function(e){var t=6;return e?(e=e.toString(),e.length>t?e.substring(0,t)+"...":e.substring(0,t)):""}}},w=y,S=(s("0f5e"),Object(v["a"])(w,a,n,!1,null,"2512fc57",null));t["default"]=S.exports},eff3:function(e,t,s){}}]);
//# sourceMappingURL=chunk-34296621.1978bd05.js.map