(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fcd1cd5"],{"4ea5":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Create Case",centered:!0,size:"lg",show:e.modalStatus},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.createCase()}}},[e._v("Create")])]},proxy:!0}])},[s("div",[e.events&&e.events.length>1?s("p",[e._v("This case will be associated with "),s("b",[e._v(e._s(e.events.length))]),e._v(" events.")]):e._e(),s("CForm",{on:{submit:function(t){return t.preventDefault(),e.createCase(t)}}},[s("CInput",{attrs:{placeholder:"Case Title",required:"",label:"Case Title"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),s("label",{staticStyle:{"text-align":"center","vertical-align":"middle","padding-bottom":".8em"}},[e._v("Assign Case Template?")]),e._v(" "),s("CSwitch",{attrs:{color:"success","label-on":"Yes","label-off":"No",checked:e.use_case_template,disabled:e.settings.require_case_templates},on:{"update:checked":function(t){e.use_case_template=t}}}),e.use_case_template?s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("multiselect",{attrs:{label:"title",options:e.case_templates,"track-by":"uuid",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1},on:{"search-change":e.caseTemplateFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" "+e._s(t.option.title)),s("br"),s("small",[e._v(e._s(t.option.description)),s("br"),e._v("Contains "+e._s(t.option.task_count)+" tasks.")])]}}],null,!1,965155483),model:{value:e.case_template,callback:function(t){e.case_template=t},expression:"case_template"}})],1):e._e(),e.case_template&&e.case_template.task_count>0?s("span",[s("label",[e._v("Tasks")]),s("br"),s("b",[e._v(e._s(e.case_template.task_count))]),e._v(" tasks will be added automatically to this case."),s("br"),s("br")]):e._e(),s("label",[e._v("Case Owner")]),s("multiselect",{attrs:{label:"username",options:e.users,"track-by":"username",searchable:!0,"internal-search":!1,"options-limit":25,"show-no-results":!1},on:{"search-change":e.usersFind},model:{value:e.owner,callback:function(t){e.owner=t},expression:"owner"}}),s("br"),s("CTextarea",{attrs:{placeholder:"Enter a description for the case.  The more detail the better.",required:"",label:"Description",rows:"5"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),s("CRow",[s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"TLP",options:e.tlps,value:e.tlp,placeholder:"Select a TLP"},on:{"update:value":function(t){e.tlp=t}}})],1),s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"Severity",options:e.severities,value:e.severity,placeholder:"Select a Severity"},on:{"update:value":function(t){e.severity=t}}})],1)],1),s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("label",{staticClass:"typo__label"},[e._v("Tags")]),s("multiselect",{attrs:{placeholder:"Select tags to apply to this input",taggable:!0,"tag-placeholder":"Add new tag","track-by":"name",label:"name",options:e.tag_list,multiple:!0,"close-on-select":!1},on:{tag:e.addTag},model:{value:e.selected_tags,callback:function(t){e.selected_tags=t},expression:"selected_tags"}})],1)],1)],1)])],1)},o=[],n=(s("4a7a"),s("2f62")),i={name:"CreateCaseModal",props:{show:Boolean,events:Array},computed:Object(n["b"])(["settings"]),data:function(){return{title:"",description:"",selected_tags:Array(),use_case_template:!1,case_templates:[],case_template:null,tlp:2,users:[],owner:null,severity:2,modalStatus:this.show,severities:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Critical",value:4}],tlps:[{label:"WHITE",value:1},{label:"GREEN",value:2},{label:"AMBER",value:3},{label:"RED",value:4}],tag_list:[],tags:Array}},watch:{show:function(){this.modalStatus=this.show},settings:function(){this.use_case_template=this.settings.require_case_templates},modalStatus:function(){this.modalStatus&&(this.loadTags(),this.loadData(),this.loadUsers()),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()},case_template:function(){this.applyCaseTemplate()},use_case_template:function(){this.use_case_template||(this.case_template=null),this.applyCaseTemplate()}},created:function(){},methods:{usersFind:function(e){var t=this;this.$store.dispatch("getUsersByName",e).then((function(e){t.users=t.$store.getters.users}))},applyCaseTemplate:function(){var e=this;for(var t in this.case_template&&(this.severity=this.case_template.severity,this.tlp=this.case_template.tlp),this.selected_tags)"from_template"in this.selected_tags[t]&&this.selected_tags.splice(t,1);if(this.case_template){var s=function(t){e.selected_tags.filter((function(s){return s.uuid===e.case_template.tags[t].uuid})).length<1&&(e.case_template.tags[t]["from_template"]=!0,e.selected_tags.push(e.case_template.tags[t]))};for(var a in this.case_template.tags)s(a)}},loadUsers:function(){var e=this;this.$store.dispatch("getUsers").then((function(t){e.users=e.$store.getters.users}))},loadCaseTemplates:function(){},loadData:function(){var e=this;this.$store.dispatch("getCaseTemplateList","").then((function(t){e.case_templates=t.data}))},caseTemplateFind:function(e){var t=this;this.$store.dispatch("getCaseTemplateList",e).then((function(e){t.case_templates=e.data}))},createCase:function(){var e=this,t=this.title,s=this.description,a=[],o=this.severity,n=this.tlp,i=Array();if(this.events)for(var l in this.events)a.push(this.events[l]);for(var r in this.selected_tags)i.push(this.selected_tags[r].name);var c={title:t,description:s,events:a,tlp:n,severity:o,tags:i};if(this.owner&&(c["owner_uuid"]=this.owner.uuid),this.case_template){var u=this.case_template.uuid;c={title:t,description:s,case_template_uuid:u,events:a,tlp:n,severity:o,tags:i}}this.$store.dispatch("createCase",c).then((function(t){if(200==t.status){e.modalStatus=!1;var s=t.data.uuid;e.$router.push({name:"View Case",params:{uuid:s}})}})).catch((function(e){console.log(e)}))},loadTags:function(){var e=this;this.tag_list=Array(),this.$store.dispatch("getTags").then((function(t){for(var s in t.data)e.tag_list.push({name:t.data[s].name,uuid:t.data[s].uuid})}))},reset:function(){this.use_case_template=this.settings.require_case_templates,this.case_template=null,this.severity=2,this.tlp=2,this.selected_tags=Array()},dismiss:function(){this.reset(),this.modalStatus=!1},addTag:function(e){var t={name:e,uuid:""};this.tag_list.push(t),this.selected_tags.push(t)}}},l=i,r=s("2877"),c=Object(r["a"])(l,a,o,!1,null,null,null);t["a"]=c.exports},"6e30":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Merge Event Into Case",centered:!0,size:"lg",show:e.modalStatus},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{disabled:!e.case_data,color:"primary"},on:{click:function(t){return e.mergeEventIntoCase()}}},[e._v("Merge")])]},proxy:!0}])},[s("div",[s("p",[e._v("Merging "),s("b",[e._v(e._s(e.events.length))]),e._v(" event"),e.events.length>1?s("span",[e._v("s")]):e._e(),e._v(".")]),s("multiselect",{attrs:{label:"title",options:e.cases,"track-by":"uuid",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1,"custom-label":e.caseLabel,placeholder:"Select a case"},on:{"search-change":e.caseFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" #"+e._s(t.option.id)+" - "+e._s(t.option.title)),s("br"),s("small",[s("b",[e._v("Severity: ")]),e._v(e._s(e.getSeverity(t.option.severity))+" | "),s("b",[e._v("Owner:")]),e._v(" "+e._s(t.option.owner.username||"Unassigned")+" | Contains "+e._s(t.option.event_count)+" events.")]),s("br"),s("small",[e._v(e._s(e._f("truncate")(t.option.description)))])]}}]),model:{value:e.case_data,callback:function(t){e.case_data=t},expression:"case_data"}})],1)])],1)},o=[],n=(s("4a7a"),s("2f62")),i={name:"MergeEventIntoCaseModal",props:{show:Boolean,events:Array},computed:Object(n["b"])(["settings","cases"]),data:function(){return{case_data:{},modalStatus:!1}},watch:{show:function(){this.modalStatus=this.show},modalStatus:function(){this.modalStatus&&this.loadData(),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()}},methods:{loadData:function(){this.$store.dispatch("getCases","uuid,title,id,event_count,owner,severity")},caseLabel:function(e){var t=e.id,s=e.title;if(t&&s)return"#".concat(t," - ").concat(s)},getSeverity:function(e){switch(e){case 0:return"Low";case 1:return"Medium";case 2:return"High";case 3:return"Critical";default:return"Low"}},caseFind:function(e){var t="uuid,title,id,event_count,owner,severity";this.$store.dispatch("getCasesByTitle",{title:e,fields:t})},mergeEventIntoCase:function(){var e=this,t=this.case_data.uuid,s={events:this.events};this.$store.dispatch("addEventsToCase",{uuid:t,events:s}).then((function(s){e.modalStatus=!1,e.$store.commit("show_alert",{message:"Successfully merged events into Case.",type:"success"}),e.$router.push({path:"/cases/"+t})}))},reset:function(){this.case_data={}},dismiss:function(){this.reset(),this.modalStatus=!1}},filters:{truncate:function(e){var t=100;return e?(e=e.toString(),e.length>t?e.substring(0,t)+"...":e.substring(0,t)):""}}},l=i,r=s("2877"),c=Object(r["a"])(l,a,o,!1,null,null,null);t["a"]=c.exports},d71d:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("CRow",[e.loading?s("CCol",{attrs:{col:""}},[s("div",{staticStyle:{margin:"auto","text-align":"center","verticle-align":"middle"}},[s("CSpinner",{staticStyle:{width:"6rem",height:"6rem"},attrs:{color:"dark"}})],1)]):e._e(),e.loading?e._e():s("CCol",{attrs:{col:""}},[s("CCard",{staticClass:"shadow-sm bg-white rounded"},[s("CCardHeader",[s("CRow",[s("CCol",{staticClass:"text-left",attrs:{col:"12",lg:"6",sm:"12"}},[s("h3",[e._v(e._s(e._f("truncate")(e.event.title)))])]),s("CCol",{staticClass:"text-right",attrs:{col:"12",lg:"6",sm:"12"}},[s("CButtonGroup",[s("CDropdown",{attrs:{"toggler-text":"Actions",color:"secondary"}},[e.event.case_uuid?e._e():s("CDropdownItem",{on:{click:function(t){e.dismissEventModal=!e.dismissEventModal}}},[e._v("Dismiss Event")]),s("CDropdownItem",{on:{click:function(t){e.runPlaybookModal=!e.runPlaybookModal}}},[e._v("Run Playbook")]),e.event.case_uuid?e._e():s("CDropdownItem",{on:{click:function(t){e.mergeIntoCaseModal=!e.mergeIntoCaseModal}}},[e._v("Merge into Case")]),e.event.case_uuid?e._e():s("CDropdownItem",{on:{click:function(t){e.createCaseModal=!e.createCaseModal}}},[e._v("Create Case")]),s("CDropdownDivider"),s("CDropdownItem",{on:{click:function(t){e.deleteEventModal=!e.deleteEventModal}}},[e._v("Delete")])],1),e.event.case_uuid?s("CButton",{attrs:{to:"/cases/"+e.event.case_uuid,color:"success"}},[e._v("ViewCase")]):e._e()],1)],1)],1),s("CRow",[s("CCol",{attrs:{col:"12",lg:"10",sm:"12"}},[e._v(e._s(e.event.description)),s("br"),s("br")])],1),s("CRow",[s("CCol",{staticStyle:{"margin-top":"5px"},attrs:{col:"12",lg:"6",sm:"12"}},e._l(e.event.tags,(function(t){return s("li",{key:t.name,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{attrs:{color:"primary",size:"sm",disabled:""}},[e._v(e._s(t.name))])],1)})),0)],1)],1),s("CCardBody",[s("CRow",[s("CCol",{attrs:{col:"6"}},[s("label",[e._v("Source: ")]),e._v(" Elasticsearch"),s("br"),s("label",[e._v("Created: ")]),e._v(" "+e._s(e._f("moment")(e.event.created_at,"LLLL"))),s("br"),s("label",[e._v("Updated: ")]),e._v(" "+e._s(e._f("moment")(e.event.modified_at,"from","now"))+" ")]),s("CCol",{staticClass:"text-right",attrs:{col:"6"}},[s("label",[e._v("Event Signature: ")]),e._v(" "+e._s(e.event.signature)),s("br"),s("label",[e._v("Status: ")]),e._v(" "+e._s(e.event.status.name)+" ")])],1)],1)],1),s("CCard",{staticClass:"shadow-sm bg-white rounded"},[s("CCardHeader",{staticStyle:{"border-bottom":"none"}},[s("CRow",[s("CCol",{staticClass:"text-left",attrs:{col:"12",lg:"12",sm:"12"}},[s("b",{staticStyle:{display:"inline-block"},on:{click:function(t){e.collapse_observables=!e.collapse_observables}}},[e._v("Observables")])])],1)],1),s("CCollapse",{attrs:{show:e.collapse_observables}},[s("CDataTable",{attrs:{hover:e.hover,items:e.event.observables,fields:e.observable_fields,"items-per-page":e.small?25:10,bordered:"",striped:"",pagination:""},scopedSlots:e._u([{key:"value",fn:function(t){var a=t.item;return[s("td",[e._v(" "+e._s(e._f("defang")(a.value))+" ")])]}},{key:"ioc",fn:function(t){var a=t.item;return[s("td",[s("CSwitch",{staticStyle:{"padding-top":"3px"},attrs:{color:"danger","label-on":"Yes","label-off":"No",checked:a.ioc,disabled:""},on:{"update:checked":function(t){return e.$set(a,"ioc",t)}}})],1)]}},{key:"spotted",fn:function(t){var a=t.item;return[s("td",[s("CSwitch",{staticStyle:{"padding-top":"3px"},attrs:{color:"danger","label-on":"Yes","label-off":"No",checked:a.spotted},on:{"update:checked":function(t){return e.$set(a,"spotted",t)}}})],1)]}},{key:"safe",fn:function(t){var a=t.item;return[s("td",[s("CSwitch",{staticStyle:{"padding-top":"3px"},attrs:{color:"success","label-on":"Yes","label-off":"No",checked:a.safe},on:{"update:checked":function(t){return e.$set(a,"safe",t)}}})],1)]}},{key:"dataType",fn:function(t){var a=t.item;return[s("td",[e._v(" "+e._s(e._f("defang")(a.dataType.name))+" ")])]}},{key:"tags",fn:function(t){var a=t.item;return[s("td",e._l(a.tags,(function(t){return s("li",{key:t.name,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{attrs:{color:"primary",size:"sm",disabled:""}},[e._v(e._s(t.name))])],1)})),0)]}}],null,!1,1379928406)})],1)],1),s("CCard",{staticClass:"shadow-sm bg-white rounded"},[s("CCardHeader",[s("CRow",{on:{click:function(t){e.collapse_raw_log=!e.collapse_raw_log}}},[s("CCol",{staticClass:"text-left",attrs:{col:"12",lg:"12",sm:"12"}},[s("b",[e._v("Raw Log")]),e._v(" "),e.collapse_raw_log?s("span",{staticClass:"float-right"},[e._v("-")]):e._e(),e.collapse_raw_log?e._e():s("span",{staticClass:"float-right"},[e._v("+")])])],1)],1),s("CCollapse",{attrs:{show:e.collapse_raw_log}},[s("CCardBody",{staticClass:"bg-dark",staticStyle:{overflow:"scroll"}},[s("CRow",{staticClass:"bg-dark"},[s("CCol",{staticClass:"bg-dark pre-formatted raw_log",attrs:{col:"12"}},[e._v(e._s(e.jsonify(e.event.raw_log)))])],1)],1)],1)],1)],1),s("CModal",{attrs:{title:"Dismiss Event",color:"danger",centered:!0,size:"lg",show:e.dismissEventModal},on:{"update:show":function(t){e.dismissEventModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{type:"submit",form:"dismissEventForm",color:"danger"}},[e._v("Dismiss Event")])]},proxy:!0}])},[s("div",[s("p",[e._v("Dismissing an event indicates that no action is required. For transparency purposes, it is best to leave a comment as to why this event is being dismissed. Fill out the comment field below.")]),s("CForm",{attrs:{id:"dismissEventForm"},on:{submit:function(t){return t.preventDefault(),e.dismissEvent()}}},[s("CRow",[s("CCol",[s("br"),s("CSelect",{attrs:{"reset-on-options-change":!0,placeholder:"Select a reason for dismissing the event...",options:e.close_reasons,value:e.dismissalReason,label:"Reason"},on:{change:function(t){e.dismissalReason=t.target.value}}}),s("CTextarea",{attrs:{placeholder:"Enter a comment as to why this Event is being dismissed.",required:e.settings.require_event_dismiss_comment,value:e.dismissalComment,label:"Comment",rows:"5"},on:{change:function(t){e.dismissalComment=t}}})],1)],1)],1)],1)]),s("CModal",{attrs:{title:"Run Playbook",color:"dark",centered:!0,size:"lg",show:e.runPlaybookModal},on:{"update:show":function(t){e.runPlaybookModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.runPlaybook()}}},[e._v("Execute")])]},proxy:!0}])},[s("div",[e._v(" You can manually execute a playbook against this Event. Select a playbook from the list below and click Execute. "),s("CForm",[s("CRow",[s("CCol",[s("br"),s("CSelect",{attrs:{label:"Playbook",horizontal:"",options:["Enrich","Remediate","Escalate"],placeholder:"Please select"}})],1)],1)],1)],1)]),s("CModal",{attrs:{title:"Delete Event",color:"danger",centered:!0,size:"lg",show:e.deleteEventModal},on:{"update:show":function(t){e.deleteEventModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){e.deleteEventModal=!e.deleteEventModal}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"danger"},on:{click:function(t){return e.deleteEvent()}}},[e._v("Delete")])]},proxy:!0}])},[s("div",[e._v(" Deleting an event is a permanent action, are you sure you want to continue? ")])]),s("CreateCaseModal",{attrs:{show:e.createCaseModal,events:[e.event.uuid]},on:{"update:show":function(t){e.createCaseModal=t}}}),s("MergeEventIntoCaseModal",{attrs:{show:e.mergeIntoCaseModal,events:[e.event.uuid]},on:{"update:show":function(t){e.mergeIntoCaseModal=t}}})],1)},o=[],n=s("2f62"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showTools,expression:"showTools"}],staticClass:"tools",style:{left:e.x+"px",top:e.y+"px"},on:{mousedown:function(e){e.preventDefault()}}},[s("span",{staticClass:"item",on:{mousedown:function(t){return t.preventDefault(),e.handleAction("share")}}},[s("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[s("path",{attrs:{fill:"#000000",d:"M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"}})])]),s("span",{staticClass:"item",on:{mousedown:function(t){return t.preventDefault(),e.handleAction("highlight")}}},[s("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[s("path",{attrs:{fill:"#000000",d:"M18.5,1.15C17.97,1.15 17.46,1.34 17.07,1.73L11.26,7.55L16.91,13.2L22.73,7.39C23.5,6.61 23.5,5.35 22.73,4.56L19.89,1.73C19.5,1.34 19,1.15 18.5,1.15M10.3,8.5L4.34,14.46C3.56,15.24 3.56,16.5 4.36,17.31C3.14,18.54 1.9,19.77 0.67,21H6.33L7.19,20.14C7.97,20.9 9.22,20.89 10,20.12L15.95,14.16"}})])])]),e._t("default")],2)},l=[],r={name:"hoverselect",data:function(){return{x:0,y:0,showTools:!1,selectedText:""}},computed:{highlightableEl:function(){return this.$slots.default[0].elm}},mounted:function(){window.addEventListener("mouseup",this.onMouseup)},beforeDestroy:function(){window.removeEventListener("mouseup",this.onMouseup)},methods:{onMouseup:function(){var e=window.getSelection(),t=e.getRangeAt(0).startContainer.parentNode,s=e.getRangeAt(0).endContainer.parentNode;if(console.log(!t.isSameNode(this.highlightableEl)),!t.isSameNode(this.highlightableEl)||!t.isSameNode(s))return console.log("nope1"),void(this.showTools=!1);var a=e.getRangeAt(0).getBoundingClientRect(),o=a.x,n=a.y,i=a.width;if(!i)return console.log("nope2"),void(this.showTools=!1);this.x=o+i/2,this.y=n+window.scrollY-10,console.log("show the tools"),this.showTools=!0,this.selectedText=e.toString()},handleAction:function(e){this.$emit(e,this.selectedText)}}},c=r,u=s("2877"),d=Object(u["a"])(c,i,l,!1,null,null,null),h=d.exports,p=s("4ea5"),v=s("6e30"),m={name:"EventDetails",components:{hoverselect:h,CreateCaseModal:p["a"],MergeEventIntoCaseModal:v["a"]},computed:Object(n["b"])(["settings"]),props:{observable_fields:{type:Array,default:function(){return["value","ioc","spotted","safe","dataType","tags"]}},caption:{type:String,default:"Table"},hover:Boolean,striped:Boolean,bordered:Boolean,small:Boolean,fixed:Boolean,dark:Boolean},data:function(){return{uuid:this.$route.params.uuid,event:{},loading:!0,cardCollapse:!0,collapse_raw_log:!0,collapse_observables:!0,collapse:{},toggleCollapse:!0,dismissEventModal:!1,runPlaybookModal:!1,deleteEventModal:!1,dismissalComment:"",dismissalReason:null,createCaseModal:!1,mergeIntoCaseModal:!1,close_reason:[]}},created:function(){var e=this;this.$store.dispatch("getEvent",this.$route.params.uuid).then((function(t){e.event=t.data;var s=e.event.events;for(var a in s){var o=s[a].uuid;e.$set(e.collapse,o,!0)}e.loading=!1})),this.loadCloseReasons()},methods:{jsonify:function(e){try{return JSON.parse(e)}catch(t){return e}},loadCloseReasons:function(){var e=this;this.$store.dispatch("getCloseReasons").then((function(t){e.close_reasons=e.$store.getters.close_reasons.map((function(e){return{label:e.title,value:e.uuid}}))}))},dismissEvent:function(){var e=this,t={dismiss_reason_uuid:this.dismissalReason,dismiss_comment:this.dismissalComment};this.$store.dispatch("updateEvent",{uuid:this.uuid,data:t}).then((function(t){e.event=e.$store.getters.event})),this.dismissEventModal=!1,this.dismissalComment=""},expandAll:function(){for(var e in this.collapse)this.collapse[e]||(this.collapse[e]=!0);this.toggleCollapse=!1},collapseAll:function(){for(var e in this.collapse)this.collapse[e]&&(this.collapse[e]=!1);this.toggleCollapse=!0},observableAccent:function(e){if(3==e)return{"danger-accent":!0};switch(e){case 0:return{"success-accent":!0};case 1:return{"warning-accent":!0};case 2:return{"danger-accent":!0};default:return{"success-accent":!0}}},onHighlight:function(e){console.log("highlight",e)},onShare:function(e){console.log("share",e)}},filters:{firstTwo:function(e){return e?(e=e.toString(),e.substring(0,2)):""},capitalize:function(e){return e?(e=e.toString(),e.toUpperCase()):""},truncate:function(e){var t=250;return e?(e=e.toString(),e.length>t?e.substring(0,t)+"...":e.substring(0,t)):""},defang:function(e){return e.replace(":","[:]").replace("http","hxxp").replace(".","[.]")}}},_=m,f=Object(u["a"])(_,a,o,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-5fcd1cd5.498960e4.js.map