(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-773f87ec"],{1019:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("CRow",[e.loading?s("CCol",{attrs:{col:""}},[s("div",{staticStyle:{margin:"auto","text-align":"center","verticle-align":"middle"}},[s("CSpinner",{staticStyle:{width:"6rem",height:"6rem"},attrs:{color:"dark"}})],1)]):s("CCol",{attrs:{col:""}},[s("CRow",[s("CCol",{attrs:{col:"12"}},[s("CCardHeader",[s("CRow",[s("CCol",{attrs:{col:"10"}},[e._l(e.caseFilters,(function(t){return s("li",{key:t.value+t.dataType,staticStyle:{display:"inline","margin-right":"2px"}},[s("CButton",{staticClass:"tag",attrs:{color:"secondary",size:"sm"},on:{click:function(s){return e.toggleCaseFilter({dataType:t.dataType.name,value:t.value})}}},[s("b",[e._v(e._s(t.dataType))]),e._v(": "),"severity"==t.filter_type?s("span",[e._v(e._s(e.getSeverityText(t.value).toLowerCase()))]):s("span",[e._v(e._s(t.value))])])],1)})),e.caseFilters.length>0?s("span",{staticClass:"separator"},[e._v("|")]):e._e(),e._v("Showing "+e._s(e.filtered_cases.length)+" cases. ")],2),s("CCol",{staticClass:"text-right",attrs:{col:"2"}},[s("CButton",{attrs:{color:"info",size:"sm"},on:{click:function(t){e.quick_filters=!e.quick_filters}}},[e._v("Quick Filters")])],1)],1)],1),s("CCollapse",{attrs:{show:e.quick_filters}},[s("CNav",{attrs:{variant:"tabs",justified:!0}},[s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"status",dataType:"status",value:"New"})}}},[e._v(" New ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"status",dataType:"status",value:"In Progress"})}}},[e._v(" In Progress ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"status",dataType:"status",value:"Closed"})}}},[e._v(" Closed ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"cases",dataType:"cases",value:"My Cases"})}}},[e._v(" My Cases ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"tasks",dataType:"tasks",value:"Cases I have Tasks"})}}},[e._v(" My Tasks ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"severity",dataType:"severity",value:4})}}},[e._v(" Critical ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"severity",dataType:"severity",value:3})}}},[e._v(" High ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"severity",dataType:"severity",value:2})}}},[e._v(" Medium ")])]),s("CNavItem",[s("div",{on:{click:function(t){return e.toggleCaseFilter({filter_type:"severity",dataType:"severity",value:1})}}},[e._v(" Low ")])])],1)],1)],1)],1),s("CRow",{staticStyle:{padding:"10px"}},[s("CCol",{attrs:{col:"10"}},[s("CButton",{attrs:{color:"primary"},on:{click:function(t){e.newCaseModal=!e.newCaseModal}}},[e._v("New Case")])],1),s("CCol",{staticClass:"text-right",attrs:{col:"2"}})],1),s("CDataTable",{staticStyle:{"border-top":"1px solid #cfcfcf"},attrs:{hover:e.hover,striped:e.striped,bordered:e.bordered,small:e.small,fixed:e.fixed,items:e.filtered_cases,fields:e.fields,"items-per-page":e.small?25:10,dark:e.dark,sorter:{external:!0,resetable:!0},pagination:"",responsive:!1},scopedSlots:e._u([{key:"title",fn:function(t){var a=t.item;return[s("td",[s("router-link",{attrs:{to:""+a.uuid}},[e._v(e._s(a.title))]),s("br"),e._l(a.tags,(function(t){return s("li",{key:t.name,staticStyle:{display:"inline","margin-right":"2px"}},[s("CBadge",{staticStyle:{padding:"5px","margin-top":"10px","margin-right":"3px",cursor:"pointer"},attrs:{color:"info",size:"sm"},on:{click:function(s){return e.toggleCaseFilter({filter_type:"tag",dataType:"tag",value:t.name})}}},[e._v(e._s(t.name))])],1)}))],2)]}},{key:"status",fn:function(t){var a=t.item;return[s("td",[a.status?s("span",[e._v(e._s(a.status.name))]):e._e()])]}},{key:"events",fn:function(t){var a=t.item;return[s("td",[e._v(e._s(a.event_count>0?a.event_count:0))])]}},{key:"tlp",fn:function(t){var a=t.item;return[s("td",[1==a.tlp?s("CButton",{attrs:{color:"light",size:"sm"}},[e._v("TLP:WHITE")]):e._e(),2==a.tlp?s("CButton",{attrs:{color:"success",size:"sm"}},[e._v("TLP:GREEN")]):e._e(),3==a.tlp?s("CButton",{attrs:{color:"warning",size:"sm"}},[e._v("TLP:AMBER")]):e._e(),a.tlp>=4?s("CButton",{attrs:{color:"danger",size:"sm"}},[e._v("TLP:RED")]):e._e()],1)]}},{key:"severity",fn:function(t){var a=t.item;return[s("td",[s("CButton",{attrs:{color:e.getSeverityColor(a.severity),size:"sm"},on:{click:function(t){return e.toggleCaseFilter({filter_type:"severity",dataType:"severity",value:a.severity})}}},[e._v(e._s(e.getSeverityText(a.severity)))])],1)]}},{key:"owner",fn:function(t){var a=t.item;return[s("td",[e._v(e._s(a.owner&&a.owner.username?a.owner.username:"Unassigned"))])]}},{key:"actions",fn:function(t){var a=t.item;return[s("td",[s("CDropdown",{attrs:{"toggler-text":"Actions",color:"secondary",size:"sm"}},[a.closed?e._e():s("CDropdownItem",{on:{click:function(t){return e.toggleCloseCase(a.uuid)}}},[e._v("Close")]),a.closed?e._e():s("CDropdownItem",{on:{click:function(t){e.runPlaybookModal=!e.runPlaybookModal}}},[e._v("Execute Playbook")]),a.closed?e._e():s("CDropdownDivider"),s("CDropdownItem",{on:{click:function(t){return e.showDeleteCaseModal(a.uuid)}}},[e._v("Delete")])],1)],1)]}}])})],1),s("CreateCaseModal",{attrs:{show:e.newCaseModal},on:{"update:show":function(t){e.newCaseModal=t}}}),s("CModal",{attrs:{title:"Close Case",centered:!0,size:"lg",show:e.close_case_modal},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{type:"submit",form:"closeCaseForm",color:"primary"}},[e._v("Close")])]},proxy:!0}])},[s("CAlert",{attrs:{show:e.error,color:"danger",closeButton:""},on:{"update:show":function(t){e.error=t}}},[e._v(" "+e._s(e.error_message)+" ")]),s("CForm",{attrs:{id:"closeCaseForm"},on:{submit:function(t){return t.preventDefault(),e.closeCase(t)}}},[s("p",[e._v("You are about to close this case, select a reason for doing so. Providing additional context where necessary is recommended. Note, all open Events attached to this case will also be closed.")]),s("CSelect",{attrs:{options:e.close_reasons,label:"Reason",placeholder:"Select a reason for closing this case",value:e.closure_reason_uuid,required:""},on:{"update:value":function(t){e.closure_reason_uuid=t}}}),s("CTextarea",{attrs:{value:e.close_comment,required:e.settings.require_case_close_comment,disabled:""==e.closure_reason_uuid,label:"Additional information",rows:"5",placeholder:"Enter additional information related to the closure reason."},on:{change:function(t){e.close_comment=t}}})],1)],1),s("CModal",{attrs:{title:"Delete Case",color:"danger",centered:!0,size:"lg",show:e.deleteCaseModal},on:{"update:show":function(t){e.deleteCaseModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){e.deleteCaseModal=!e.deleteCaseModal}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"danger"},on:{click:function(t){return e.deleteCase()}}},[e._v("Delete")])]},proxy:!0}])},[s("div",[s("p",[e._v("Deleting a case is a permanent action, all work on the event will be removed and any associated events will be set to "),s("b",[e._v("New")]),e._v(" status, are you sure you want to continue?")])])])],1)},i=[],r=s("2f62"),l=s("4ea5"),o={name:"Cases",components:{CreateCaseModal:l["a"]},props:{items:Array,caption:{type:String,default:"Table"},hover:Boolean,striped:Boolean,bordered:Boolean,small:Boolean,fixed:Boolean,dark:Boolean,alert:!1},computed:Object(r["b"])(["settings"]),created:function(){this.filterCases(),this.loadClosureReasons(),this.refresh=setInterval(function(){this.filterCases()}.bind(this),6e4)},data:function(){return{name:"",description:"",dismissCountDown:10,loading:!0,newCaseModal:!1,deleteCaseModal:!1,target_case:"",fields:["title","status","events","tlp","severity","owner","actions"],available_fields:["title","status","events","tlp","severity","owner","actions","created_at","modified_at"],quick_filters:!1,caseFilters:[{filter_type:"status",dataType:"status",value:"New"}],filtered_cases:[],page_data:{},close_reasons:[],case_closed:!1,status_uuid:"",target_case_uuid:"",close_comment:"",error:!1,error_message:"",closure_reason_uuid:"",close_case_modal:!1}},methods:{dismiss:function(){this.closure_reason_uuid=void 0,this.error=!1,this.error_message="",this.status_uuid=void 0,this.target_case="",this.close_comment="",this.close_case_modal=!1},closeCase:function(){var e=this,t={message:this.close_comment,case_uuid:this.target_case,is_closure_comment:!0,closure_reason_uuid:this.closure_reason_uuid};this.$store.dispatch("createCaseComment",t);var s={status_uuid:this.status_uuid,close_reason_uuid:this.closure_reason_uuid},a=this.target_case;this.$store.dispatch("updateCase",{uuid:a,data:s}).then((function(t){e.filterCases()})),this.dismiss()},toggleCloseCase:function(e){this.target_case=e,this.loadClosureReasons(),this.loadCaseStatuses(),this.close_case_modal=!this.close_case_modal},loadClosureReasons:function(){var e=this;this.$store.dispatch("getCloseReasons").then((function(t){e.close_reasons=t.data.map((function(e){return{label:e.title,value:e.uuid}}))}))},addSuccess:function(){return"success"==this.$store.getters.addSuccess},showDeleteCaseModal:function(e){this.target_case=e,this.deleteCaseModal=!this.deleteCaseModal},loadCaseStatuses:function(){var e=this;this.$store.dispatch("getCaseStatus").then((function(t){e.status_uuid=t.data.find((function(e){return"Closed"===e.name})).uuid}))},deleteCase:function(){var e=this,t=this.target_case;this.$store.dispatch("deleteCase",t).then((function(t){e.filtered_cases=e.$store.getters.cases,e.target_case="",e.deleteCaseModal=!e.deleteCaseModal}))},getSeverityColor:function(e){switch(e){case 1:return"dark";case 2:return"info";case 3:return"warning";case 4:return"danger";default:return"dark"}},getSeverityText:function(e){switch(e){case 1:return"Low";case 2:return"Medium";case 3:return"High";case 4:return"Critical";default:return"Low"}},filterCases:function(){var e=this;this.$store.commit("add_start");var t=[],s=[],a=[],i=[],r=[],l=!1,o=!1;for(var n in this.caseFilters){var c=this.caseFilters[n];"status"==c.filter_type&&t.push(c.value),"tag"==c.filter_type&&s.push(c.value),"search"==c.filter_type&&(i=c.value),"severity"==c.filter_type&&a.push(c.value),"owner"==c.filter_type&&r.push(c.value),"tasks"==c.filter_type&&(o=!0),"cases"==c.filter_type&&(l=!0)}this.$store.dispatch("getCases",{tag:s,status:t,severity:a,search:i,owner:r,fields:["title","status","tlp","severity","owner","uuid","id","event_count"],my_cases:l,my_tasks:o,page:this.current_page,page_size:this.card_per_page}).then((function(t){e.filtered_cases=e.$store.getters.cases,e.page_data=t.data.pagination,e.$store.commit("add_success"),e.loading=!1}))},toggleCaseFilter:function(e){var t=this.caseFilters.some((function(t){return t.value==e.value}));"status"==e.filter_type&&(this.caseFilters=this.caseFilters.filter((function(t){return t.filter_type!==e.filter_type}))),"cases"==e.filter_type&&(this.caseFilters=this.caseFilters.filter((function(e){return"tasks"!=e.filter_type}))),"tasks"==e.filter_type&&(this.caseFilters=this.caseFilters.filter((function(e){return"cases"!=e.filter_type}))),t?this.caseFilters=this.caseFilters.filter((function(t){return t.value!==e.value})):this.caseFilters.push(e),this.filterCases()}},beforeDestroy:function(){clearInterval(this.refresh)}},n=o,c=(s("19bd"),s("2877")),u=Object(c["a"])(n,a,i,!1,null,"b999201c",null);t["default"]=u.exports},"19bd":function(e,t,s){"use strict";var a=s("2185"),i=s.n(a);i.a},2185:function(e,t,s){},"4ea5":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("link",{attrs:{rel:"stylesheet",href:"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css"}}),s("CModal",{attrs:{title:"Create Case",centered:!0,size:"lg",show:e.modalStatus},on:{"update:show":function(t){e.modalStatus=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(t){return e.dismiss()}}},[e._v("Dismiss")]),s("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.createCase()}}},[e._v("Create")])]},proxy:!0}])},[s("div",[e.events&&e.events.length>1?s("p",[e._v("This case will be associated with "),s("b",[e._v(e._s(e.events.length))]),e._v(" events.")]):e._e(),s("CForm",{on:{submit:function(t){return t.preventDefault(),e.createCase(t)}}},[s("CInput",{attrs:{placeholder:"Case Title",required:"",label:"Case Title"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),s("label",{staticStyle:{"text-align":"center","vertical-align":"middle","padding-bottom":".8em"}},[e._v("Assign Case Template?")]),e._v(" "),s("CSwitch",{attrs:{color:"success","label-on":"Yes","label-off":"No",checked:e.use_case_template,disabled:e.settings.require_case_templates},on:{"update:checked":function(t){e.use_case_template=t}}}),e.use_case_template?s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("multiselect",{attrs:{label:"title",options:e.case_templates,"track-by":"uuid",searchable:!0,"internal-search":!1,"options-limit":10,"show-no-results":!1},on:{"search-change":e.caseTemplateFind},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" "+e._s(t.option.title)),s("br"),s("small",[e._v(e._s(t.option.description)),s("br"),e._v("Contains "+e._s(t.option.task_count)+" tasks.")])]}}],null,!1,965155483),model:{value:e.case_template,callback:function(t){e.case_template=t},expression:"case_template"}})],1):e._e(),e.case_template&&e.case_template.task_count>0?s("span",[s("label",[e._v("Tasks")]),s("br"),s("b",[e._v(e._s(e.case_template.task_count))]),e._v(" tasks will be added automatically to this case."),s("br"),s("br")]):e._e(),s("label",[e._v("Case Owner")]),s("multiselect",{attrs:{label:"username",options:e.users,"track-by":"username",searchable:!0,"internal-search":!1,"options-limit":25,"show-no-results":!1},on:{"search-change":e.usersFind},model:{value:e.owner,callback:function(t){e.owner=t},expression:"owner"}}),s("br"),s("CTextarea",{attrs:{placeholder:"Enter a description for the case.  The more detail the better.",required:"",label:"Description",rows:"5"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),s("CRow",[s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"TLP",options:e.tlps,value:e.tlp,placeholder:"Select a TLP"},on:{"update:value":function(t){e.tlp=t}}})],1),s("CCol",{attrs:{col:"12",lg:"6"}},[s("CSelect",{attrs:{label:"Severity",options:e.severities,value:e.severity,placeholder:"Select a Severity"},on:{"update:value":function(t){e.severity=t}}})],1)],1),s("div",{staticClass:"form-group",attrs:{role:"group"}},[s("label",{staticClass:"typo__label"},[e._v("Tags")]),s("multiselect",{attrs:{placeholder:"Select tags to apply to this input",taggable:!0,"tag-placeholder":"Add new tag","track-by":"name",label:"name",options:e.tag_list,multiple:!0,"close-on-select":!1},on:{tag:e.addTag},model:{value:e.selected_tags,callback:function(t){e.selected_tags=t},expression:"selected_tags"}})],1)],1)],1)])],1)},i=[],r=(s("4a7a"),s("2f62")),l={name:"CreateCaseModal",props:{show:Boolean,events:Array},computed:Object(r["b"])(["settings"]),data:function(){return{title:"",description:"",selected_tags:Array(),use_case_template:!1,case_templates:[],case_template:null,tlp:2,users:[],owner:null,severity:2,modalStatus:this.show,severities:[{label:"Low",value:1},{label:"Medium",value:2},{label:"High",value:3},{label:"Critical",value:4}],tlps:[{label:"WHITE",value:1},{label:"GREEN",value:2},{label:"AMBER",value:3},{label:"RED",value:4}],tag_list:[],tags:Array}},watch:{show:function(){this.modalStatus=this.show},settings:function(){this.use_case_template=this.settings.require_case_templates},modalStatus:function(){this.modalStatus&&(this.loadTags(),this.loadData(),this.loadUsers()),this.$emit("update:show",this.modalStatus),this.modalStatus||this.reset()},case_template:function(){this.applyCaseTemplate()},use_case_template:function(){this.use_case_template||(this.case_template=null),this.applyCaseTemplate()}},created:function(){},methods:{usersFind:function(e){var t=this;this.$store.dispatch("getUsersByName",e).then((function(e){t.users=t.$store.getters.users}))},applyCaseTemplate:function(){var e=this;for(var t in this.case_template&&(this.severity=this.case_template.severity,this.tlp=this.case_template.tlp),this.selected_tags)"from_template"in this.selected_tags[t]&&this.selected_tags.splice(t,1);if(this.case_template){var s=function(t){e.selected_tags.filter((function(s){return s.uuid===e.case_template.tags[t].uuid})).length<1&&(e.case_template.tags[t]["from_template"]=!0,e.selected_tags.push(e.case_template.tags[t]))};for(var a in this.case_template.tags)s(a)}},loadUsers:function(){var e=this;this.$store.dispatch("getUsers").then((function(t){e.users=e.$store.getters.users}))},loadCaseTemplates:function(){},loadData:function(){var e=this;this.$store.dispatch("getCaseTemplateList","").then((function(t){e.case_templates=t.data}))},caseTemplateFind:function(e){var t=this;this.$store.dispatch("getCaseTemplateList",e).then((function(e){t.case_templates=e.data}))},createCase:function(){var e=this,t=this.title,s=this.description,a=[],i=this.severity,r=this.tlp,l=Array();if(this.events)for(var o in this.events)a.push(this.events[o]);for(var n in this.selected_tags)l.push(this.selected_tags[n].name);var c={title:t,description:s,events:a,tlp:r,severity:i,tags:l};if(this.owner&&(c["owner_uuid"]=this.owner.uuid),this.case_template){var u=this.case_template.uuid;c={title:t,description:s,case_template_uuid:u,events:a,tlp:r,severity:i,tags:l}}this.$store.dispatch("createCase",c).then((function(t){if(200==t.status){e.modalStatus=!1;var s=t.data.uuid;e.$router.push({name:"View Case",params:{uuid:s}})}})).catch((function(e){console.log(e)}))},loadTags:function(){var e=this;this.tag_list=Array(),this.$store.dispatch("getTags").then((function(t){for(var s in t.data)e.tag_list.push({name:t.data[s].name,uuid:t.data[s].uuid})}))},reset:function(){this.use_case_template=this.settings.require_case_templates,this.case_template=null,this.severity=2,this.tlp=2,this.selected_tags=Array()},dismiss:function(){this.reset(),this.modalStatus=!1},addTag:function(e){var t={name:e,uuid:""};this.tag_list.push(t),this.selected_tags.push(t)}}},o=l,n=s("2877"),c=Object(n["a"])(o,a,i,!1,null,null,null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-773f87ec.b23fe767.js.map