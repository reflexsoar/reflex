{"version":3,"sources":["webpack:///./src/views/CreateCaseModal.vue?2d1e","webpack:///src/views/CreateCaseModal.vue","webpack:///./src/views/CreateCaseModal.vue?198f","webpack:///./src/views/CreateCaseModal.vue","webpack:///./src/views/MergeEventIntoCaseModal.vue?1d94","webpack:///src/views/MergeEventIntoCaseModal.vue","webpack:///./src/views/MergeEventIntoCaseModal.vue?9345","webpack:///./src/views/MergeEventIntoCaseModal.vue","webpack:///./src/views/AlertsList.vue?7dac","webpack:///./src/views/CreateEventRuleModal.vue?014d","webpack:///src/views/CreateEventRuleModal.vue","webpack:///./src/views/CreateEventRuleModal.vue?b62f","webpack:///./src/views/CreateEventRuleModal.vue","webpack:///src/views/AlertsList.vue","webpack:///./src/views/AlertsList.vue?dfa4","webpack:///./src/views/AlertsList.vue","webpack:///./src/views/AlertsList.vue?9cb6"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalStatus","on","$event","scopedSlots","_u","key","fn","dismiss","_v","createCase","proxy","events","length","_s","_e","preventDefault","model","value","callback","$$v","title","expression","staticStyle","use_case_template","settings","require_case_templates","staticClass","case_templates","caseTemplateFind","props","option","description","task_count","case_template","users","usersFind","owner","tlps","tlp","severities","severity","tag_list","addTag","selected_tags","staticRenderFns","component","case_data","mergeEventIntoCase","cases","caseLabel","caseFind","id","getSeverity","username","event_count","_f","alert","show","type","$set","message","_l","obs","toggleObservableFilter","dataType","name","filter_type","getSeverityText","toLowerCase","filteredBySignature","observableFilters","filtered_events","quick_filters","eventCountByStatus","eventCountBySeverity","select_all","selected","clearSelected","selectAll","sort_options","sort_by","target","filterEvents","card_per_page","current_page","page_data","pages","indexOf","_k","keyCode","search_filter","table_view","setColumns","dismissEventModal","runPlaybookModal","createCaseModal","mergeIntoCaseModal","deleteEventModal","status","fields","resetable","nativeOn","pauseRefresh","ref","item","case_uuid","closed","directives","rawName","domProps","uuid","Array","isArray","_i","$$a","$$el","$$c","checked","$$i","concat","slice","observables","extraObservables","tag","content","placement","reference","created_at","related_events_count","signature","getSeverityColor","new_related_events","createEventRule","caseFromCard","reopenEvent","dismissEventFromCard","observable_count","event","columns","includes","selectEvents","dismiss_reason","dismissEvent","close_reasons","dismissalReason","require_event_dismiss_comment","dismissalComment","createEventRuleModal","event_signature","rule_observables","deleteEvent","step","previousStep","final_step","nextStep","expire","expire_days","observableLabel","dismiss_event","merge_into_case","target_case","items","caption","String","default","hover","Boolean","striped","bordered","small","fixed","dark"],"mappings":"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","file":"js/chunk-b6c50126.474b4113.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('link',{attrs:{\"rel\":\"stylesheet\",\"href\":\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\"}}),_c('CModal',{attrs:{\"title\":\"Create Case\",\"centered\":true,\"size\":\"lg\",\"show\":_vm.modalStatus},on:{\"update:show\":function($event){_vm.modalStatus=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.dismiss()}}},[_vm._v(\"Dismiss\")]),_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.createCase()}}},[_vm._v(\"Create\")])]},proxy:true}])},[_c('div',[(_vm.events && _vm.events.length > 1)?_c('p',[_vm._v(\"This case will be associated with \"),_c('b',[_vm._v(_vm._s(_vm.events.length))]),_vm._v(\" events.\")]):_vm._e(),_c('CForm',{on:{\"submit\":function($event){$event.preventDefault();return _vm.createCase($event)}}},[_c('CInput',{attrs:{\"placeholder\":\"Case Title\",\"required\":\"\",\"label\":\"Case Title\"},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}}),_c('label',{staticStyle:{\"text-align\":\"center\",\"vertical-align\":\"middle\",\"padding-bottom\":\".8em\"}},[_vm._v(\"Assign Case Template?\")]),_vm._v(\" \"),_c('CSwitch',{attrs:{\"color\":\"success\",\"label-on\":\"Yes\",\"label-off\":\"No\",\"checked\":_vm.use_case_template,\"disabled\":_vm.settings.require_case_templates},on:{\"update:checked\":function($event){_vm.use_case_template=$event}}}),(_vm.use_case_template)?_c('div',{staticClass:\"form-group\",attrs:{\"role\":\"group\"}},[_c('multiselect',{attrs:{\"label\":\"title\",\"options\":_vm.case_templates,\"track-by\":\"uuid\",\"searchable\":true,\"internal-search\":false,\"options-limit\":10,\"show-no-results\":false},on:{\"search-change\":_vm.caseTemplateFind},scopedSlots:_vm._u([{key:\"option\",fn:function(props){return [_vm._v(\" \"+_vm._s(props.option.title)),_c('br'),_c('small',[_vm._v(_vm._s(props.option.description)),_c('br'),_vm._v(\"Contains \"+_vm._s(props.option.task_count)+\" tasks.\")])]}}],null,false,965155483),model:{value:(_vm.case_template),callback:function ($$v) {_vm.case_template=$$v},expression:\"case_template\"}})],1):_vm._e(),(_vm.case_template && _vm.case_template.task_count > 0)?_c('span',[_c('label',[_vm._v(\"Tasks\")]),_c('br'),_c('b',[_vm._v(_vm._s(_vm.case_template.task_count))]),_vm._v(\" tasks will be added automatically to this case.\"),_c('br'),_c('br')]):_vm._e(),_c('label',[_vm._v(\"Case Owner\")]),_c('multiselect',{attrs:{\"label\":\"username\",\"options\":_vm.users,\"track-by\":\"username\",\"searchable\":true,\"internal-search\":false,\"options-limit\":25,\"show-no-results\":false},on:{\"search-change\":_vm.usersFind},model:{value:(_vm.owner),callback:function ($$v) {_vm.owner=$$v},expression:\"owner\"}}),_c('br'),_c('CTextarea',{attrs:{\"placeholder\":\"Enter a description for the case.  The more detail the better.\",\"required\":\"\",\"label\":\"Description\",\"rows\":\"5\"},model:{value:(_vm.description),callback:function ($$v) {_vm.description=$$v},expression:\"description\"}}),_c('CRow',[_c('CCol',{attrs:{\"col\":\"12\",\"lg\":\"6\"}},[_c('CSelect',{attrs:{\"label\":\"TLP\",\"options\":_vm.tlps,\"value\":_vm.tlp,\"placeholder\":\"Select a TLP\"},on:{\"update:value\":function($event){_vm.tlp=$event}}})],1),_c('CCol',{attrs:{\"col\":\"12\",\"lg\":\"6\"}},[_c('CSelect',{attrs:{\"label\":\"Severity\",\"options\":_vm.severities,\"value\":_vm.severity,\"placeholder\":\"Select a Severity\"},on:{\"update:value\":function($event){_vm.severity=$event}}})],1)],1),_c('div',{staticClass:\"form-group\",attrs:{\"role\":\"group\"}},[_c('label',{staticClass:\"typo__label\"},[_vm._v(\"Tags\")]),_c('multiselect',{attrs:{\"placeholder\":\"Select tags to apply to this input\",\"taggable\":true,\"tag-placeholder\":\"Add new tag\",\"track-by\":\"name\",\"label\":\"name\",\"options\":_vm.tag_list,\"multiple\":true,\"close-on-select\":false},on:{\"tag\":_vm.addTag},model:{value:(_vm.selected_tags),callback:function ($$v) {_vm.selected_tags=$$v},expression:\"selected_tags\"}})],1)],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div><link rel=\"stylesheet\" href=\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\">\r\n    <CModal title=\"Create Case\" :centered=\"true\" size=\"lg\" :show.sync=\"modalStatus\">\r\n      <div>\r\n        <p v-if=\"events && events.length > 1\">This case will be associated with <b>{{events.length}}</b> events.</p>\r\n        <CForm @submit.prevent=\"createCase\" >\r\n            <CInput\r\n              placeholder=\"Case Title\"\r\n              required\r\n              v-model=\"title\"\r\n              label=\"Case Title\"\r\n            >\r\n            </CInput>\r\n            <label style=\"text-align:center; vertical-align:middle; padding-bottom:.8em\">Assign Case Template?</label>&nbsp;&nbsp;&nbsp;<CSwitch color=\"success\" label-on=\"Yes\" label-off=\"No\" v-bind:checked.sync=\"use_case_template\" v-bind:disabled=\"settings.require_case_templates\"/>\r\n            <div role=\"group\" class=\"form-group\" v-if=\"use_case_template\">\r\n                <multiselect \r\n                    v-model=\"case_template\" \r\n                    label=\"title\" \r\n                    :options=\"case_templates\" \r\n                    track-by=\"uuid\" \r\n                    :searchable=\"true\"\r\n                    :internal-search=\"false\"\r\n                    :options-limit=\"10\"\r\n                    :show-no-results=\"false\" \r\n                    @search-change=\"caseTemplateFind\">\r\n                    <template slot=\"option\" slot-scope=\"props\">\r\n                        {{props.option.title}}</br>\r\n                        <small>{{props.option.description}}<br>Contains {{props.option.task_count}} tasks.</small>\r\n                    </template>\r\n                </multiselect>\r\n            </div>\r\n            <span v-if=\"case_template && case_template.task_count > 0\"><label>Tasks</label><br><b>{{case_template.task_count}}</b> tasks will be added automatically to this case.<br><br></span>\r\n            <label>Case Owner</label>\r\n            <multiselect \r\n                v-model=\"owner\" \r\n                label=\"username\" \r\n                :options=\"users\" \r\n                track-by=\"username\" \r\n                :searchable=\"true\"\r\n                :internal-search=\"false\"\r\n                :options-limit=\"25\"\r\n                :show-no-results=\"false\"\r\n                @search-change=\"usersFind\">\r\n            </multiselect><br>\r\n            <CTextarea\r\n              placeholder=\"Enter a description for the case.  The more detail the better.\"\r\n              required\r\n              v-model=\"description\"\r\n              label=\"Description\"\r\n              rows=5\r\n            >\r\n            </CTextarea>\r\n            <CRow>\r\n              <CCol col=\"12\" lg=\"6\">\r\n                <CSelect \r\n                    label=\"TLP\"\r\n                    :options=\"tlps\"\r\n                    :value.sync=\"tlp\"\r\n                    placeholder=\"Select a TLP\"\r\n                  >\r\n                  </CSelect>\r\n              </CCol>\r\n              <CCol col=\"12\" lg=\"6\">\r\n                <CSelect \r\n                    label=\"Severity\"\r\n                    :options=\"severities\"\r\n                    :value.sync=\"severity\"\r\n                    placeholder=\"Select a Severity\"\r\n                  >\r\n                  </CSelect>\r\n              </CCol>\r\n            </CRow>\r\n            <div role=\"group\" class=\"form-group\">\r\n                <label class=\"typo__label\">Tags</label>\r\n                <multiselect v-model=\"selected_tags\" placeholder=\"Select tags to apply to this input\" :taggable=\"true\" tag-placeholder=\"Add new tag\" track-by=\"name\" label=\"name\" :options=\"tag_list\" :multiple=\"true\" @tag=\"addTag\" :close-on-select=\"false\">\r\n                </multiselect>\r\n            </div>\r\n        </CForm>\r\n      </div>\r\n      <template #footer>\r\n          <CButton @click=\"dismiss()\" color=\"secondary\">Dismiss</CButton>\r\n        <CButton @click=\"createCase()\" color=\"primary\">Create</CButton>\r\n      </template>\r\n    </CModal>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport {vSelect} from \"vue-select\";\r\nimport { mapState} from 'vuex';\r\nexport default {\r\n    name: 'CreateCaseModal',\r\n    props: {\r\n        show: Boolean,\r\n        events: Array,\r\n    },\r\n    computed: mapState(['settings']),\r\n    data(){\r\n        return {\r\n            title: \"\",\r\n            description: \"\",\r\n            selected_tags: Array(),\r\n            use_case_template: false,\r\n            case_templates: [],\r\n            case_template: null,\r\n            tlp: 2,\r\n            users:[],\r\n            owner: null,\r\n            severity: 2,\r\n            modalStatus: this.show,\r\n            severities: [\r\n                {'label':'Low', 'value':1},\r\n                {'label':'Medium', 'value':2},\r\n                {'label':'High', 'value':3},\r\n                {'label':'Critical', 'value':4}\r\n            ],\r\n            tlps: [\r\n                {'label': 'WHITE', 'value':1},\r\n                {'label': 'GREEN', 'value':2},\r\n                {'label': 'AMBER', 'value':3},\r\n                {'label': 'RED', 'value':4}\r\n            ],\r\n            tag_list: [],\r\n            tags: Array\r\n        }\r\n    },\r\n    watch: {\r\n        show: function() {\r\n            this.modalStatus = this.show\r\n        },\r\n        settings: function() {\r\n            this.use_case_template = this.settings.require_case_templates\r\n        },\r\n        modalStatus: function(){\r\n            if(this.modalStatus) {\r\n                this.loadTags()\r\n                this.loadData()\r\n                this.loadUsers()\r\n            }\r\n            this.$emit('update:show', this.modalStatus)\r\n            if(!this.modalStatus) {\r\n                this.reset()\r\n            }\r\n        },\r\n        case_template: function() {\r\n            this.applyCaseTemplate()\r\n        },\r\n        use_case_template: function() {\r\n            if(!this.use_case_template) {\r\n                this.case_template = null\r\n            }\r\n            \r\n            this.applyCaseTemplate()\r\n        }\r\n    },\r\n    created() {\r\n    },\r\n    methods: {\r\n        usersFind(query) {\r\n            this.$store.dispatch('getUsersByName', query).then(resp => {\r\n                this.users = this.$store.getters.users\r\n            })\r\n        },\r\n        applyCaseTemplate() {\r\n            if(this.case_template) {\r\n                this.severity = this.case_template.severity\r\n                this.tlp = this.case_template.tlp\r\n            }\r\n\r\n            // Remove tags when the template was changed\r\n            // removing only case template tags\r\n            for(let tag in this.selected_tags) {\r\n                if('from_template' in this.selected_tags[tag]) {\r\n                    this.selected_tags.splice(tag, 1)\r\n                }\r\n            }\r\n\r\n            // Add the tags from the new case template\r\n            if(this.case_template) {\r\n                for(let tag in this.case_template.tags) {\r\n                    if(this.selected_tags.filter(t => t.uuid === this.case_template.tags[tag].uuid).length < 1) {\r\n                        this.case_template.tags[tag]['from_template'] = true\r\n                        this.selected_tags.push(this.case_template.tags[tag])\r\n                    }                    \r\n                }\r\n            }\r\n        },\r\n        loadUsers() {\r\n            this.$store.dispatch('getUsers').then(resp => {\r\n                this.users = this.$store.getters.users\r\n            })\r\n        },\r\n        loadCaseTemplates() {\r\n\r\n        },\r\n        loadData() {\r\n            this.$store.dispatch('getCaseTemplateList', '').then(resp => {\r\n                this.case_templates = resp.data\r\n            })\r\n        },\r\n        caseTemplateFind(query) {\r\n            this.$store.dispatch('getCaseTemplateList', query).then(resp => {\r\n                this.case_templates = resp.data\r\n            })\r\n        },\r\n        createCase() {\r\n            let title = this.title;\r\n            let description = this.description;\r\n            let events = [];\r\n            let severity = this.severity;\r\n            let tlp = this.tlp;\r\n            let tags = Array();\r\n\r\n            if(this.events) {\r\n                for(let evt in this.events) {\r\n                    events.push(this.events[evt])\r\n                }\r\n            }\r\n\r\n            for(let tag in this.selected_tags) {\r\n                tags.push(this.selected_tags[tag].name)\r\n            }\r\n\r\n            let request_data = {title,description,events,tlp,severity,tags}\r\n            if(this.owner) {\r\n                request_data['owner_uuid'] = this.owner.uuid\r\n            }\r\n\r\n            if(this.case_template) {\r\n                let case_template_uuid = this.case_template.uuid;\r\n                request_data = {title,description,case_template_uuid, events,tlp,severity,tags}\r\n            }\r\n\r\n            this.$store.dispatch('createCase', request_data)\r\n            .then(resp => {\r\n                if(resp.status == 200) {\r\n                    this.modalStatus = false\r\n                    let case_uuid = resp.data.uuid\r\n                    this.$router.push({name:'View Case', params:{uuid:case_uuid}})\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n            })\r\n        },\r\n        loadTags: function() {\r\n            this.tag_list = Array()\r\n            this.$store.dispatch('getTags').then(resp => {\r\n                for(let i in resp.data) {\r\n                    this.tag_list.push({'name': resp.data[i].name, 'uuid': resp.data[i].uuid})\r\n                }\r\n            })\r\n        },\r\n        reset () {\r\n            this.use_case_template = this.settings.require_case_templates\r\n            this.case_template = null\r\n            this.severity = 2\r\n            this.tlp = 2\r\n            this.selected_tags = Array()\r\n        },\r\n        dismiss() {\r\n            this.reset()\r\n            this.modalStatus = false            \r\n        },\r\n        addTag(newTag) {\r\n            const t = {\r\n                name: newTag,\r\n                uuid: ''\r\n            }\r\n            this.tag_list.push(t)\r\n            this.selected_tags.push(t)\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateCaseModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateCaseModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateCaseModal.vue?vue&type=template&id=ee9c8d02&\"\nimport script from \"./CreateCaseModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateCaseModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('link',{attrs:{\"rel\":\"stylesheet\",\"href\":\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\"}}),_c('CModal',{attrs:{\"title\":\"Merge Event Into Case\",\"centered\":true,\"size\":\"lg\",\"show\":_vm.modalStatus},on:{\"update:show\":function($event){_vm.modalStatus=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.dismiss()}}},[_vm._v(\"Dismiss\")]),_c('CButton',{attrs:{\"disabled\":!_vm.case_data,\"color\":\"primary\"},on:{\"click\":function($event){return _vm.mergeEventIntoCase()}}},[_vm._v(\"Merge\")])]},proxy:true}])},[_c('div',[_c('p',[_vm._v(\"Merging \"),_c('b',[_vm._v(_vm._s(_vm.events.length))]),_vm._v(\" event\"),(_vm.events.length > 1)?_c('span',[_vm._v(\"s\")]):_vm._e(),_vm._v(\".\")]),_c('multiselect',{attrs:{\"label\":\"title\",\"options\":_vm.cases,\"track-by\":\"uuid\",\"searchable\":true,\"internal-search\":false,\"options-limit\":10,\"show-no-results\":false,\"custom-label\":_vm.caseLabel,\"placeholder\":\"Select a case\"},on:{\"search-change\":_vm.caseFind},scopedSlots:_vm._u([{key:\"option\",fn:function(props){return [_vm._v(\" #\"+_vm._s(props.option.id)+\" - \"+_vm._s(props.option.title)),_c('br'),_c('small',[_c('b',[_vm._v(\"Severity: \")]),_vm._v(_vm._s(_vm.getSeverity(props.option.severity))+\" | \"),_c('b',[_vm._v(\"Owner:\")]),_vm._v(\" \"+_vm._s(props.option.owner.username || \"Unassigned\")+\" | Contains \"+_vm._s(props.option.event_count)+\" events.\")]),_c('br'),_c('small',[_vm._v(_vm._s(_vm._f(\"truncate\")(props.option.description)))])]}}]),model:{value:(_vm.case_data),callback:function ($$v) {_vm.case_data=$$v},expression:\"case_data\"}})],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div><link rel=\"stylesheet\" href=\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\">\r\n\r\n    <CModal title=\"Merge Event Into Case\" :centered=\"true\" size=\"lg\" :show.sync=\"modalStatus\">\r\n      <div>\r\n          <p>Merging <b>{{events.length}}</b> event<span v-if=\"events.length > 1\">s</span>.</p>\r\n           <multiselect \r\n                v-model=\"case_data\"\r\n                label=\"title\" \r\n                :options=\"cases\" \r\n                track-by=\"uuid\" \r\n                :searchable=\"true\"\r\n                :internal-search=\"false\"\r\n                :options-limit=\"10\"\r\n                :show-no-results=\"false\" \r\n                :custom-label=\"caseLabel\"\r\n                @search-change=\"caseFind\"\r\n                placeholder=\"Select a case\">\r\n                <template slot=\"option\" slot-scope=\"props\">\r\n                    #{{props.option.id}} - {{props.option.title}}<br>\r\n                    <small><b>Severity: </b>{{getSeverity(props.option.severity)}} | <b>Owner:</b> {{props.option.owner.username || \"Unassigned\" }} | Contains {{props.option.event_count}} events.</small><br>\r\n                    <small>{{props.option.description | truncate}}</small>\r\n                </template>\r\n            </multiselect>\r\n      </div>\r\n      <template #footer>\r\n          <CButton @click=\"dismiss()\" color=\"secondary\">Dismiss</CButton>\r\n        <CButton @click=\"mergeEventIntoCase()\" v-bind:disabled=\"!case_data\" color=\"primary\">Merge</CButton>\r\n      </template>\r\n    </CModal>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport {vSelect} from \"vue-select\";\r\nimport { mapState } from 'vuex';\r\nexport default {\r\n    name: 'MergeEventIntoCaseModal',\r\n    props: {\r\n        show: Boolean,\r\n        events: Array,\r\n    },\r\n    computed: mapState(['settings','cases']),\r\n    data(){\r\n        return {\r\n            case_data: {},\r\n            modalStatus: false\r\n        }\r\n    },\r\n    watch: {\r\n        show: function() {\r\n            this.modalStatus = this.show\r\n        },\r\n        modalStatus: function(){\r\n            if(this.modalStatus) {\r\n                this.loadData()\r\n            }\r\n            this.$emit('update:show', this.modalStatus)\r\n            if(!this.modalStatus) {\r\n                this.reset()\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        loadData() {\r\n            this.$store.dispatch('getCases', 'uuid,title,id,event_count,owner,severity')\r\n        },\r\n        caseLabel({id, title}) {\r\n            if(id && title) {\r\n                return `#${id} - ${title}`\r\n            }\r\n        },\r\n        getSeverity(severity) {\r\n            switch(severity) {\r\n                case 0: return \"Low\";\r\n                case 1: return \"Medium\";\r\n                case 2: return \"High\";\r\n                case 3: return \"Critical\";\r\n                default: return \"Low\"\r\n            }\r\n        },\r\n        caseFind(query) {\r\n            let fields = 'uuid,title,id,event_count,owner,severity'\r\n            this.$store.dispatch('getCasesByTitle', {title: query, fields})\r\n        },\r\n        mergeEventIntoCase() {\r\n            let uuid = this.case_data.uuid;\r\n            let events = {'events': this.events};\r\n            this.$store.dispatch('addEventsToCase', {uuid, events}).then(resp => {\r\n                this.modalStatus = false\r\n                this.$store.commit('show_alert', {'message':'Successfully merged events into Case.', 'type':'success'})\r\n                this.$router.push({path: '/cases/'+uuid})\r\n            })\r\n        },\r\n        reset () {\r\n            this.case_data = {}\r\n        },\r\n        dismiss() {\r\n            this.reset()\r\n            this.modalStatus = false            \r\n        }\r\n    },\r\n    filters: {\r\n      truncate: function (value) {\r\n            let maxLength = 100\r\n            if (!value) return ''\r\n            value = value.toString()\r\n            if (value.length > maxLength) {\r\n                return value.substring(0,maxLength) + \"...\"\r\n            } else {\r\n                return value.substring(0,maxLength)\r\n            }\r\n            \r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MergeEventIntoCaseModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MergeEventIntoCaseModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MergeEventIntoCaseModal.vue?vue&type=template&id=466c449e&\"\nimport script from \"./MergeEventIntoCaseModal.vue?vue&type=script&lang=js&\"\nexport * from \"./MergeEventIntoCaseModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('h2',[_vm._v(\"Events\")]),_c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CAlert',{attrs:{\"show\":_vm.alert.show,\"color\":_vm.alert.type,\"closeButton\":\"\"},on:{\"update:show\":function($event){return _vm.$set(_vm.alert, \"show\", $event)}}},[_vm._v(\" \"+_vm._s(_vm.alert.message)+\" \")])],1)],1),_c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CCard',[_c('CCardHeader',[_c('CRow',[_c('CCol',{attrs:{\"col\":\"10\"}},[_vm._l((_vm.observableFilters),function(obs){return _c('li',{key:obs.value,staticStyle:{\"display\":\"inline\",\"margin-right\":\"2px\"}},[_c('CButton',{staticClass:\"tag\",attrs:{\"color\":\"secondary\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'dataType': obs.dataType.name, 'value': obs.value})}}},[_c('b',[_vm._v(_vm._s(obs.dataType))]),_vm._v(\": \"),(obs.filter_type == 'severity')?_c('span',[_vm._v(_vm._s(_vm.getSeverityText(obs.value).toLowerCase()))]):_c('span',[_vm._v(_vm._s(obs.value))])])],1)}),(!_vm.filteredBySignature() && _vm.observableFilters.length > 0)?_c('span',[_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]),_vm._v(\"Showing \"+_vm._s(_vm.filtered_events.length)+\" grouped events.\")]):_vm._e(),(_vm.filteredBySignature() && _vm.observableFilters.length != 0)?_c('span',[(_vm.filteredBySignature() && _vm.observableFilters.length != 0)?_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]):_vm._e(),_vm._v(\"Showing \"+_vm._s(_vm.filtered_events ? _vm.filtered_events.length : 0)+\" events.\")]):_vm._e(),(_vm.observableFilters.length == 0)?_c('span',[_vm._v(\"Showing \"+_vm._s(_vm.filtered_events.length)+\" grouped events.\")]):_vm._e()],2),_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"2\"}},[_c('CButton',{attrs:{\"color\":\"info\",\"size\":\"sm\"},on:{\"click\":function($event){_vm.quick_filters = !_vm.quick_filters}}},[_vm._v(\"Quick Filters\")])],1)],1)],1),_c('CCollapse',{attrs:{\"show\":_vm.quick_filters}},[_c('CNav',{attrs:{\"variant\":\"tabs\",\"justified\":true}},[_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'New'})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountByStatus('New')))]),_vm._v(\" New \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Open'})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountByStatus('Open')))]),_vm._v(\" Open \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Closed'})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountByStatus('Closed')))]),_vm._v(\" Closed \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Dismissed'})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountByStatus('Dismissed')))]),_vm._v(\" Dismissed \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':3})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountBySeverity(3)))]),_vm._v(\" Critical \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':2})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountBySeverity(2)))]),_vm._v(\" High \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':1})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountBySeverity(1)))]),_vm._v(\" Medium \")])]),_c('CNavItem',[_c('div',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':0})}}},[_c('h1',[_vm._v(_vm._s(_vm.eventCountBySeverity(0)))]),_vm._v(\" Low \")])])],1)],1)],1)],1)],1),_c('CRow',[_c('CCol',{attrs:{\"col\":\"3\"}},[_c('div',[(_vm.select_all || _vm.selected.length != 0 && !_vm.filteredBySignature())?_c('CButton',{staticStyle:{\"margin-top\":\"-5px\"},attrs:{\"size\":\"sm\",\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.clearSelected()}}},[_c('CIcon',{attrs:{\"name\":\"cilXCircle\",\"size\":\"sm\"}})],1):_vm._e(),(!_vm.select_all && _vm.selected.length == 0 || _vm.filteredBySignature())?_c('CButton',{staticStyle:{\"margin-top\":\"-5px\"},attrs:{\"size\":\"sm\",\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.selectAll()}}},[_c('CIcon',{attrs:{\"name\":\"cilCheck\"}})],1):_vm._e(),_vm._v(\" \"),_c('CSelect',{staticClass:\"d-inline-block\",attrs:{\"options\":_vm.sort_options,\"placeholder\":\"Sort by\",\"value\":_vm.sort_by},on:{\"change\":function($event){_vm.sort_by = $event.target.value; _vm.filterEvents()}}}),_vm._v(\" \"),_c('CSelect',{staticClass:\"d-inline-block\",attrs:{\"placeholder\":\"Events per Page\",\"options\":[10,25,50,100]},on:{\"change\":function($event){_vm.card_per_page = $event.target.value; _vm.filterEvents()}}})],1)]),_c('CCol',{attrs:{\"col\":\"3\"}},[_c('center',[_c('CPagination',{attrs:{\"activePage\":_vm.current_page,\"pages\":_vm.page_data.pages},on:{\"update:activePage\":function($event){_vm.current_page=$event},\"update:active-page\":function($event){_vm.current_page=$event}}})],1)],1),_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"3\"}},[_c('CInput',{attrs:{\"placeholder\":\"Search\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.toggleObservableFilter({'filter_type':'search','dataType':'search','value':_vm.search_filter})}},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'search','dataType':'search','value':_vm.search_filter})}}},[_vm._v(\"Search\")])]},proxy:true}]),model:{value:(_vm.search_filter),callback:function ($$v) {_vm.search_filter=$$v},expression:\"search_filter\"}})],1),_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"3\"}},[_c('div',[(!_vm.table_view)?_c('CButton',{staticClass:\"d-inline-block\",attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.setColumns()}}},[_c('small',[_c('CIcon',{attrs:{\"name\":\"cilColumns\",\"size\":\"sm\"}})],1)]):_vm._e(),_vm._v(\" \"),_c('CButton',{staticClass:\"d-inline-block\",attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){_vm.table_view = !_vm.table_view}}},[(_vm.table_view)?_c('span',[_vm._v(\"Card\")]):_c('span',[_vm._v(\"Table\")]),_vm._v(\" View\")]),_vm._v(\" \"),_c('CDropdown',{staticClass:\"d-inline-block\",attrs:{\"toggler-text\":((_vm.selected.length) + \" events\"),\"color\":\"secondary\",\"disabled\":_vm.selected.length == 0}},[_c('CDropdownItem',{on:{\"click\":function($event){_vm.dismissEventModal = !_vm.dismissEventModal}}},[_vm._v(\"Dismiss Event\")]),_c('CDropdownItem',{on:{\"click\":function($event){_vm.runPlaybookModal = !_vm.runPlaybookModal}}},[_vm._v(\"Run Playbook\")]),_c('CDropdownItem',{on:{\"click\":function($event){_vm.createCaseModal = !_vm.createCaseModal}}},[_vm._v(\"Create Case\")]),_c('CDropdownItem',{on:{\"click\":function($event){_vm.mergeIntoCaseModal = !_vm.mergeIntoCaseModal}}},[_vm._v(\"Merge into Case\")]),_c('CDropdownDivider'),_c('CDropdownItem',{on:{\"click\":function($event){_vm.deleteEventModal = !_vm.deleteEventModal}}},[_vm._v(\"Delete\")])],1)],1)])],1),(_vm.status == 'loading')?_c('CRow',{attrs:{\"col\":\"\"}},[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('div',{staticStyle:{\"margin\":\"auto\",\"text-align\":\"center\",\"verticle-align\":\"middle\"}},[_c('CSpinner',{staticStyle:{\"width\":\"6rem\",\"height\":\"6rem\"},attrs:{\"color\":\"dark\"}})],1)])],1):(_vm.filtered_events.length == 0)?_c('CRow',[_c('CCol',{staticClass:\"text-center\",attrs:{\"col\":\"12\"}},[_c('h1',[_vm._v(\"No Events\")])])],1):(_vm.table_view)?_c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CCard',[_c('CCardBody',{staticStyle:{\"overflow-y\":\"scroll\",\"max-height\":\"600px\"}},[_c('CDataTable',{attrs:{\"items\":_vm.filtered_events,\"fields\":_vm.fields,\"striped\":true,\"sorter\":{resetable:true},\"responsive\":false},nativeOn:{\"mouseenter\":function($event){_vm.pauseRefresh = true},\"mouseleave\":function($event){_vm.pauseRefresh = false}},scopedSlots:_vm._u([{key:\"name\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[(!(item.case_uuid || item.status.closed))?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selected),expression:\"selected\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"value\":item.uuid,\"checked\":Array.isArray(_vm.selected)?_vm._i(_vm.selected,item.uuid)>-1:(_vm.selected)},on:{\"change\":function($event){var $$a=_vm.selected,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=item.uuid,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.selected=$$a.concat([$$v]))}else{$$i>-1&&(_vm.selected=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.selected=$$c}}}}):_vm._e(),_vm._v(\" \"),_c('a',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'title','dataType':'title','value':item.title})}}},[_vm._v(_vm._s(item.title))]),_c('br'),_c('CIcon',{attrs:{\"name\":\"cilCenterFocus\"}}),_vm._v(\" \"),_vm._l((item.observables.slice(0,2)),function(obs){return _c('li',{key:obs.uuid,staticStyle:{\"display\":\"inline\",\"margin-right\":\"2px\"}},[_c('CButton',{staticClass:\"tag\",staticStyle:{\"margin-top\":\"5px\",\"margin-bottom\":\"5px\"},attrs:{\"color\":\"secondary\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'observable', 'dataType': obs.dataType.name, 'value': obs.value})}}},[_c('b',[_vm._v(_vm._s(obs.dataType.name))]),_vm._v(\": \"+_vm._s(obs.value.toLowerCase()))])],1)}),(item.observables.length > 2)?_c('span',{directives:[{name:\"c-popover\",rawName:\"v-c-popover\",value:({'header':'Additional Observables', 'content':_vm.extraObservables(item.observables.slice(2))}),expression:\"{'header':'Additional Observables', 'content':extraObservables(item.observables.slice(2))}\"}],staticStyle:{\"cursor\":\"pointer\"}},[_c('small',[_vm._v(\" +\"+_vm._s(item.observables.length - 2))])]):_vm._e(),_c('br'),_c('CIcon',{attrs:{\"name\":\"cilTags\"}}),_vm._v(\" \"),_vm._l((item.tags),function(tag){return _c('li',{key:tag.name,staticStyle:{\"display\":\"inline\",\"margin-right\":\"2px\"}},[_c('CButton',{staticClass:\"tag\",attrs:{\"color\":\"dark\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'tag', 'dataType':'tag', 'value':tag.name})}}},[_vm._v(_vm._s(tag.name))])],1)})],2)]}},{key:\"reference\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_c('span',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({\n      content: (\"\" + (item.reference)),\n      placement: 'top'\n    }),expression:\"{\\n      content: `${item.reference}`,\\n      placement: 'top'\\n    }\"}]},[_vm._v(_vm._s(_vm._f(\"truncate\")(item.reference)))])])]}},{key:\"created\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',[_c('span',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:(item.created_at),expression:\"item.created_at\"}]},[_vm._v(_vm._s(_vm._f(\"moment\")(item.created_at,'from','now')))])])]}},{key:\"events\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',[(!(_vm.filteredBySignature() || item.related_events_count < 1))?_c('CButton',{staticClass:\"tag\",attrs:{\"color\":\"dark\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'eventsig','dataType':'signature','value':item.signature})}}},[_vm._v(_vm._s(item.related_events_count))]):_vm._e()],1)]}},{key:\"status\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',[_vm._v(\" \"+_vm._s(item.status.name)+\" \")])]}},{key:\"severity\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',[_c('CButton',{staticClass:\"tag\",attrs:{\"color\":_vm.getSeverityColor(item.severity),\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'severity', 'dataType':'severity', 'value':item.severity})}}},[_vm._v(_vm._s(_vm.getSeverityText(item.severity)))])],1)]}},{key:\"actions\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',{attrs:{\"align\":\"right\"}},[_c('CButtonGroup',[((item.new_related_events && item.new_related_events.length > 0 && !_vm.filteredBySignature()) || (_vm.filteredBySignature() && item.status.name == 'New'))?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Create Event Rule','placement':'bottom'}),expression:\"{'content':'Create Event Rule','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"info\"},on:{\"click\":function($event){return _vm.createEventRule(item.signature)}}},[_c('CIcon',{attrs:{\"name\":\"cilGraph\"}})],1):_vm._e(),(!item.case_uuid)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Create Case','placement':'bottom'}),expression:\"{'content':'Create Case','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.caseFromCard(item.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilBriefcase\"}})],1):_vm._e(),_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'View Event','placement':'bottom'}),expression:\"{'content':'View Event','placement':'bottom'}\"}],attrs:{\"to\":(\"/alerts/\" + (item.uuid)),\"size\":\"sm\",\"color\":\"secondary\"}},[_c('CIcon',{attrs:{\"name\":\"cilMagnifyingGlass\"}})],1),(item.status.closed)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Reopen Event','placement':'bottom'}),expression:\"{'content':'Reopen Event','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"success\"},on:{\"click\":function($event){return _vm.reopenEvent(item.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilEnvelopeOpen\"}})],1):_vm._e(),(item.case_uuid)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'View Case','placement':'bottom'}),expression:\"{'content':'View Case','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"secondary\",\"to\":(\"/cases/\" + (item.case_uuid))}},[_c('CIcon',{attrs:{\"name\":\"cilBriefcase\"}})],1):_vm._e(),(!item.status.closed)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Dismiss Event','placement':'bottom'}),expression:\"{'content':'Dismiss Event','placement':'bottom'}\"}],attrs:{\"color\":\"danger\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.dismissEventFromCard(item.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilDeaf\"}})],1):_vm._e()],1)],1)]}},{key:\"observables\",fn:function(ref){\n    var item = ref.item;\nreturn [_c('td',[_vm._v(\" \"+_vm._s(item.observable_count)+\" \")])]}}])})],1)],1)],1)],1):_c('CRow',{staticStyle:{\"overflow-y\":\"scroll\",\"max-height\":\"650px\"}},_vm._l((_vm.filtered_events),function(event){return _c('CCol',{key:event.uuid,attrs:{\"col\":12/_vm.columns}},[_c('CCard',{attrs:{\"accent-color\":_vm.getSeverityColor(event.severity)}},[_c('CCardBody',{on:{\"mouseenter\":function($event){_vm.pauseRefresh = true},\"mouseleave\":function($event){_vm.pauseRefresh = false}}},[_c('CRow',[_c('CCol',{attrs:{\"col\":\"9\"}},[_c('h4',[(!(event.status.closed || event.case_uuid))?_c('input',{attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":_vm.selected.includes(event.uuid),\"value\":event.uuid},on:{\"change\":function($event){return _vm.selectEvents($event)}}}):_vm._e(),_vm._v(\" \"),_c('a',{on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'title','dataType':'title','value':event.title})}}},[_vm._v(_vm._s(event.title))])]),_vm._v(\" \"+_vm._s(_vm._f(\"truncate_description\")(event.description))),_c('br'),_c('CIcon',{staticStyle:{\"margin-top\":\"5px\"},attrs:{\"name\":\"cilCenterFocus\"}}),_vm._v(\" \"),_vm._l((event.observables),function(obs){return _c('li',{key:obs.uuid,staticStyle:{\"display\":\"inline\",\"margin-right\":\"2px\"}},[_c('CButton',{staticClass:\"tag\",staticStyle:{\"margin-top\":\"5px\",\"margin-bottom\":\"0px\"},attrs:{\"color\":\"secondary\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'observable', 'dataType': obs.dataType.name, 'value': obs.value})}}},[_c('b',[_vm._v(_vm._s(obs.dataType.name))]),_vm._v(\": \"+_vm._s(obs.value.toLowerCase()))])],1)})],2),_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"3\"}},[_c('CButtonGroup',[((event.new_related_events && event.new_related_events.length > 0 && !_vm.filteredBySignature()) || (_vm.filteredBySignature() && event.status.name == 'New'))?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Create Event Rule','placement':'bottom'}),expression:\"{'content':'Create Event Rule','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"info\"},on:{\"click\":function($event){return _vm.createEventRule(event.signature)}}},[_c('CIcon',{attrs:{\"name\":\"cilGraph\"}})],1):_vm._e(),(!event.case_uuid)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Create Case','placement':'bottom'}),expression:\"{'content':'Create Case','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.caseFromCard(event.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilBriefcase\"}})],1):_vm._e(),_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'View Event','placement':'bottom'}),expression:\"{'content':'View Event','placement':'bottom'}\"}],attrs:{\"to\":(\"/alerts/\" + (event.uuid)),\"size\":\"sm\",\"color\":\"secondary\"}},[_c('CIcon',{attrs:{\"name\":\"cilMagnifyingGlass\"}})],1),(event.status.closed)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Reopen Event','placement':'bottom'}),expression:\"{'content':'Reopen Event','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"success\"},on:{\"click\":function($event){return _vm.reopenEvent(event.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilEnvelopeOpen\"}})],1):_vm._e(),(event.case_uuid)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'View Case','placement':'bottom'}),expression:\"{'content':'View Case','placement':'bottom'}\"}],attrs:{\"size\":\"sm\",\"color\":\"secondary\",\"to\":(\"/cases/\" + (event.case_uuid))}},[_c('CIcon',{attrs:{\"name\":\"cilBriefcase\"}})],1):_vm._e(),(!event.status.closed)?_c('CButton',{directives:[{name:\"c-tooltip\",rawName:\"v-c-tooltip\",value:({'content':'Dismiss Event','placement':'bottom'}),expression:\"{'content':'Dismiss Event','placement':'bottom'}\"}],attrs:{\"color\":\"danger\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.dismissEventFromCard(event.uuid)}}},[_c('CIcon',{attrs:{\"name\":\"cilDeaf\"}})],1):_vm._e()],1)],1)],1)],1),_c('CCardFooter',{staticStyle:{\"background-color\":\"#f0f0f0\"}},[_c('CRow',[_c('CCol',{attrs:{\"col\":\"9\"}},[_c('small',[_c('CButton',{staticClass:\"tag\",attrs:{\"color\":_vm.getSeverityColor(event.severity),\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'severity', 'dataType':'severity', 'value':event.severity})}}},[_vm._v(_vm._s(_vm.getSeverityText(event.severity)))]),(!_vm.filteredBySignature() && event.related_events_count > 1)?_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]):_vm._e(),(!_vm.filteredBySignature() && event.related_events_count > 1)?_c('CButton',{staticClass:\"tag\",attrs:{\"color\":\"dark\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'eventsig','dataType':'signature','value':event.signature})}}},[_vm._v(_vm._s(event.related_events_count)+\" occurences \"),(event.new_related_events && event.new_related_events.length > 0)?_c('span',[_vm._v(\" | \"+_vm._s(event.new_related_events.length)+\" open\")]):_vm._e()]):_vm._e(),_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]),_c('CButton',{staticClass:\"tag\",attrs:{\"size\":\"sm\",\"color\":\"info\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type':'status', 'dataType':'status', 'value': event.status.name})}}},[_vm._v(_vm._s(event.status.name))]),(event.status.closed && event.dismiss_reason)?_c('span',[_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]),_c('b',[_vm._v(\"Dismiss Reason:\")]),_vm._v(\" \"+_vm._s(event.dismiss_reason.title))]):_vm._e(),_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]),_vm._v(\"Created \"+_vm._s(_vm._f(\"moment\")(event.created_at,'LLLL'))),_c('span',{staticClass:\"separator\"},[_vm._v(\"|\")]),_c('b',[_vm._v(\"Reference:\")]),_vm._v(\" \"+_vm._s(event.reference)+\" \")],1)]),_c('CCol',{staticClass:\"text-right\",attrs:{\"col\":\"3\"}},[_c('CIcon',{attrs:{\"name\":\"cilTags\"}}),_vm._v(\" \"),_vm._l((event.tags),function(tag){return _c('li',{key:tag.name,staticStyle:{\"display\":\"inline\",\"margin-right\":\"2px\"}},[_c('CButton',{staticClass:\"tag\",attrs:{\"color\":\"dark\",\"size\":\"sm\"},on:{\"click\":function($event){return _vm.toggleObservableFilter({'filter_type': 'tag', 'dataType':'tag', 'value':tag.name})}}},[_vm._v(_vm._s(tag.name))])],1)})],2)],1)],1)],1)],1)}),1)],1),_c('CModal',{attrs:{\"title\":\"Dismiss Event\",\"color\":\"danger\",\"centered\":true,\"size\":\"lg\",\"show\":_vm.dismissEventModal},on:{\"update:show\":function($event){_vm.dismissEventModal=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"type\":\"submit\",\"form\":\"dismissEventForm\",\"color\":\"danger\"}},[_vm._v(\"Dismiss Event\")])]},proxy:true}])},[_c('div',[_c('p',[_vm._v(\"Dismissing an event indicates that no action is required. For transparency purposes, it is best to leave a comment as to why this event is being dismissed. Fill out the comment field below.\")]),_c('p',[_vm._v(\"This comment will apply to \"),_c('b',[_vm._v(_vm._s(_vm.selected.length))]),_vm._v(\" events.\")]),_c('CForm',{attrs:{\"id\":\"dismissEventForm\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.dismissEvent()}}},[_c('CRow',[_c('CCol',[_c('br'),_c('CSelect',{attrs:{\"reset-on-options-change\":true,\"placeholder\":\"Select a reason for dismissing the event...\",\"options\":_vm.close_reasons,\"value\":_vm.dismissalReason,\"label\":\"Reason\"},on:{\"change\":function($event){_vm.dismissalReason = $event.target.value}}}),_c('CTextarea',{attrs:{\"placeholder\":\"Enter a comment as to why this Event is being dismissed.\",\"required\":_vm.settings.require_event_dismiss_comment,\"value\":_vm.dismissalComment,\"label\":\"Comment\",\"rows\":\"5\"},on:{\"change\":function($event){_vm.dismissalComment = $event}}})],1)],1)],1)],1)]),_c('CreateCaseModal',{attrs:{\"show\":_vm.createCaseModal,\"events\":_vm.selected},on:{\"update:show\":function($event){_vm.createCaseModal=$event}}}),_c('CreateEventRuleModal',{attrs:{\"show\":_vm.createEventRuleModal,\"events\":_vm.selected,\"event_signature\":_vm.event_signature,\"rule_observables\":_vm.rule_observables},on:{\"update:show\":function($event){_vm.createEventRuleModal=$event},\"update:event_signature\":function($event){_vm.event_signature=$event}}}),_c('MergeEventIntoCaseModal',{attrs:{\"show\":_vm.mergeIntoCaseModal,\"events\":_vm.selected},on:{\"update:show\":function($event){_vm.mergeIntoCaseModal=$event}}}),_c('CModal',{attrs:{\"title\":\"Delete Event\",\"color\":\"danger\",\"centered\":true,\"size\":\"lg\",\"show\":_vm.deleteEventModal},on:{\"update:show\":function($event){_vm.deleteEventModal=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){_vm.deleteEventModal = !_vm.deleteEventModal}}},[_vm._v(\"Dismiss\")]),_c('CButton',{attrs:{\"color\":\"danger\"},on:{\"click\":_vm.deleteEvent}},[_vm._v(\"Delete\")])]},proxy:true}])},[_c('div',[_c('p',[_vm._v(\"Deleting an event is a permanent action, are you sure you want to continue?\")]),_c('p',[_vm._v(\"This action will apply to \"),_c('b',[_vm._v(_vm._s(_vm.selected.length))]),_vm._v(\" events.\")])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('link',{attrs:{\"rel\":\"stylesheet\",\"href\":\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\"}}),_c('CModal',{attrs:{\"title\":\"Create Event Rule\",\"centered\":true,\"size\":\"lg\",\"show\":_vm.modalStatus,\"closeOnBackdrop\":false},on:{\"update:show\":function($event){_vm.modalStatus=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"secondary\"},on:{\"click\":function($event){return _vm.dismiss()}}},[_vm._v(\"Dismiss\")]),(_vm.step != 1)?_c('CButton',{attrs:{\"color\":\"info\"},on:{\"click\":function($event){return _vm.previousStep()}}},[_vm._v(\"Previous\")]):_vm._e(),(_vm.step != _vm.final_step)?_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.nextStep()}}},[_vm._v(\"Next\")]):_vm._e(),(_vm.step == _vm.final_step)?_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.createEventRule()}}},[_vm._v(\"Create\")]):_vm._e()]},proxy:true}])},[_c('div',[_c('CForm',{attrs:{\"id\":\"event_rule_form\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.createEventRule($event)}}},[(_vm.step == 1)?_c('div',{attrs:{\"name\":\"create-event-rule-step-1\"}},[_c('h4',[_vm._v(\"Rule Details\")]),_c('p',[_vm._v(\"An Event rule allows you to automatically handle Events over a period of time based on Event criteria.\")]),_c('p',[_vm._v(\"This rule will apply \"),_c('b',[_vm._v(\"immediately\")]),_vm._v(\" to \"),_c('b',[_vm._v(_vm._s(_vm.events.length))]),_vm._v(\" Events and any future events matching the below Rule Signature.\")]),_c('p',[_c('b',[_vm._v(\"Event Signature: \")]),_vm._v(_vm._s(_vm.event_signature)+\" \")]),_c('CInput',{attrs:{\"label\":\"Rule Name\",\"required\":\"\"},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_c('CTextarea',{attrs:{\"label\":\"Rule description\",\"required\":\"\",\"placeholder\":\"Give a brief description of what this rule will do and why.\"},model:{value:(_vm.description),callback:function ($$v) {_vm.description=$$v},expression:\"description\"}})],1):_vm._e(),(_vm.step == 2)?_c('div',{attrs:{\"name\":\"create-case-template-step-2\"}},[_c('h4',[_vm._v(\"Expiration\")]),_c('p',[_vm._v(\"Setting an expiration on the rule is recommended to allow analysts to revisit Events at a future state. There may be use cases for non-expiration rules but we can't think of any...\")]),_c('label',[_vm._v(\"Expire\")]),_c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CSwitch',{attrs:{\"color\":\"success\",\"label-on\":\"Yes\",\"label-off\":\"No\",\"label\":\"Dismiss Event\",\"checked\":_vm.expire},on:{\"update:checked\":function($event){_vm.expire=$event}}})],1)],1),_c('br'),_c('CInput',{attrs:{\"label\":\"Expiration period (days)\",\"disabled\":!_vm.expire,\"placeholder\":\"Enter a period in number of days\"},model:{value:(_vm.expire_days),callback:function ($$v) {_vm.expire_days=$$v},expression:\"expire_days\"}})],1):_vm._e(),(_vm.step == 3)?_c('div',{attrs:{\"name\":\"create-case-template-step-3\"}},[_c('h4',[_vm._v(\"Observable Matching\")]),_c('p',[_vm._v(\"The observables selected here must match for the Rule to apply. A signature of the observables is calculated to make sure only specific combinations are acted on.\")]),_c('multiselect',{staticStyle:{\"z-index\":\"50\"},attrs:{\"options\":_vm.rule_observables,\"custom-label\":_vm.observableLabel,\"multiple\":\"\",\"track-by\":\"value\",\"label\":\"value\"},scopedSlots:_vm._u([{key:\"option\",fn:function(props){return [_c('b',[_vm._v(_vm._s(props.option.dataType))]),_vm._v(\": \"+_vm._s(props.option.value)+\" \")]}}],null,false,1579855348),model:{value:(_vm.observables),callback:function ($$v) {_vm.observables=$$v},expression:\"observables\"}})],1):_vm._e(),(_vm.step == 4)?_c('div',{attrs:{\"name\":\"create-case-template-step-4\"}},[_c('h4',[_vm._v(\"Actions\")]),_c('label',[_vm._v(\"Merge into Case\")]),_c('CRow',[_c('CCol',{attrs:{\"col\":\"1\"}},[_c('CSwitch',{staticStyle:{\"padding-top\":\"5px\"},attrs:{\"disabled\":_vm.dismiss_event,\"label\":\"Merge into Case\",\"color\":\"success\",\"label-on\":\"Yes\",\"label-off\":\"No\",\"checked\":_vm.merge_into_case},on:{\"update:checked\":function($event){_vm.merge_into_case=$event}}})],1),_c('CCol',{attrs:{\"col\":\"11\"}},[_c('multiselect',{staticStyle:{\"z-index\":\"50\"},attrs:{\"disabled\":!_vm.merge_into_case || _vm.dismiss_event,\"options\":_vm.cases,\"track-by\":\"uuid\",\"label\":\"title\",\"searchable\":true,\"internal-search\":false,\"options-limit\":10,\"show-no-results\":false,\"custom-label\":_vm.caseLabel,\"placeholder\":\"Select a case\"},on:{\"search-change\":_vm.caseFind},scopedSlots:_vm._u([{key:\"option\",fn:function(props){return [_vm._v(\" #\"+_vm._s(props.option.id)+\" - \"+_vm._s(props.option.title)),_c('br'),_c('small',[_vm._v(_vm._s(props.option.event_count)+\" events.\")])]}}],null,false,3201994419),model:{value:(_vm.target_case),callback:function ($$v) {_vm.target_case=$$v},expression:\"target_case\"}})],1)],1),_c('label',[_vm._v(\"Dismiss Event\")]),_c('CRow',[_c('CCol',{attrs:{\"col\":\"1\"}},[_c('CSwitch',{staticStyle:{\"padding-top\":\"5px\"},attrs:{\"disabled\":_vm.merge_into_case,\"color\":\"success\",\"label-on\":\"Yes\",\"label-off\":\"No\",\"label\":\"Dismiss Event\",\"checked\":_vm.dismiss_event},on:{\"update:checked\":function($event){_vm.dismiss_event=$event}}})],1),_c('CCol',{attrs:{\"col\":\"11\"}})],1)],1):_vm._e(),(_vm.step == 5)?_c('div',{attrs:{\"name\":\"create-case-template-step-5\"}},[_c('h4',[_vm._v(\"Review\")]),_c('b',[_vm._v(\"Rule Name: \")]),_vm._v(\" \"+_vm._s(_vm.name)),_c('br'),_c('b',[_vm._v(\"Description: \")]),_c('br'),_vm._v(_vm._s(_vm.description)),_c('br'),_c('br'),(_vm.expire)?_c('span',[_c('b',[_vm._v(\"Expire in: \")]),_vm._v(\" \"+_vm._s(_vm.expire_days)+\" day(s)\"),_c('br')]):_vm._e(),_c('b',[_vm._v(\"Actions: \")]),_c('br'),_c('br'),_c('ul',[(_vm.merge_into_case)?_c('li',[_vm._v(\"Merge in to case \"),_c('b',[_vm._v(\"#\"+_vm._s(_vm.target_case.id)+\" - \"+_vm._s(_vm.target_case.title))])]):_vm._e(),(_vm.dismiss_event)?_c('li',[_vm._v(\"Immediately dismiss event\")]):_vm._e()]),_c('b',[_vm._v(\"Observables: \")]),_c('br'),_c('br'),_c('ul',_vm._l((_vm.observables),function(obs){return _c('li',{key:obs.value},[_c('b',[_vm._v(_vm._s(obs.dataType))]),_vm._v(\": \"+_vm._s(obs.value))])}),0)]):_vm._e()])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div><link rel=\"stylesheet\" href=\"https://unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css\">\r\n    <CModal title=\"Create Event Rule\" :centered=\"true\" size=\"lg\" :show.sync=\"modalStatus\" :closeOnBackdrop=\"false\">\r\n\r\n        <div>\r\n            <CForm @submit.prevent=\"createEventRule\" id=\"event_rule_form\">\r\n                <div name=\"create-event-rule-step-1\" v-if=\"step == 1\">\r\n                <h4>Rule Details</h4>\r\n                <p>An Event rule allows you to automatically handle Events over a period of time based on Event criteria.</p>\r\n                <p>This rule will apply <b>immediately</b> to <b>{{events.length}}</b> Events and any future events matching the below Rule Signature.</p>\r\n\r\n                <p>\r\n                    <b>Event Signature: </b>{{event_signature}}\r\n                </p>\r\n                <CInput label=\"Rule Name\" v-model=\"name\" required></CInput>\r\n                <CTextarea label=\"Rule description\" v-model=\"description\" required placeholder=\"Give a brief description of what this rule will do and why.\"></CTextarea>                    \r\n                </div>\r\n                <div name=\"create-case-template-step-2\" v-if=\"step == 2\">\r\n                    <h4>Expiration</h4>\r\n                    <p>Setting an expiration on the rule is recommended to allow analysts to revisit Events at a future state. There may be use cases for non-expiration rules but we can't think of any...</p>\r\n                    <label>Expire</label>\r\n                    <CRow>\r\n                        <CCol col=\"12\">\r\n                            <CSwitch color=\"success\" label-on=\"Yes\" label-off=\"No\"  label=\"Dismiss Event\" :checked.sync=\"expire\"></CSwitch>\r\n                        </CCol>\r\n                    </CRow><br>\r\n                    <CInput label=\"Expiration period (days)\" v-bind:disabled=\"!expire\" placeholder=\"Enter a period in number of days\" v-model=\"expire_days\"></CInput>\r\n                \r\n                </div>\r\n                <div name=\"create-case-template-step-3\" v-if=\"step == 3\">\r\n                    <h4>Observable Matching</h4>\r\n                    <p>The observables selected here must match for the Rule to apply.  A signature of the observables is calculated to make sure only specific combinations are acted on.</p>\r\n                    <multiselect style=\"z-index:50\" :options=\"rule_observables\" v-model=\"observables\" :custom-label='observableLabel' multiple track-by=\"value\" label=\"value\">\r\n                        <template slot=\"option\" slot-scope=\"props\">\r\n                            <b>{{props.option.dataType}}</b>: {{props.option.value}}\r\n                        </template>\r\n                    </multiselect>\r\n                </div>\r\n                <div name=\"create-case-template-step-4\" v-if=\"step == 4\">\r\n                    <h4>Actions</h4>\r\n                    <label>Merge into Case</label>\r\n                    <CRow>                    \r\n                        <CCol col=\"1\">\r\n                            <CSwitch v-bind:disabled=\"dismiss_event\" label=\"Merge into Case\" color=\"success\" label-on=\"Yes\" label-off=\"No\" :checked.sync=\"merge_into_case\" style=\"padding-top:5px\"></CSwitch>\r\n                        </CCol>\r\n                        <CCol col=\"11\">\r\n                            <multiselect style=\"z-index:50\"\r\n                                v-bind:disabled=\"!merge_into_case || dismiss_event\"\r\n                                :options=\"cases\" \r\n                                v-model=\"target_case\" \r\n                                track-by=\"uuid\" \r\n                                label=\"title\"\r\n                                :searchable=\"true\"\r\n                                :internal-search=\"false\"\r\n                                :options-limit=\"10\"\r\n                                :show-no-results=\"false\"\r\n                                @search-change=\"caseFind\"\r\n                                :custom-label=\"caseLabel\"\r\n                                placeholder=\"Select a case\"\r\n                            >\r\n                            <template slot=\"option\" slot-scope=\"props\">\r\n                                #{{props.option.id}} - {{props.option.title}}<br><small>{{props.option.event_count}} events.</small>\r\n                            </template>\r\n                            </multiselect>\r\n                        </CCol>\r\n                    </CRow>\r\n                    <label>Dismiss Event</label>\r\n                    <CRow>                    \r\n                        <CCol col=\"1\">\r\n                            <CSwitch v-bind:disabled=\"merge_into_case\" color=\"success\" label-on=\"Yes\" label-off=\"No\"  label=\"Dismiss Event\" :checked.sync=\"dismiss_event\"  style=\"padding-top:5px\"></CSwitch>\r\n                        </CCol>\r\n                        <CCol col=\"11\">\r\n                            \r\n                        </CCol>\r\n                    </CRow>\r\n                </div>\r\n                <div name=\"create-case-template-step-5\" v-if=\"step == 5\">\r\n                    <h4>Review</h4>\r\n                    <b>Rule Name: </b> {{name}}<br>\r\n                    <b>Description: </b><br>{{description}}<br><br>\r\n                    <span v-if=\"expire\"><b>Expire in: </b> {{expire_days}} day(s)<br></span>\r\n                    <b>Actions: </b><br><br>\r\n                        <ul>\r\n                            <li v-if=\"merge_into_case\">Merge in to case <b>#{{target_case.id}} - {{target_case.title}}</b></li>\r\n                            <li v-if=\"dismiss_event\">Immediately dismiss event</li>\r\n                        </ul>\r\n                    <b>Observables: </b><br><br>\r\n                    <ul>\r\n                        <li v-for=\"obs in observables\" :key=\"obs.value\"><b>{{obs.dataType}}</b>: {{obs.value}}</li>\r\n                    </ul>\r\n                </div>\r\n            </CForm>\r\n        </div>\r\n      <template #footer>\r\n          <CButton @click=\"dismiss()\" color=\"secondary\">Dismiss</CButton>\r\n          <CButton v-if=\"step != 1\" @click=\"previousStep()\" color=\"info\">Previous</CButton>\r\n          <CButton v-if=\"step != final_step\" @click=\"nextStep()\" color=\"primary\">Next</CButton>\r\n          <CButton v-if=\"step == final_step\" @click=\"createEventRule()\" color=\"primary\">Create</CButton>\r\n      </template>\r\n    </CModal>\r\n</div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport {vSelect} from \"vue-select\";\r\nimport { mapState} from 'vuex';\r\nexport default {\r\n    name: 'CreateEventRuleModal',\r\n    props: {\r\n        show: Boolean,\r\n        events: Array,\r\n        event_signature: String,\r\n        rule_observables: Array\r\n    },\r\n    computed: mapState(['settings']),\r\n    data(){\r\n        return {\r\n            name: \"\",\r\n            cases: [],\r\n            description: \"\",\r\n            modalStatus: this.show,\r\n            merge_into_case: false,\r\n            dismiss_event: false,\r\n            expire_days: 1,\r\n            observables: [],\r\n            expire: true,\r\n            step: 1,\r\n            final_step: 5,\r\n            target_case: []\r\n        }\r\n    },\r\n    watch: {\r\n        \r\n        show: function() {\r\n            this.modalStatus = this.show\r\n            \r\n        },\r\n        modalStatus: function(){\r\n            if(this.modalStatus) {\r\n                this.loadData()\r\n                this.name = \"Rule for event signature \"+this.event_signature\r\n                this.observables = this.rule_observables\r\n            }\r\n            this.$emit('update:show', this.modalStatus)\r\n            if(!this.modalStatus) {\r\n                this.reset()\r\n            }\r\n        },\r\n        case_template: function() {\r\n            this.applyCaseTemplate()\r\n        },\r\n        use_case_template: function() {\r\n            if(!this.use_case_template) {\r\n                this.case_template = null\r\n            }\r\n            \r\n            this.applyCaseTemplate()\r\n        }\r\n    },\r\n    created() {\r\n        //this.loadData()\r\n        //this.$store.dispatch('getSettings')\r\n    },\r\n    methods: {\r\n        createEventRule() {\r\n            let rule = {\r\n                name: this.name,\r\n                description: this.description,\r\n                merge_into_case: this.merge_into_case,\r\n                target_case_uuid: this.target_case.uuid,\r\n                expire: this.expire,\r\n                expire_days: this.expire_days,\r\n                dismiss: this.dismiss_event,\r\n                event_signature: this.event_signature,\r\n                observables: this.observables\r\n            }\r\n            this.$store.dispatch('createEventRule', rule).then(resp => {\r\n                this.modalStatus = false\r\n            })\r\n        },\r\n        nextStep() {\r\n            this.step += 1\r\n        },\r\n        previousStep() {\r\n            this.step -= 1;\r\n        },\r\n        loadData() {\r\n            this.$store.dispatch('getCases', 'uuid,title,id,event_count,owner,severity').then(resp => {\r\n                this.cases = this.$store.getters.cases\r\n            })\r\n        },\r\n        caseFind(query) {\r\n            let fields = 'uuid,title,id,event_count,owner,severity'\r\n            this.$store.dispatch('getCasesByTitle', {title: query, fields}).then(resp => {\r\n                this.cases = this.$store.getters.cases\r\n            })\r\n        },\r\n        toggleMergeToCase() {\r\n            this.merge_into_case = !this.merge_into_case\r\n        },\r\n        observableLabel({dataType, value}) {\r\n            return `${dataType}: ${value}`\r\n        },\r\n        caseLabel({id, title}) {\r\n            if(id && title) {\r\n                return `#${id} - ${title}`\r\n            }\r\n        },\r\n        reset () {\r\n            this.description = \"\"\r\n            this.expire = true\r\n            this.expire_days = 1\r\n            this.observables = []\r\n            this.merge_into_case = false\r\n            this.dismiss_event = false\r\n            this.target_case = []\r\n            this.step = 1\r\n        },\r\n        dismiss() {\r\n            this.reset()\r\n            this.modalStatus = false            \r\n        },\r\n        addTag(newTag) {\r\n            const t = {\r\n                name: newTag,\r\n                uuid: ''\r\n            }\r\n            this.tag_list.push(t)\r\n            this.selected_tags.push(t)\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEventRuleModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEventRuleModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateEventRuleModal.vue?vue&type=template&id=358a3882&\"\nimport script from \"./CreateEventRuleModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateEventRuleModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <CRow>\r\n    <CCol col=\"12\">\r\n      <h2>Events</h2>\r\n      <CRow>\r\n        <CCol col=\"12\">\r\n          <CAlert :show.sync=\"alert.show\" :color=\"alert.type\" closeButton>\r\n            {{alert.message}}\r\n          </CAlert>\r\n        </CCol>\r\n      </CRow>\r\n      <CRow>\r\n        <CCol col=\"12\">\r\n          <CCard>\r\n            <CCardHeader>\r\n              <CRow>\r\n                <CCol col=\"10\">\r\n                  <li style=\"display: inline; margin-right: 2px;\" v-for=\"obs in observableFilters\" :key=\"obs.value\"><CButton color=\"secondary\" class=\"tag\"  size=\"sm\" @click=\"toggleObservableFilter({'dataType': obs.dataType.name, 'value': obs.value})\"><b>{{obs.dataType}}</b>: <span v-if=\"obs.filter_type == 'severity'\">{{getSeverityText(obs.value).toLowerCase()}}</span><span v-else>{{ obs.value }}</span></CButton></li><span v-if=\"!filteredBySignature() && observableFilters.length > 0\"><span class=\"separator\">|</span>Showing {{filtered_events.length }} grouped events.</span><span v-if=\"filteredBySignature() && observableFilters.length != 0\"><span class=\"separator\" v-if=\"filteredBySignature() && observableFilters.length != 0\">|</span>Showing {{filtered_events ? filtered_events.length : 0}} events.</span><span v-if=\"observableFilters.length == 0\">Showing {{filtered_events.length}} grouped events.</span>\r\n                </CCol>\r\n                <CCol col=\"2\" class=\"text-right\">\r\n                  <CButton @click=\"quick_filters = !quick_filters\" color=\"info\" size=\"sm\">Quick Filters</CButton>\r\n                </CCol>\r\n              </CRow>\r\n            </CCardHeader>\r\n            <CCollapse :show=\"quick_filters\">\r\n              <CNav variant=\"tabs\" :justified=\"true\">\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'New'})\">\r\n                    <h1>{{eventCountByStatus('New')}}</h1>\r\n                    New\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Open'})\">\r\n                    <h1>{{eventCountByStatus('Open')}}</h1>\r\n                    Open\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Closed'})\">\r\n                    <h1>{{eventCountByStatus('Closed')}}</h1>\r\n                    Closed\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'status', 'dataType':'status','value':'Dismissed'})\">\r\n                    <h1>{{eventCountByStatus('Dismissed')}}</h1>\r\n                    Dismissed\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':3})\">\r\n                    <h1>{{eventCountBySeverity(3)}}</h1>\r\n                    Critical\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':2})\">\r\n                    <h1>{{eventCountBySeverity(2)}}</h1>\r\n                    High\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':1})\">\r\n                    <h1>{{eventCountBySeverity(1)}}</h1>\r\n                    Medium\r\n                  </div>\r\n                </CNavItem>\r\n                <CNavItem>\r\n                  <div @click=\"toggleObservableFilter({'filter_type': 'severity', 'dataType':'severity','value':0})\">\r\n                    <h1>{{eventCountBySeverity(0)}}</h1>\r\n                    Low\r\n                  </div>\r\n                </CNavItem>\r\n              </CNav>\r\n            </CCollapse>\r\n          </CCard>\r\n        </CCol>\r\n      </CRow>\r\n      <CRow>\r\n        <CCol col=\"3\">\r\n            <div>\r\n              <CButton v-if=\"select_all || selected.length != 0 && !filteredBySignature()\" @click=\"clearSelected()\" style=\"margin-top: -5px\" size=\"sm\" color=\"secondary\"><CIcon name=\"cilXCircle\" size=\"sm\"></CIcon></CButton><CButton style=\"margin-top: -5px\" v-if=\"!select_all && selected.length == 0 || filteredBySignature()\" @click=\"selectAll()\" size=\"sm\" color=\"secondary\"><CIcon name=\"cilCheck\"></CIcon></CButton>&nbsp;&nbsp;<CSelect :options=\"sort_options\" placeholder=\"Sort by\" :value=\"sort_by\" @change=\"sort_by = $event.target.value; filterEvents()\" class=\"d-inline-block\"/>&nbsp;<CSelect class=\"d-inline-block\" placeholder=\"Events per Page\" :options=\"[10,25,50,100]\" @change=\"card_per_page = $event.target.value; filterEvents()\"/>\r\n            </div>\r\n        </CCol>\r\n        <CCol col=\"3\">\r\n          <center><CPagination :activePage.sync=\"current_page\" :pages=\"page_data.pages\"/></center>\r\n        </CCol>\r\n        <CCol col=\"3\" class=\"text-right\">\r\n          <CInput placeholder=\"Search\" v-model=\"search_filter\" v-on:keydown.enter=\"toggleObservableFilter({'filter_type':'search','dataType':'search','value':search_filter})\" ><template #append>\r\n            <CButton color=\"secondary\" @click=\"toggleObservableFilter({'filter_type':'search','dataType':'search','value':search_filter})\">Search</CButton>\r\n          </template></CInput>\r\n        </CCol>\r\n        <CCol col=\"3\" class=\"text-right\">\r\n          <div>\r\n            <CButton v-if=\"!table_view\" @click=\"setColumns()\" color=\"secondary\" class=\"d-inline-block\"><small><CIcon name='cilColumns' size=\"sm\"></CIcon></small></CButton>&nbsp;<CButton color=\"secondary\" @click=\"table_view = !table_view\"  class=\"d-inline-block\"><span v-if=\"table_view\">Card</span><span v-else>Table</span> View</CButton>&nbsp;\r\n            <CDropdown \r\n                :toggler-text=\"`${selected.length} events`\" \r\n                color=\"secondary\"\r\n                v-bind:disabled=\"selected.length == 0\"\r\n                class='d-inline-block'\r\n            >\r\n                <CDropdownItem @click=\"dismissEventModal = !dismissEventModal\">Dismiss Event</CDropdownItem>\r\n                <CDropdownItem @click=\"runPlaybookModal = !runPlaybookModal\">Run Playbook</CDropdownItem>\r\n                <CDropdownItem @click=\"createCaseModal = !createCaseModal\">Create Case</CDropdownItem>\r\n                <CDropdownItem @click=\"mergeIntoCaseModal = !mergeIntoCaseModal\">Merge into Case</CDropdownItem>\r\n                <CDropdownDivider/>\r\n                <CDropdownItem @click=\"deleteEventModal = !deleteEventModal\">Delete</CDropdownItem>\r\n            </CDropdown>\r\n          </div>\r\n        </CCol>\r\n      </CRow>\r\n      <CRow col v-if=\"status == 'loading'\">\r\n        <CCol col=\"12\">\r\n        <div style=\"margin: auto; text-align:center; verticle-align:middle;\">\r\n           <CSpinner\r\n                color=\"dark\"\r\n                style=\"width:6rem;height:6rem;\"\r\n            />\r\n        </div>\r\n        </CCol>\r\n      </CRow>           \r\n      <CRow v-else-if=\"filtered_events.length == 0\">\r\n      <CCol col=\"12\" class='text-center'>\r\n          <h1>No Events</h1>\r\n        </CCol>\r\n      </CRow>\r\n      <CRow v-else-if=\"table_view\">\r\n        <CCol col=\"12\">\r\n        <CCard>\r\n          <CCardBody style=\"overflow-y:scroll; max-height:600px\">\r\n            <CDataTable\r\n                  :items=\"filtered_events\"\r\n                  :fields=\"fields\"\r\n                  :striped=\"true\"\r\n                  :sorter='{resetable:true}'\r\n                  :responsive=\"false\"\r\n                  v-on:mouseenter.native=\"pauseRefresh = true\" v-on:mouseleave.native=\"pauseRefresh = false\"\r\n              >\r\n              <template #name=\"{item}\">\r\n                  <td>\r\n                      <input v-if=\"!(item.case_uuid || item.status.closed)\" type=\"checkbox\" :value=\"item.uuid\" v-model=\"selected\"/>&nbsp;<a @click=\"toggleObservableFilter({'filter_type':'title','dataType':'title','value':item.title})\">{{item.title}}</a><br>\r\n                      <CIcon name=\"cilCenterFocus\"/>&nbsp;<li style=\"display: inline; margin-right: 2px;\" v-for=\"obs in item.observables.slice(0,2)\" :key=\"obs.uuid\"><CButton color=\"secondary\" class=\"tag\"  size=\"sm\" style=\"margin-top:5px; margin-bottom:5px;\" @click=\"toggleObservableFilter({'filter_type':'observable', 'dataType': obs.dataType.name, 'value': obs.value})\"><b>{{obs.dataType.name}}</b>: {{ obs.value.toLowerCase() }}</CButton></li><span v-if=\"item.observables.length > 2\" style=\"cursor: pointer;\" v-c-popover=\"{'header':'Additional Observables', 'content':extraObservables(item.observables.slice(2))}\"><small>&nbsp;+{{ item.observables.length - 2}}</small></span><br>\r\n                      <CIcon name=\"cilTags\"/>&nbsp;<li style=\"display: inline; margin-right: 2px;\" v-for=\"tag in item.tags\" :key=\"tag.name\"><CButton @click=\"toggleObservableFilter({'filter_type': 'tag', 'dataType':'tag', 'value':tag.name})\" color=\"dark\" class=\"tag\" size=\"sm\">{{ tag.name }}</CButton></li>\r\n                  </td>\r\n              </template>\r\n              <template #reference=\"{item}\">\r\n                <td><span v-c-tooltip=\"{\r\n        content: `${item.reference}`,\r\n        placement: 'top'\r\n      }\">{{item.reference | truncate}}</span></td>\r\n              </template>\r\n              <template #created=\"{item}\">\r\n                  <td>\r\n                      <span v-c-tooltip=\"item.created_at\">{{item.created_at | moment('from','now')}}</span>\r\n                  </td>\r\n              </template>\r\n              <template #events=\"{item}\">\r\n                <td>\r\n                  <CButton class=\"tag\" @click=\"toggleObservableFilter({'filter_type':'eventsig','dataType':'signature','value':item.signature})\" v-if=\"!(filteredBySignature() || item.related_events_count < 1)\" color=\"dark\" size=\"sm\">{{item.related_events_count}}</CButton>\r\n                </td>\r\n              </template>\r\n              <template #status=\"{item}\">\r\n                <td>\r\n                  {{item.status.name}}\r\n                </td>\r\n              </template>\r\n              <template #severity=\"{item}\">\r\n                <td>\r\n                  <CButton @click=\"toggleObservableFilter({'filter_type':'severity', 'dataType':'severity', 'value':item.severity})\" class=\"tag\" :color=\"getSeverityColor(item.severity)\" size=\"sm\">{{getSeverityText(item.severity)}}</CButton>\r\n                </td>\r\n              </template>\r\n              <template #actions=\"{item}\">\r\n                <td align=\"right\">\r\n                  <CButtonGroup>\r\n                    <CButton v-if=\"(item.new_related_events && item.new_related_events.length > 0 && !filteredBySignature()) || (filteredBySignature() && item.status.name == 'New')\" size=\"sm\" color=\"info\" @click=\"createEventRule(item.signature)\" v-c-tooltip=\"{'content':'Create Event Rule','placement':'bottom'}\"><CIcon name='cilGraph'/></CButton>\r\n                    <CButton @click=\"caseFromCard(item.uuid)\" v-if=\"!item.case_uuid\" size=\"sm\" color=\"secondary\" v-c-tooltip=\"{'content':'Create Case','placement':'bottom'}\"><CIcon name=\"cilBriefcase\"/></CButton>\r\n                    <CButton :to=\"`/alerts/${item.uuid}`\" size=\"sm\" color=\"secondary\" v-c-tooltip=\"{'content':'View Event','placement':'bottom'}\"><CIcon name=\"cilMagnifyingGlass\"/></CButton>\r\n                    <CButton v-if=\"item.status.closed\" @click=\"reopenEvent(item.uuid)\" v-c-tooltip=\"{'content':'Reopen Event','placement':'bottom'}\" size=\"sm\" color=\"success\"><CIcon name=\"cilEnvelopeOpen\"/></CButton>\r\n                    <CButton v-if=\"item.case_uuid\" size=\"sm\" color=\"secondary\" :to=\"`/cases/${item.case_uuid}`\" v-c-tooltip=\"{'content':'View Case','placement':'bottom'}\"><CIcon name=\"cilBriefcase\"/></CButton>\r\n                    <CButton v-if=\"!item.status.closed\" color=\"danger\" size=\"sm\" @click=\"dismissEventFromCard(item.uuid)\" v-c-tooltip=\"{'content':'Dismiss Event','placement':'bottom'}\"><CIcon name=\"cilDeaf\"/></CButton>\r\n                  </CButtonGroup>\r\n                </td>\r\n              </template>\r\n              <template #observables=\"{item}\">\r\n                <td>\r\n                  {{item.observable_count}}\r\n                </td>\r\n              </template>\r\n              </CDataTable>\r\n          </CCardBody>\r\n        </CCard>\r\n        </CCol>\r\n      </CRow>\r\n      <CRow v-else style=\"overflow-y:scroll; max-height:650px\">\r\n        <CCol :col=\"12/columns\" v-for=\"event in filtered_events\" :key=\"event.uuid\">\r\n          <CCard :accent-color=\"getSeverityColor(event.severity)\">\r\n            <CCardBody @mouseenter=\"pauseRefresh = true\" @mouseleave=\"pauseRefresh = false\">\r\n              <CRow>\r\n                <CCol col=\"9\">\r\n                  <h4>\r\n                    <input type=\"checkbox\" v-if=\"!(event.status.closed || event.case_uuid)\" v-bind:checked=\"selected.includes(event.uuid)\" :value=\"event.uuid\" @change=\"selectEvents($event)\"/>\r\n                    &nbsp;<a @click=\"toggleObservableFilter({'filter_type':'title','dataType':'title','value':event.title})\">{{event.title}}</a></h4>\r\n                  {{event.description | truncate_description}}<br>\r\n                  <CIcon name=\"cilCenterFocus\" style=\"margin-top:5px\"/>&nbsp;<li style=\"display: inline; margin-right: 2px;\" v-for=\"obs in event.observables\" :key=\"obs.uuid\"><CButton color=\"secondary\" class=\"tag\"  size=\"sm\" style=\"margin-top:5px; margin-bottom:0px;\" @click=\"toggleObservableFilter({'filter_type':'observable', 'dataType': obs.dataType.name, 'value': obs.value})\"><b>{{obs.dataType.name}}</b>: {{ obs.value.toLowerCase() }}</CButton></li>\r\n                </CCol>\r\n                <CCol col=\"3\" class=\"text-right\">\r\n                  <CButtonGroup>\r\n                    <CButton v-if=\"(event.new_related_events && event.new_related_events.length > 0 && !filteredBySignature()) || (filteredBySignature() && event.status.name == 'New')\" size=\"sm\" color=\"info\" @click=\"createEventRule(event.signature)\" v-c-tooltip=\"{'content':'Create Event Rule','placement':'bottom'}\"><CIcon name='cilGraph'/></CButton>\r\n                    <CButton @click=\"caseFromCard(event.uuid)\" v-if=\"!event.case_uuid\" size=\"sm\" color=\"secondary\" v-c-tooltip=\"{'content':'Create Case','placement':'bottom'}\"><CIcon name=\"cilBriefcase\"/></CButton>\r\n                    <CButton :to=\"`/alerts/${event.uuid}`\" size=\"sm\" color=\"secondary\" v-c-tooltip=\"{'content':'View Event','placement':'bottom'}\"><CIcon name=\"cilMagnifyingGlass\"/></CButton>\r\n                    <CButton v-if=\"event.status.closed\" @click=\"reopenEvent(event.uuid)\" v-c-tooltip=\"{'content':'Reopen Event','placement':'bottom'}\" size=\"sm\" color=\"success\"><CIcon name=\"cilEnvelopeOpen\"/></CButton>\r\n                    <CButton v-if=\"event.case_uuid\" size=\"sm\" color=\"secondary\" :to=\"`/cases/${event.case_uuid}`\" v-c-tooltip=\"{'content':'View Case','placement':'bottom'}\"><CIcon name=\"cilBriefcase\"/></CButton>\r\n                    <CButton v-if=\"!event.status.closed\" color=\"danger\" size=\"sm\" @click=\"dismissEventFromCard(event.uuid)\" v-c-tooltip=\"{'content':'Dismiss Event','placement':'bottom'}\"><CIcon name=\"cilDeaf\"/></CButton>\r\n                  </CButtonGroup>\r\n                </CCol>\r\n              </CRow>\r\n            </CCardBody>\r\n            <CCardFooter style=\"background-color:#f0f0f0;\">\r\n              <CRow>\r\n                <CCol col=\"9\">\r\n                  <small>\r\n                    <CButton @click=\"toggleObservableFilter({'filter_type':'severity', 'dataType':'severity', 'value':event.severity})\" class=\"tag\" :color=\"getSeverityColor(event.severity)\" size=\"sm\">{{getSeverityText(event.severity)}}</CButton>\r\n                    <span v-if=\"!filteredBySignature() && event.related_events_count > 1\" class=\"separator\">|</span><CButton class=\"tag\" @click=\"toggleObservableFilter({'filter_type':'eventsig','dataType':'signature','value':event.signature})\" v-if=\"!filteredBySignature() && event.related_events_count > 1\" color=\"dark\" size=\"sm\">{{event.related_events_count}} occurences <span v-if=\"event.new_related_events && event.new_related_events.length > 0\"> | {{event.new_related_events.length}} open</span></span></CButton>\r\n                    <span class=\"separator\">|</span><CButton class=\"tag\" @click=\"toggleObservableFilter({'filter_type':'status', 'dataType':'status', 'value': event.status.name})\" size=\"sm\" color=\"info\">{{event.status.name}}</CButton>\r\n                    <span  v-if=\"event.status.closed && event.dismiss_reason\"><span class=\"separator\">|</span><b>Dismiss Reason:</b> {{event.dismiss_reason.title }}</span></span>\r\n                    <span class=\"separator\">|</span>Created {{event.created_at | moment('LLLL') }}</span>\r\n                    <span class=\"separator\">|</span><b>Reference:</b> {{event.reference}}\r\n                  </small>\r\n                </CCol>\r\n                <CCol col=\"3\" class=\"text-right\">\r\n                  <CIcon name=\"cilTags\"/>&nbsp;<li style=\"display: inline; margin-right: 2px;\" v-for=\"tag in event.tags\" :key=\"tag.name\"><CButton @click=\"toggleObservableFilter({'filter_type': 'tag', 'dataType':'tag', 'value':tag.name})\" color=\"dark\" class=\"tag\" size=\"sm\">{{ tag.name }}</CButton></li>\r\n                </CCol>\r\n              </CRow>\r\n            </CCardFooter>\r\n          </CCard>\r\n        </CCol>\r\n      </CRow>\r\n    </CCol>\r\n    <CModal title=\"Dismiss Event\" color=\"danger\" :centered=\"true\" size=\"lg\" :show.sync=\"dismissEventModal\">\r\n      <div>\r\n        <p>Dismissing an event indicates that no action is required.  For transparency purposes, it is best to leave a comment as to why this event is being dismissed.  Fill out the comment field below.</p>\r\n        <p>This comment will apply to <b>{{selected.length}}</b> events.</p>\r\n        <CForm id=\"dismissEventForm\" @submit.prevent=\"dismissEvent()\">\r\n            <CRow>\r\n                <CCol><br>\r\n            <CSelect :reset-on-options-change='true' placeholder=\"Select a reason for dismissing the event...\" :options=\"close_reasons\" :value=\"dismissalReason\" @change=\"dismissalReason = $event.target.value\" label=\"Reason\"/>\r\n            <CTextarea\r\n                placeholder=\"Enter a comment as to why this Event is being dismissed.\"\r\n                v-bind:required=\"settings.require_event_dismiss_comment\"\r\n                :value=\"dismissalComment\"\r\n                @change=\"dismissalComment = $event\"\r\n                label=\"Comment\"\r\n                rows=5\r\n            >\r\n            </CTextarea>            \r\n                </CCol>\r\n            </CRow>\r\n        </CForm>\r\n      </div>\r\n      <template #footer>\r\n        <CButton type=\"submit\" form=\"dismissEventForm\" color=\"danger\">Dismiss Event</CButton>\r\n      </template>\r\n    </CModal>\r\n    <CreateCaseModal :show.sync=\"createCaseModal\" :events=\"selected\"></CreateCaseModal>\r\n    <CreateEventRuleModal :show.sync=\"createEventRuleModal\" :events=\"selected\" :event_signature.sync=\"event_signature\" :rule_observables=\"rule_observables\"></CreateEventRuleModal>\r\n    <MergeEventIntoCaseModal :show.sync=\"mergeIntoCaseModal\" :events=\"selected\"></MergeEventIntoCaseModal>\r\n    <CModal title=\"Delete Event\" color=\"danger\" :centered=\"true\" size=\"lg\" :show.sync=\"deleteEventModal\">\r\n      <div>\r\n        <p>Deleting an event is a permanent action, are you sure you want to continue?</p>\r\n        <p>This action will apply to <b>{{selected.length}}</b> events.</p>\r\n      </div>\r\n      <template #footer>\r\n          <CButton @click=\"deleteEventModal = !deleteEventModal\" color=\"secondary\">Dismiss</CButton>\r\n        <CButton @click=\"deleteEvent\" color=\"danger\">Delete</CButton>\r\n      </template>\r\n    </CModal>\r\n  </CRow>\r\n</template>\r\n\r\n<style scoped>\r\n\r\n.nav-item:not(:last-child) {\r\n  border-right:1px solid #cfcfcf !important;\r\n}\r\n\r\n.nav-item h1 {\r\n  font-weight: 400\r\n}\r\n\r\n.card {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.card:not(:first-child) {\r\n  border-bottom:0px;\r\n  border-top:0px;\r\n}\r\n\r\n.card-body {\r\n  padding-top: 10px;\r\n  padding-bottom: 10px;\r\n}\r\n\r\na {\r\n  color: #3C4B64;\r\n}\r\n\r\n.separator {\r\n  margin-left: 10px;\r\n  margin-right: 10px;\r\n}\r\n\r\n</style>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\";\r\nimport {vSelect} from \"vue-select\";\r\nimport CreateCaseModal from './CreateCaseModal'\r\nimport MergeEventIntoCaseModal from './MergeEventIntoCaseModal'\r\nimport CreateEventRuleModal from './CreateEventRuleModal'\r\nexport default {\r\n    name: 'Events',\r\n    components: {\r\n      CreateCaseModal,\r\n      MergeEventIntoCaseModal,\r\n      CreateEventRuleModal\r\n    },\r\n    props: {\r\n    items: Array,\r\n    caption: {\r\n      type: String,\r\n      default: 'Table'\r\n    },\r\n    hover: Boolean,\r\n    striped: Boolean,\r\n    bordered: Boolean,\r\n    small: Boolean,\r\n    fixed: Boolean,\r\n    dark: Boolean,\r\n    event: false\r\n    },\r\n    computed: mapState(['status','alert','settings']),\r\n    created: function () {\r\n        this.loadData()\r\n        this.loadCloseReasons()\r\n        this.refresh = setInterval(function() {\r\n          if(!this.pauseRefresh) {\r\n            this.loadData()\r\n          }         \r\n        }.bind(this), this.settings.events_page_refresh*1000 || 60000)\r\n    },\r\n    data(){\r\n      return {\r\n        name: \"\",\r\n        description: \"\",\r\n        severity: 0,\r\n        tlp: 0,\r\n        tag_list: [],\r\n        selected_tags: [],\r\n        observable_count: 0,\r\n        tags: [],\r\n        events: [],\r\n        pauseRefresh: false,\r\n        case_tlp: 2,\r\n        case_severity: 1,\r\n        use_case_template: false,\r\n        dismissCountDown: 10,\r\n        selected: Array(),\r\n        mergeIntoCaseModal: false,\r\n        dismissEventModal:false,\r\n        deleteEventModal: false,\r\n        createCaseModal: false,\r\n        createEventRuleModal: false,\r\n        dismissalComment: \"\",\r\n        dismissalReason: null,\r\n        close_reasons: [],\r\n        collapse: {},\r\n        observableFilters: [{'filter_type':'status','dataType':'status','value':'New'}],\r\n        filtered_events: [],\r\n        quick_filters: false,\r\n        search_filter: '',\r\n        table_view: false,\r\n        select_all: false,\r\n        fields: ['name', 'created', 'events', 'reference', 'status', 'severity', 'observables','actions'],\r\n        sort_by: 'date',\r\n        event_signature: \"\",\r\n        rule_observables: [],\r\n        columns: 1,\r\n        card_page_num: 1,\r\n        card_per_page: this.settings ? this.settings.events_per_page : 10,\r\n        page_data: {},\r\n        current_page: 1,\r\n        sort_by: 'created_at',\r\n        sort_options: [\r\n          {'label': 'Severity','value':'severity'},\r\n          {'label': 'Date Created', 'value': 'created_at'},\r\n          {'label': 'Date Modified', 'value': 'modified_at'},\r\n          {'label': 'Name', 'value': 'title'},\r\n          {'label': 'TLP', 'value': 'tlp'}\r\n        ]\r\n      }\r\n    },\r\n    methods: {\r\n      reopenEvent(uuid) {\r\n        this.$store.dispatch('updateEvent', {uuid: uuid, data: {'status': 0}}).then(resp => {\r\n          this.filtered_events = this.filterEvents()\r\n        })\r\n      },\r\n      dismissEventFromCard(uuid) {\r\n        this.selected = [uuid]\r\n        this.dismissEventModal = true\r\n      },\r\n      deleteEvent() {\r\n        if(this.selected.length == 1) {\r\n          this.$store.dispatch('deleteEvent', this.selected[0]).then(resp => {\r\n            this.filtered_events = this.filterEvents()\r\n          })\r\n        } \r\n        if (this.selected.length > 1) {\r\n          this.$store.dispatch('deleteEvents', this.selected).then(resp => {\r\n            this.filtered_events = this.filterEvents()\r\n            \r\n          })\r\n        }\r\n        this.selected = []\r\n        this.deleteEventModal = false\r\n      },\r\n      dismissEvent() {\r\n        \r\n        if(this.selected.length == 1) {\r\n          let data = {          \r\n            dismiss_reason_uuid: this.dismissalReason,\r\n            dismiss_comment: this.dismissalComment\r\n          }\r\n          this.$store.dispatch('updateEvent', {uuid: this.selected[0], data}).then(resp => {\r\n            this.filtered_events = this.filterEvents()\r\n          })\r\n         }else if (this.selected.length > 1) {\r\n          let data = {          \r\n            dismiss_reason_uuid: this.dismissalReason,\r\n            dismiss_comment: this.dismissalComment,\r\n            events: this.selected\r\n          }\r\n          this.$store.dispatch('dismissEvents', data).then(resp => {\r\n            this.filtered_events = this.filterEvents()\r\n            \r\n          })\r\n         }\r\n         this.selected = []\r\n         this.dismissEventModal = false\r\n         this.dismissalComment = \"\"\r\n      },\r\n      loadCloseReasons() {\r\n        this.$store.dispatch('getCloseReasons').then(resp => {\r\n          this.close_reasons = this.$store.getters.close_reasons.map((reason) => { return {label: reason.title, value: reason.uuid}})\r\n        })\r\n      },\r\n      addSuccess: function() {\r\n        if (this.$store.getters.addSuccess == 'success') {\r\n          return true\r\n        } else {\r\n          return false\r\n        }\r\n      },\r\n      unique_event_sigs() {\r\n        \r\n      },\r\n      setColumns(){\r\n        if(this.columns == 1) {\r\n          this.columns = 2;\r\n        } else {\r\n          this.columns = 1\r\n        }\r\n      },\r\n      eventCountByStatus(status) {\r\n        if (this.filtered_events) {\r\n          return this.filtered_events.reduce(function(n, event) {\r\n            if(event) {\r\n              return n + (event.status.name == status)\r\n            }          \r\n          }, 0)\r\n        } else {\r\n          return 0\r\n        }\r\n      },\r\n      eventCountBySeverity(severity) {\r\n        if (this.filtered_events) {\r\n          return this.filtered_events.reduce(function(n, event) {\r\n            if(event) {\r\n              return n + (event.severity == severity)\r\n            }          \r\n          }, 0)\r\n        } else {\r\n          return 0\r\n        }\r\n      },\r\n      selectEvents(event) {\r\n        \r\n        if(this.selected.some((item) => { return item === event.target.value })) {\r\n\r\n          if(!this.filteredBySignature()) {\r\n            this.selected = this.selected.filter(x => !this.selectedRelated(event.target.value).includes(x))\r\n          } else {\r\n            this.selected = this.selected.filter(item => item !== event.target.value)\r\n          }\r\n\r\n        } else {\r\n          if(!this.filteredBySignature()) {\r\n            this.selected = [...this.selected, ...this.selectedRelated(event.target.value)]\r\n          } else {\r\n            this.selected.push(event.target.value)\r\n          }          \r\n        }\r\n      },\r\n      createEventRule(signature) {\r\n        this.selected = []\r\n        this.event_signature = signature\r\n        let source_event = this.filtered_events.filter((event) => event.signature == signature)\r\n        this.selected = this.selectedRelated(source_event[0].uuid)\r\n        this.rule_observables = this.filtered_events.filter((event) => \r\n            this.selected.includes(event.uuid)\r\n          ).map(event => event.observables).flat().map( function(obs) { \r\n            return {'dataType':obs.dataType.name, 'value': obs.value\r\n            }\r\n          })\r\n        let unique_observables = Array.from(new Set(this.rule_observables.map(a => a.value)))\r\n        .map(value => {\r\n          return this.rule_observables.find(a => a.value === value)\r\n        })\r\n        this.rule_observables = unique_observables\r\n        this.createEventRuleModal = true\r\n      },\r\n      selectedRelated(uuid) {\r\n        let source_event = this.filtered_events.filter((event) => { \r\n          return event.uuid == uuid \r\n        })\r\n        return source_event[0].new_related_events\r\n      },\r\n      filteredBySignature() {\r\n        if(this.observableFilters.some((filter) => filter.filter_type == 'eventsig')) {\r\n          return true\r\n        } else {\r\n          return false\r\n        }\r\n      },\r\n      filterEvents: function () {\r\n\r\n        // Build the filters based on what is currently selected\r\n        this.$store.commit('add_start')\r\n        let status_filters = []\r\n        let tag_filters = []\r\n        let observables_filters = []\r\n        let severity_filter = []\r\n        let signature_filter = \"\"\r\n        let title_filter = []\r\n        let grouped = !this.filteredBySignature()\r\n        let search = \"\"\r\n        for(let f in this.observableFilters) {\r\n          let filter = this.observableFilters[f]\r\n\r\n          if(filter.filter_type == 'eventsig') {\r\n            signature_filter = filter.value\r\n          }\r\n\r\n          if(filter.filter_type == 'status') {\r\n            status_filters.push(filter.value)\r\n          }\r\n\r\n          if(filter.filter_type == 'tag') {\r\n            tag_filters.push(filter.value)\r\n          }\r\n\r\n          if(filter.filter_type == 'observable') {\r\n            observables_filters.push(filter.value)\r\n          }\r\n\r\n          if(filter.filter_type == 'search') {\r\n            search = filter.value\r\n          }\r\n\r\n          if(filter.filter_type == 'severity') {\r\n            severity_filter.push(filter.value)\r\n          }\r\n\r\n          if(filter.filter_type == 'title') {\r\n            title_filter = [filter.value]\r\n          }\r\n        }\r\n\r\n        this.$store.dispatch('getEvents', {\r\n          signature: signature_filter,\r\n          grouped: grouped,\r\n          tags: tag_filters,\r\n          status: status_filters,\r\n          observables: observables_filters,\r\n          severity: severity_filter,\r\n          title: title_filter,\r\n          search: search,\r\n          fields: '',\r\n          page: this.current_page,\r\n          page_size: this.card_per_page,\r\n          sort_by: this.sort_by\r\n        }).then(resp => {\r\n          this.filtered_events = this.$store.getters.events\r\n          this.page_data = resp.data.pagination\r\n          this.$store.commit('add_success')\r\n        })\r\n      },\r\n      sanitizeHTML(str) {\r\n        var temp = document.createElement('div');\r\n        temp.textContent = str\r\n        return temp.innerHTML\r\n      },\r\n      extraObservables(observables) {\r\n        let content = \"<ul style='list-style-type: none; padding:0; margin: 0;'>\"\r\n        for(let o in observables) {\r\n          let obs = observables[o]\r\n          content += `<li><b>${obs.dataType.name}</b>: ${this.sanitizeHTML(obs.value)}</li>`\r\n        }\r\n        content += \"</ul>\"\r\n        return content\r\n      },\r\n      transformFilter(filter) {\r\n        /* Returns a filter in the way the API wants to see it */\r\n        return {'field':filter['filter_type'],'value':filter['value']}\r\n      },\r\n      toggleObservableFilter(obs) {\r\n        let exists = this.observableFilters.some((item) => {\r\n          return item.value === obs.value\r\n        })\r\n\r\n        // Can only have one status filter at a time\r\n        if(obs.filter_type == 'status') {\r\n          this.observableFilters = this.observableFilters.filter(item => item.filter_type !== obs.filter_type)\r\n        }\r\n\r\n        if(!exists) {\r\n          this.observableFilters.push(obs)\r\n        } else {\r\n          this.observableFilters = this.observableFilters.filter(item => item.value !== obs.value)\r\n        }\r\n        this.filterEvents()\r\n      },\r\n      relatedEvents(signature) {\r\n        return this.events.filter((event) => event.signature === signature).length\r\n      },\r\n      countStatusBySignature(signature, status) {\r\n        return this.events.filter((event) => event.signature === signature && event.status.name == status).length\r\n      },\r\n      loadData: function() {\r\n        this.filterEvents()\r\n      },\r\n      caseFromCard(uuid){\r\n        this.selected = [uuid]\r\n        this.createCaseModal = true\r\n      },\r\n      selectAll() {\r\n        //this.selected = [];\r\n        if(!this.select_all) {\r\n          for (let i in this.filtered_events) {\r\n            let event = this.filtered_events[i]\r\n            if(!this.filteredBySignature() && event.related_events_count > 1) {\r\n              if(event.signature) {\r\n                this.selected = [...this.selected, ...this.selectedRelated(event.uuid)]\r\n              } else if (event.signature == null) {\r\n                this.selected = [...this.selected, ...this.selectedRelated(event.uuid)]\r\n              }\r\n            } else {\r\n              if(!event.case_uuid) {\r\n                if(!this.selected.includes(event.uuid)) {\r\n                  this.selected.push(event.uuid)\r\n                }\r\n              }\r\n            }\r\n          }\r\n          if(!this.filteredBySignature()) {\r\n            this.select_all = true\r\n          }\r\n        }\r\n      },\r\n      clearSelected() {\r\n        this.selected = []\r\n        this.select_all = false\r\n      },\r\n      getSeverityColor(severity) {\r\n        switch(severity) {\r\n          case 0: return 'dark';\r\n          case 1: return 'info';\r\n          case 2: return 'warning';\r\n          case 3: return 'danger';\r\n          default: return 'dark';\r\n        }\r\n      },\r\n      getSeverityText(severity) {\r\n        switch(severity) {\r\n          case 0: return 'Low';\r\n          case 1: return 'Medium';\r\n          case 2: return 'High';\r\n          case 3: return 'Critical';\r\n          default: return 'Low';\r\n        }\r\n      }\r\n    },\r\n    beforeDestroy: function() {\r\n      clearInterval(this.refresh)\r\n    },\r\n    watch: {\r\n      current_page: function(){\r\n        this.filterEvents()\r\n      }\r\n    },\r\n    filters: {\r\n      truncate_description: function (value) {\r\n          let maxLength = 150\r\n          if (!value) return ''\r\n          value = value.toString()\r\n          if (value.length > maxLength) {\r\n              return value.substring(0,maxLength) + \"...\"\r\n          } else {\r\n              return value.substring(0,maxLength)\r\n          }\r\n      },\r\n      truncate: function (value) {\r\n          let maxLength = 6\r\n          if (!value) return ''\r\n          value = value.toString()\r\n          if (value.length > maxLength) {\r\n              return value.substring(0,maxLength) + \"...\"\r\n          } else {\r\n              return value.substring(0,maxLength)\r\n          }\r\n      }      \r\n    }\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlertsList.vue?vue&type=template&id=f52b8b44&scoped=true&\"\nimport script from \"./AlertsList.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertsList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AlertsList.vue?vue&type=style&index=0&id=f52b8b44&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f52b8b44\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsList.vue?vue&type=style&index=0&id=f52b8b44&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertsList.vue?vue&type=style&index=0&id=f52b8b44&scoped=true&lang=css&\""],"sourceRoot":""}